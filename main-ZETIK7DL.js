import{$ as Ha,$a as An,$b as P0,A as go,Aa as Hd,Ab as ef,B as Cs,Ba as Wn,Bb as Rn,C as bs,Ca as t0,Cb as l0,D as Nd,Da as Ss,Db as c0,Dc as F0,E as Es,Ea as N,Eb as Eo,F as $_,Fa as ne,Fb as cu,G as ru,Ga as n0,Gb as kr,H as xr,Ha as Kd,Hb as u0,I as Bd,Ia as ou,Ib as h0,J as q_,Ja as Co,Jb as d0,K as G_,Ka as Za,Kb as f0,L as H_,La as Wd,Lb as p0,M as ci,Ma as su,Mb as m0,Mc as V0,N as K_,Na as er,Nb as tf,O as Xt,Oa as Zd,Ob as Qn,P as _e,Pa as i0,Pb as g0,Q as W_,Qa as Qd,Qb as nr,R as _o,Ra as Pe,Rb as _0,S as be,Sa as r0,Sb as v0,T as Yi,Ta as tr,Tb as y0,U as Z_,Ua as Z,Ub as w0,V as tt,Va as Rr,Vb as C0,W as zd,Wa as Ge,Wb as Ja,X as xe,Xa as b,Xb as b0,Y as ue,Ya as P,Yb as E0,Z as Mr,Za as X,Zb as S0,_ as Q_,_a as Ye,_b as T0,a as J,aa as nt,ab as At,ac as Gt,b as qe,ba as Xi,bb as ie,bc as D0,c as L_,ca as Qt,cb as he,cc as I0,d as GC,da as Ud,db as Zn,dc as A0,e as HC,ea as Ka,eb as xn,ec as x0,f as q,fa as Y_,fb as Mn,fc as uu,g as F_,ga as Wa,gb as Ts,gc as Tt,h as V_,ha as Pi,hb as U,hc as M0,i as N_,ia as ui,ib as Xe,ic as R0,j as Od,ja as fe,jb as He,jc as hu,k as Ld,ka as pe,kb as o0,kc as k0,l as Ti,la as ye,lb as jt,lc as O0,m as _n,ma as Ve,mb as $t,mc as L0,n as Ar,na as Ji,nb as qt,o as un,oa as jd,ob as bo,p as Te,pa as vo,pb as it,q as Ga,qa as X_,qb as s0,r as B_,ra as yt,rb as Qa,s as z_,sa as In,sb as Ya,t as We,ta as $d,tb as a0,u as iu,ua as yo,ub as au,v as Dn,va as J_,vb as Xa,w as Fd,wa as qd,wb as Yd,x as U_,xa as e0,xb as Xd,y as Vd,ya as wo,yb as Jd,z as j_,za as Gd,zb as lu}from"./chunk-D4Q6AZUP.js";var gC=GC((yd,mC)=>{"use strict";(function(n,e){typeof yd=="object"&&typeof mC<"u"?e(yd):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.leaflet={}))})(yd,function(n){"use strict";var e="1.9.4";function t(r){var a,u,f,g;for(u=1,f=arguments.length;u<f;u++){g=arguments[u];for(a in g)r[a]=g[a]}return r}var i=Object.create||function(){function r(){}return function(a){return r.prototype=a,new r}}();function o(r,a){var u=Array.prototype.slice;if(r.bind)return r.bind.apply(r,u.call(arguments,1));var f=u.call(arguments,2);return function(){return r.apply(a,f.length?f.concat(u.call(arguments)):arguments)}}var s=0;function l(r){return"_leaflet_id"in r||(r._leaflet_id=++s),r._leaflet_id}function h(r,a,u){var f,g,y,D;return D=function(){f=!1,g&&(y.apply(u,g),g=!1)},y=function(){f?g=arguments:(r.apply(u,arguments),setTimeout(D,a),f=!0)},y}function d(r,a,u){var f=a[1],g=a[0],y=f-g;return r===f&&u?r:((r-g)%y+y)%y+g}function m(){return!1}function v(r,a){if(a===!1)return r;var u=Math.pow(10,a===void 0?6:a);return Math.round(r*u)/u}function w(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function S(r){return w(r).split(/\s+/)}function A(r,a){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?i(r.options):{});for(var u in a)r.options[u]=a[u];return r.options}function F(r,a,u){var f=[];for(var g in r)f.push(encodeURIComponent(u?g.toUpperCase():g)+"="+encodeURIComponent(r[g]));return(!a||a.indexOf("?")===-1?"?":"&")+f.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function $(r,a){return r.replace(j,function(u,f){var g=a[f];if(g===void 0)throw new Error("No value provided for variable "+u);return typeof g=="function"&&(g=g(a)),g})}var ee=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function oe(r,a){for(var u=0;u<r.length;u++)if(r[u]===a)return u;return-1}var me="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ce(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var pt=0;function Oe(r){var a=+new Date,u=Math.max(0,16-(a-pt));return pt=a+u,window.setTimeout(r,u)}var M=window.requestAnimationFrame||Ce("RequestAnimationFrame")||Oe,E=window.cancelAnimationFrame||Ce("CancelAnimationFrame")||Ce("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function T(r,a,u){if(u&&M===Oe)r.call(a);else return M.call(window,o(r,a))}function x(r){r&&E.call(window,r)}var R={__proto__:null,extend:t,create:i,bind:o,get lastId(){return s},stamp:l,throttle:h,wrapNum:d,falseFn:m,formatNum:v,trim:w,splitWords:S,setOptions:A,getParamString:F,template:$,isArray:ee,indexOf:oe,emptyImageUrl:me,requestFn:M,cancelFn:E,requestAnimFrame:T,cancelAnimFrame:x};function k(){}k.extend=function(r){var a=function(){A(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},u=a.__super__=this.prototype,f=i(u);f.constructor=a,a.prototype=f;for(var g in this)Object.prototype.hasOwnProperty.call(this,g)&&g!=="prototype"&&g!=="__super__"&&(a[g]=this[g]);return r.statics&&t(a,r.statics),r.includes&&(I(r.includes),t.apply(null,[f].concat(r.includes))),t(f,r),delete f.statics,delete f.includes,f.options&&(f.options=u.options?i(u.options):{},t(f.options,r.options)),f._initHooks=[],f.callInitHooks=function(){if(!this._initHooksCalled){u.callInitHooks&&u.callInitHooks.call(this),this._initHooksCalled=!0;for(var y=0,D=f._initHooks.length;y<D;y++)f._initHooks[y].call(this)}},a},k.include=function(r){var a=this.prototype.options;return t(this.prototype,r),r.options&&(this.prototype.options=a,this.mergeOptions(r.options)),this},k.mergeOptions=function(r){return t(this.prototype.options,r),this},k.addInitHook=function(r){var a=Array.prototype.slice.call(arguments,1),u=typeof r=="function"?r:function(){this[r].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(u),this};function I(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=ee(r)?r:[r];for(var a=0;a<r.length;a++)r[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ut={on:function(r,a,u){if(typeof r=="object")for(var f in r)this._on(f,r[f],a);else{r=S(r);for(var g=0,y=r.length;g<y;g++)this._on(r[g],a,u)}return this},off:function(r,a,u){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var f in r)this._off(f,r[f],a);else{r=S(r);for(var g=arguments.length===1,y=0,D=r.length;y<D;y++)g?this._off(r[y]):this._off(r[y],a,u)}return this},_on:function(r,a,u,f){if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}if(this._listens(r,a,u)===!1){u===this&&(u=void 0);var g={fn:a,ctx:u};f&&(g.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(g)}},_off:function(r,a,u){var f,g,y;if(this._events&&(f=this._events[r],!!f)){if(arguments.length===1){if(this._firingCount)for(g=0,y=f.length;g<y;g++)f[g].fn=m;delete this._events[r];return}if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}var D=this._listens(r,a,u);if(D!==!1){var V=f[D];this._firingCount&&(V.fn=m,this._events[r]=f=f.slice()),f.splice(D,1)}}},fire:function(r,a,u){if(!this.listens(r,u))return this;var f=t({},a,{type:r,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var g=this._events[r];if(g){this._firingCount=this._firingCount+1||1;for(var y=0,D=g.length;y<D;y++){var V=g[y],B=V.fn;V.once&&this.off(r,B,V.ctx),B.call(V.ctx||this,f)}this._firingCount--}}return u&&this._propagateEvent(f),this},listens:function(r,a,u,f){typeof r!="string"&&console.warn('"string" type argument expected');var g=a;typeof a!="function"&&(f=!!a,g=void 0,u=void 0);var y=this._events&&this._events[r];if(y&&y.length&&this._listens(r,g,u)!==!1)return!0;if(f){for(var D in this._eventParents)if(this._eventParents[D].listens(r,a,u,f))return!0}return!1},_listens:function(r,a,u){if(!this._events)return!1;var f=this._events[r]||[];if(!a)return!!f.length;u===this&&(u=void 0);for(var g=0,y=f.length;g<y;g++)if(f[g].fn===a&&f[g].ctx===u)return g;return!1},once:function(r,a,u){if(typeof r=="object")for(var f in r)this._on(f,r[f],a,!0);else{r=S(r);for(var g=0,y=r.length;g<y;g++)this._on(r[g],a,u,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[l(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[l(r)],this},_propagateEvent:function(r){for(var a in this._eventParents)this._eventParents[a].fire(r.type,t({layer:r.target,propagatedFrom:r.target},r),!0)}};ut.addEventListener=ut.on,ut.removeEventListener=ut.clearAllEventListeners=ut.off,ut.addOneTimeEventListener=ut.once,ut.fireEvent=ut.fire,ut.hasEventListeners=ut.listens;var pn=k.extend(ut);function H(r,a,u){this.x=u?Math.round(r):r,this.y=u?Math.round(a):a}var se=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(r){return this.clone()._add(W(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(W(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new H(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new H(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=se(this.x),this.y=se(this.y),this},distanceTo:function(r){r=W(r);var a=r.x-this.x,u=r.y-this.y;return Math.sqrt(a*a+u*u)},equals:function(r){return r=W(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=W(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function W(r,a,u){return r instanceof H?r:ee(r)?new H(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new H(r.x,r.y):new H(r,a,u)}function ce(r,a){if(r)for(var u=a?[r,a]:r,f=0,g=u.length;f<g;f++)this.extend(u[f])}ce.prototype={extend:function(r){var a,u;if(!r)return this;if(r instanceof H||typeof r[0]=="number"||"x"in r)a=u=W(r);else if(r=Ne(r),a=r.min,u=r.max,!a||!u)return this;return!this.min&&!this.max?(this.min=a.clone(),this.max=u.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(u.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(u.y,this.max.y)),this},getCenter:function(r){return W((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return W(this.min.x,this.max.y)},getTopRight:function(){return W(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var a,u;return typeof r[0]=="number"||r instanceof H?r=W(r):r=Ne(r),r instanceof ce?(a=r.min,u=r.max):a=u=r,a.x>=this.min.x&&u.x<=this.max.x&&a.y>=this.min.y&&u.y<=this.max.y},intersects:function(r){r=Ne(r);var a=this.min,u=this.max,f=r.min,g=r.max,y=g.x>=a.x&&f.x<=u.x,D=g.y>=a.y&&f.y<=u.y;return y&&D},overlaps:function(r){r=Ne(r);var a=this.min,u=this.max,f=r.min,g=r.max,y=g.x>a.x&&f.x<u.x,D=g.y>a.y&&f.y<u.y;return y&&D},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var a=this.min,u=this.max,f=Math.abs(a.x-u.x)*r,g=Math.abs(a.y-u.y)*r;return Ne(W(a.x-f,a.y-g),W(u.x+f,u.y+g))},equals:function(r){return r?(r=Ne(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function Ne(r,a){return!r||r instanceof ce?r:new ce(r,a)}function at(r,a){if(r)for(var u=a?[r,a]:r,f=0,g=u.length;f<g;f++)this.extend(u[f])}at.prototype={extend:function(r){var a=this._southWest,u=this._northEast,f,g;if(r instanceof ge)f=r,g=r;else if(r instanceof at){if(f=r._southWest,g=r._northEast,!f||!g)return this}else return r?this.extend(de(r)||Ie(r)):this;return!a&&!u?(this._southWest=new ge(f.lat,f.lng),this._northEast=new ge(g.lat,g.lng)):(a.lat=Math.min(f.lat,a.lat),a.lng=Math.min(f.lng,a.lng),u.lat=Math.max(g.lat,u.lat),u.lng=Math.max(g.lng,u.lng)),this},pad:function(r){var a=this._southWest,u=this._northEast,f=Math.abs(a.lat-u.lat)*r,g=Math.abs(a.lng-u.lng)*r;return new at(new ge(a.lat-f,a.lng-g),new ge(u.lat+f,u.lng+g))},getCenter:function(){return new ge((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ge(this.getNorth(),this.getWest())},getSouthEast:function(){return new ge(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof ge||"lat"in r?r=de(r):r=Ie(r);var a=this._southWest,u=this._northEast,f,g;return r instanceof at?(f=r.getSouthWest(),g=r.getNorthEast()):f=g=r,f.lat>=a.lat&&g.lat<=u.lat&&f.lng>=a.lng&&g.lng<=u.lng},intersects:function(r){r=Ie(r);var a=this._southWest,u=this._northEast,f=r.getSouthWest(),g=r.getNorthEast(),y=g.lat>=a.lat&&f.lat<=u.lat,D=g.lng>=a.lng&&f.lng<=u.lng;return y&&D},overlaps:function(r){r=Ie(r);var a=this._southWest,u=this._northEast,f=r.getSouthWest(),g=r.getNorthEast(),y=g.lat>a.lat&&f.lat<u.lat,D=g.lng>a.lng&&f.lng<u.lng;return y&&D},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,a){return r?(r=Ie(r),this._southWest.equals(r.getSouthWest(),a)&&this._northEast.equals(r.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ie(r,a){return r instanceof at?r:new at(r,a)}function ge(r,a,u){if(isNaN(r)||isNaN(a))throw new Error("Invalid LatLng object: ("+r+", "+a+")");this.lat=+r,this.lng=+a,u!==void 0&&(this.alt=+u)}ge.prototype={equals:function(r,a){if(!r)return!1;r=de(r);var u=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return u<=(a===void 0?1e-9:a)},toString:function(r){return"LatLng("+v(this.lat,r)+", "+v(this.lng,r)+")"},distanceTo:function(r){return jn.distance(this,de(r))},wrap:function(){return jn.wrapLatLng(this)},toBounds:function(r){var a=180*r/40075017,u=a/Math.cos(Math.PI/180*this.lat);return Ie([this.lat-a,this.lng-u],[this.lat+a,this.lng+u])},clone:function(){return new ge(this.lat,this.lng,this.alt)}};function de(r,a,u){return r instanceof ge?r:ee(r)&&typeof r[0]!="object"?r.length===3?new ge(r[0],r[1],r[2]):r.length===2?new ge(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new ge(r.lat,"lng"in r?r.lng:r.lon,r.alt):a===void 0?null:new ge(r,a,u)}var Ft={latLngToPoint:function(r,a){var u=this.projection.project(r),f=this.scale(a);return this.transformation._transform(u,f)},pointToLatLng:function(r,a){var u=this.scale(a),f=this.transformation.untransform(r,u);return this.projection.unproject(f)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var a=this.projection.bounds,u=this.scale(r),f=this.transformation.transform(a.min,u),g=this.transformation.transform(a.max,u);return new ce(f,g)},infinite:!1,wrapLatLng:function(r){var a=this.wrapLng?d(r.lng,this.wrapLng,!0):r.lng,u=this.wrapLat?d(r.lat,this.wrapLat,!0):r.lat,f=r.alt;return new ge(u,a,f)},wrapLatLngBounds:function(r){var a=r.getCenter(),u=this.wrapLatLng(a),f=a.lat-u.lat,g=a.lng-u.lng;if(f===0&&g===0)return r;var y=r.getSouthWest(),D=r.getNorthEast(),V=new ge(y.lat-f,y.lng-g),B=new ge(D.lat-f,D.lng-g);return new at(V,B)}},jn=t({},Ft,{wrapLng:[-180,180],R:6371e3,distance:function(r,a){var u=Math.PI/180,f=r.lat*u,g=a.lat*u,y=Math.sin((a.lat-r.lat)*u/2),D=Math.sin((a.lng-r.lng)*u/2),V=y*y+Math.cos(f)*Math.cos(g)*D*D,B=2*Math.atan2(Math.sqrt(V),Math.sqrt(1-V));return this.R*B}}),mt=6378137,wn={R:mt,MAX_LATITUDE:85.0511287798,project:function(r){var a=Math.PI/180,u=this.MAX_LATITUDE,f=Math.max(Math.min(u,r.lat),-u),g=Math.sin(f*a);return new H(this.R*r.lng*a,this.R*Math.log((1+g)/(1-g))/2)},unproject:function(r){var a=180/Math.PI;return new ge((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*a,r.x*a/this.R)},bounds:function(){var r=mt*Math.PI;return new ce([-r,-r],[r,r])}()};function Vt(r,a,u,f){if(ee(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=a,this._c=u,this._d=f}Vt.prototype={transform:function(r,a){return this._transform(r.clone(),a)},_transform:function(r,a){return a=a||1,r.x=a*(this._a*r.x+this._b),r.y=a*(this._c*r.y+this._d),r},untransform:function(r,a){return a=a||1,new H((r.x/a-this._b)/this._a,(r.y/a-this._d)/this._c)}};function sn(r,a,u,f){return new Vt(r,a,u,f)}var $n=t({},jn,{code:"EPSG:3857",projection:wn,transformation:function(){var r=.5/(Math.PI*wn.R);return sn(r,.5,-r,.5)}()}),fa=t({},$n,{code:"EPSG:900913"});function Yo(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function Xo(r,a){var u="",f,g,y,D,V,B;for(f=0,y=r.length;f<y;f++){for(V=r[f],g=0,D=V.length;g<D;g++)B=V[g],u+=(g?"L":"M")+B.x+" "+B.y;u+=a?ae.svg?"z":"x":""}return u||"M0 0"}var Yr=document.documentElement.style,Xr="ActiveXObject"in window,wc=Xr&&!document.addEventListener,Cc="msLaunchUri"in navigator&&!("documentMode"in document),Jo=Cn("webkit"),pa=Cn("android"),es=Cn("android 2")||Cn("android 3"),bc=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Td=pa&&Cn("Google")&&bc<537&&!("AudioNode"in window),Jr=!!window.opera,ts=!Cc&&Cn("chrome"),ns=Cn("gecko")&&!Jo&&!Jr&&!Xr,Nt=!ts&&Cn("safari"),Bt=Cn("phantom"),eo="OTransition"in Yr,Ec=navigator.platform.indexOf("Win")===0,ma=Xr&&"transition"in Yr,ga="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!es,vr="MozPerspective"in Yr,Sc=!window.L_DISABLE_3D&&(ma||ga||vr)&&!eo&&!Bt,yr=typeof orientation<"u"||Cn("mobile"),_a=yr&&Jo,Pd=yr&&ga,Tc=!window.PointerEvent&&window.MSPointerEvent,is=!!(window.PointerEvent||Tc),va="ontouchstart"in window||!!window.TouchEvent,Pc=!window.L_NO_TOUCH&&(va||is),to=yr&&Jr,ya=yr&&ns,wa=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ui=function(){var r=!1;try{var a=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",m,a),window.removeEventListener("testPassiveEventSupport",m,a)}catch{}return r}(),Dc=function(){return!!document.createElement("canvas").getContext}(),wr=!!(document.createElementNS&&Yo("svg").createSVGRect),Ic=!!wr&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),no=!wr&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var a=r.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}(),Ac=navigator.platform.indexOf("Mac")===0,Wt=navigator.platform.indexOf("Linux")===0;function Cn(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var ae={ie:Xr,ielt9:wc,edge:Cc,webkit:Jo,android:pa,android23:es,androidStock:Td,opera:Jr,chrome:ts,gecko:ns,safari:Nt,phantom:Bt,opera12:eo,win:Ec,ie3d:ma,webkit3d:ga,gecko3d:vr,any3d:Sc,mobile:yr,mobileWebkit:_a,mobileWebkit3d:Pd,msPointer:Tc,pointer:is,touch:Pc,touchNative:va,mobileOpera:to,mobileGecko:ya,retina:wa,passiveEvents:Ui,canvas:Dc,svg:wr,vml:no,inlineSvg:Ic,mac:Ac,linux:Wt},Cr=ae.msPointer?"MSPointerDown":"pointerdown",xc=ae.msPointer?"MSPointerMove":"pointermove",Mc=ae.msPointer?"MSPointerUp":"pointerup",ji=ae.msPointer?"MSPointerCancel":"pointercancel",Ca={touchstart:Cr,touchmove:xc,touchend:Mc,touchcancel:ji},Rc={touchstart:Oc,touchmove:br,touchend:br,touchcancel:br},oi={},ba=!1;function Ea(r,a,u){return a==="touchstart"&&Ta(),Rc[a]?(u=Rc[a].bind(this,u),r.addEventListener(Ca[a],u,!1),u):(console.warn("wrong event specified:",a),m)}function rs(r,a,u){if(!Ca[a]){console.warn("wrong event specified:",a);return}r.removeEventListener(Ca[a],u,!1)}function _i(r){oi[r.pointerId]=r}function kc(r){oi[r.pointerId]&&(oi[r.pointerId]=r)}function Sa(r){delete oi[r.pointerId]}function Ta(){ba||(document.addEventListener(Cr,_i,!0),document.addEventListener(xc,kc,!0),document.addEventListener(Mc,Sa,!0),document.addEventListener(ji,Sa,!0),ba=!0)}function br(r,a){if(a.pointerType!==(a.MSPOINTER_TYPE_MOUSE||"mouse")){a.touches=[];for(var u in oi)a.touches.push(oi[u]);a.changedTouches=[a],r(a)}}function Oc(r,a){a.MSPOINTER_TYPE_TOUCH&&a.pointerType===a.MSPOINTER_TYPE_TOUCH&&Et(a),br(r,a)}function Lc(r){var a={},u,f;for(f in r)u=r[f],a[f]=u&&u.bind?u.bind(r):u;return r=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var Dd=200;function os(r,a){r.addEventListener("dblclick",a);var u=0,f;function g(y){if(y.detail!==1){f=y.detail;return}if(!(y.pointerType==="mouse"||y.sourceCapabilities&&!y.sourceCapabilities.firesTouchEvents)){var D=Oa(y);if(!(D.some(function(B){return B instanceof HTMLLabelElement&&B.attributes.for})&&!D.some(function(B){return B instanceof HTMLInputElement||B instanceof HTMLSelectElement}))){var V=Date.now();V-u<=Dd?(f++,f===2&&a(Lc(y))):f=1,u=V}}}return r.addEventListener("click",g),{dblclick:a,simDblclick:g}}function Fc(r,a){r.removeEventListener("dblclick",a.dblclick),r.removeEventListener("click",a.simDblclick)}var io=qn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),si=qn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),vi=si==="webkitTransition"||si==="OTransition"?si+"End":"transitionend";function ss(r){return typeof r=="string"?document.getElementById(r):r}function ro(r,a){var u=r.style[a]||r.currentStyle&&r.currentStyle[a];if((!u||u==="auto")&&document.defaultView){var f=document.defaultView.getComputedStyle(r,null);u=f?f[a]:null}return u==="auto"?null:u}function Ue(r,a,u){var f=document.createElement(r);return f.className=a||"",u&&u.appendChild(f),f}function ht(r){var a=r.parentNode;a&&a.removeChild(r)}function oo(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function yi(r){var a=r.parentNode;a&&a.lastChild!==r&&a.appendChild(r)}function wi(r){var a=r.parentNode;a&&a.firstChild!==r&&a.insertBefore(r,a.firstChild)}function as(r,a){if(r.classList!==void 0)return r.classList.contains(a);var u=so(r);return u.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(u)}function Ae(r,a){if(r.classList!==void 0)for(var u=S(a),f=0,g=u.length;f<g;f++)r.classList.add(u[f]);else if(!as(r,a)){var y=so(r);Pa(r,(y?y+" ":"")+a)}}function bt(r,a){r.classList!==void 0?r.classList.remove(a):Pa(r,w((" "+so(r)+" ").replace(" "+a+" "," ")))}function Pa(r,a){r.className.baseVal===void 0?r.className=a:r.className.baseVal=a}function so(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function an(r,a){"opacity"in r.style?r.style.opacity=a:"filter"in r.style&&Id(r,a)}function Id(r,a){var u=!1,f="DXImageTransform.Microsoft.Alpha";try{u=r.filters.item(f)}catch{if(a===1)return}a=Math.round(a*100),u?(u.Enabled=a!==100,u.Opacity=a):r.style.filter+=" progid:"+f+"(opacity="+a+")"}function qn(r){for(var a=document.documentElement.style,u=0;u<r.length;u++)if(r[u]in a)return r[u];return!1}function Zt(r,a,u){var f=a||new H(0,0);r.style[io]=(ae.ie3d?"translate("+f.x+"px,"+f.y+"px)":"translate3d("+f.x+"px,"+f.y+"px,0)")+(u?" scale("+u+")":"")}function gt(r,a){r._leaflet_pos=a,ae.any3d?Zt(r,a):(r.style.left=a.x+"px",r.style.top=a.y+"px")}function Gn(r){return r._leaflet_pos||new H(0,0)}var Er,Qe,Sr;if("onselectstart"in document)Er=function(){Se(window,"selectstart",Et)},Qe=function(){ot(window,"selectstart",Et)};else{var ai=qn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Er=function(){if(ai){var r=document.documentElement.style;Sr=r[ai],r[ai]="none"}},Qe=function(){ai&&(document.documentElement.style[ai]=Sr,Sr=void 0)}}function $i(){Se(window,"dragstart",Et)}function Da(){ot(window,"dragstart",Et)}var ao,Ia;function Aa(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(ls(),ao=r,Ia=r.style.outlineStyle,r.style.outlineStyle="none",Se(window,"keydown",ls))}function ls(){ao&&(ao.style.outlineStyle=Ia,ao=void 0,Ia=void 0,ot(window,"keydown",ls))}function Vc(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function qi(r){var a=r.getBoundingClientRect();return{x:a.width/r.offsetWidth||1,y:a.height/r.offsetHeight||1,boundingClientRect:a}}var Ci={__proto__:null,TRANSFORM:io,TRANSITION:si,TRANSITION_END:vi,get:ss,getStyle:ro,create:Ue,remove:ht,empty:oo,toFront:yi,toBack:wi,hasClass:as,addClass:Ae,removeClass:bt,setClass:Pa,getClass:so,setOpacity:an,testProp:qn,setTransform:Zt,setPosition:gt,getPosition:Gn,get disableTextSelection(){return Er},get enableTextSelection(){return Qe},disableImageDrag:$i,enableImageDrag:Da,preventOutline:Aa,restoreOutline:ls,getSizedParentNode:Vc,getScale:qi};function Se(r,a,u,f){if(a&&typeof a=="object")for(var g in a)Ma(r,g,a[g],u);else{a=S(a);for(var y=0,D=a.length;y<D;y++)Ma(r,a[y],u,f)}return this}var bn="_leaflet_events";function ot(r,a,u,f){if(arguments.length===1)Gi(r),delete r[bn];else if(a&&typeof a=="object")for(var g in a)Ra(r,g,a[g],u);else if(a=S(a),arguments.length===2)Gi(r,function(V){return oe(a,V)!==-1});else for(var y=0,D=a.length;y<D;y++)Ra(r,a[y],u,f);return this}function Gi(r,a){for(var u in r[bn]){var f=u.split(/\d/)[0];(!a||a(f))&&Ra(r,f,null,null,u)}}var xa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ma(r,a,u,f){var g=a+l(u)+(f?"_"+l(f):"");if(r[bn]&&r[bn][g])return this;var y=function(V){return u.call(f||r,V||window.event)},D=y;!ae.touchNative&&ae.pointer&&a.indexOf("touch")===0?y=Ea(r,a,y):ae.touch&&a==="dblclick"?y=os(r,y):"addEventListener"in r?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?r.addEventListener(xa[a]||a,y,ae.passiveEvents?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(y=function(V){V=V||window.event,uo(r,V)&&D(V)},r.addEventListener(xa[a],y,!1)):r.addEventListener(a,D,!1):r.attachEvent("on"+a,y),r[bn]=r[bn]||{},r[bn][g]=y}function Ra(r,a,u,f,g){g=g||a+l(u)+(f?"_"+l(f):"");var y=r[bn]&&r[bn][g];if(!y)return this;!ae.touchNative&&ae.pointer&&a.indexOf("touch")===0?rs(r,a,y):ae.touch&&a==="dblclick"?Fc(r,y):"removeEventListener"in r?r.removeEventListener(xa[a]||a,y,!1):r.detachEvent("on"+a,y),r[bn][g]=null}function Yt(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function ka(r){return Ma(r,"wheel",Yt),this}function lo(r){return Se(r,"mousedown touchstart dblclick contextmenu",Yt),r._leaflet_disable_click=!0,this}function Et(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Hn(r){return Et(r),Yt(r),this}function Oa(r){if(r.composedPath)return r.composedPath();for(var a=[],u=r.target;u;)a.push(u),u=u.parentNode;return a}function Tr(r,a){if(!a)return new H(r.clientX,r.clientY);var u=qi(a),f=u.boundingClientRect;return new H((r.clientX-f.left)/u.x-a.clientLeft,(r.clientY-f.top)/u.y-a.clientTop)}var co=ae.linux&&ae.chrome?window.devicePixelRatio:ae.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function La(r){return ae.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/co:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function uo(r,a){var u=a.relatedTarget;if(!u)return!0;try{for(;u&&u!==r;)u=u.parentNode}catch{return!1}return u!==r}var _t={__proto__:null,on:Se,off:ot,stopPropagation:Yt,disableScrollPropagation:ka,disableClickPropagation:lo,preventDefault:Et,stop:Hn,getPropagationPath:Oa,getMousePosition:Tr,getWheelDelta:La,isExternalTarget:uo,addListener:Se,removeListener:ot},Nc=pn.extend({run:function(r,a,u,f){this.stop(),this._el=r,this._inProgress=!0,this._duration=u||.25,this._easeOutPower=1/Math.max(f||.5,.2),this._startPos=Gn(r),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=T(this._animate,this),this._step()},_step:function(r){var a=+new Date-this._startTime,u=this._duration*1e3;a<u?this._runFrame(this._easeOut(a/u),r):(this._runFrame(1),this._complete())},_runFrame:function(r,a){var u=this._startPos.add(this._offset.multiplyBy(r));a&&u._round(),gt(this._el,u),this.fire("step")},_complete:function(){x(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),Be=pn.extend({options:{crs:$n,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,a){a=A(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(de(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=si&&ae.any3d&&!ae.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Se(this._proxy,vi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,a,u){if(a=a===void 0?this._zoom:this._limitZoom(a),r=this._limitCenter(de(r),a,this.options.maxBounds),u=u||{},this._stop(),this._loaded&&!u.reset&&u!==!0){u.animate!==void 0&&(u.zoom=t({animate:u.animate},u.zoom),u.pan=t({animate:u.animate,duration:u.duration},u.pan));var f=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,a,u.zoom):this._tryAnimatedPan(r,u.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(r,a,u.pan&&u.pan.noMoveStart),this},setZoom:function(r,a){return this._loaded?this.setView(this.getCenter(),r,{zoom:a}):(this._zoom=r,this)},zoomIn:function(r,a){return r=r||(ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,a)},zoomOut:function(r,a){return r=r||(ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,a)},setZoomAround:function(r,a,u){var f=this.getZoomScale(a),g=this.getSize().divideBy(2),y=r instanceof H?r:this.latLngToContainerPoint(r),D=y.subtract(g).multiplyBy(1-1/f),V=this.containerPointToLatLng(g.add(D));return this.setView(V,a,{zoom:u})},_getBoundsCenterZoom:function(r,a){a=a||{},r=r.getBounds?r.getBounds():Ie(r);var u=W(a.paddingTopLeft||a.padding||[0,0]),f=W(a.paddingBottomRight||a.padding||[0,0]),g=this.getBoundsZoom(r,!1,u.add(f));if(g=typeof a.maxZoom=="number"?Math.min(a.maxZoom,g):g,g===1/0)return{center:r.getCenter(),zoom:g};var y=f.subtract(u).divideBy(2),D=this.project(r.getSouthWest(),g),V=this.project(r.getNorthEast(),g),B=this.unproject(D.add(V).divideBy(2).add(y),g);return{center:B,zoom:g}},fitBounds:function(r,a){if(r=Ie(r),!r.isValid())throw new Error("Bounds are not valid.");var u=this._getBoundsCenterZoom(r,a);return this.setView(u.center,u.zoom,a)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,a){return this.setView(r,this._zoom,{pan:a})},panBy:function(r,a){if(r=W(r).round(),a=a||{},!r.x&&!r.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Nc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){Ae(this._mapPane,"leaflet-pan-anim");var u=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,u,a.duration||.25,a.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,a,u){if(u=u||{},u.animate===!1||!ae.any3d)return this.setView(r,a,u);this._stop();var f=this.project(this.getCenter()),g=this.project(r),y=this.getSize(),D=this._zoom;r=de(r),a=a===void 0?D:a;var V=Math.max(y.x,y.y),B=V*this.getZoomScale(D,a),K=g.distanceTo(f)||1,re=1.42,we=re*re;function Fe(xt){var nu=xt?-1:1,UC=xt?B:V,jC=B*B-V*V+nu*we*we*K*K,$C=2*UC*we*K,kd=jC/$C,O_=Math.sqrt(kd*kd+1)-kd,qC=O_<1e-9?-18:Math.log(O_);return qC}function cn(xt){return(Math.exp(xt)-Math.exp(-xt))/2}function Ut(xt){return(Math.exp(xt)+Math.exp(-xt))/2}function Kn(xt){return cn(xt)/Ut(xt)}var gn=Fe(0);function ws(xt){return V*(Ut(gn)/Ut(gn+re*xt))}function VC(xt){return V*(Ut(gn)*Kn(gn+re*xt)-cn(gn))/we}function NC(xt){return 1-Math.pow(1-xt,1.5)}var BC=Date.now(),R_=(Fe(1)-gn)/re,zC=u.duration?1e3*u.duration:1e3*R_*.8;function k_(){var xt=(Date.now()-BC)/zC,nu=NC(xt)*R_;xt<=1?(this._flyToFrame=T(k_,this),this._move(this.unproject(f.add(g.subtract(f).multiplyBy(VC(nu)/K)),D),this.getScaleZoom(V/ws(nu),D),{flyTo:!0})):this._move(r,a)._moveEnd(!0)}return this._moveStart(!0,u.noMoveStart),k_.call(this),this},flyToBounds:function(r,a){var u=this._getBoundsCenterZoom(r,a);return this.flyTo(u.center,u.zoom,a)},setMaxBounds:function(r){return r=Ie(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var a=this.options.minZoom;return this.options.minZoom=r,this._loaded&&a!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var a=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&a!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,a){this._enforcingBounds=!0;var u=this.getCenter(),f=this._limitCenter(u,this._zoom,Ie(r));return u.equals(f)||this.panTo(f,a),this._enforcingBounds=!1,this},panInside:function(r,a){a=a||{};var u=W(a.paddingTopLeft||a.padding||[0,0]),f=W(a.paddingBottomRight||a.padding||[0,0]),g=this.project(this.getCenter()),y=this.project(r),D=this.getPixelBounds(),V=Ne([D.min.add(u),D.max.subtract(f)]),B=V.getSize();if(!V.contains(y)){this._enforcingBounds=!0;var K=y.subtract(V.getCenter()),re=V.extend(y).getSize().subtract(B);g.x+=K.x<0?-re.x:re.x,g.y+=K.y<0?-re.y:re.y,this.panTo(this.unproject(g),a),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=t({animate:!1,pan:!0},r===!0?{animate:!0}:r);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var u=this.getSize(),f=a.divideBy(2).round(),g=u.divideBy(2).round(),y=f.subtract(g);return!y.x&&!y.y?this:(r.animate&&r.pan?this.panBy(y):(r.pan&&this._rawPanBy(y),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:u}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=t({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=o(this._handleGeolocationResponse,this),u=o(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,u,r):navigator.geolocation.getCurrentPosition(a,u,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var a=r.code,u=r.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+u+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var a=r.coords.latitude,u=r.coords.longitude,f=new ge(a,u),g=f.toBounds(r.coords.accuracy*2),y=this._locateOptions;if(y.setView){var D=this.getBoundsZoom(g);this.setView(f,y.maxZoom?Math.min(D,y.maxZoom):D)}var V={latlng:f,bounds:g,timestamp:r.timestamp};for(var B in r.coords)typeof r.coords[B]=="number"&&(V[B]=r.coords[B]);this.fire("locationfound",V)}},addHandler:function(r,a){if(!a)return this;var u=this[r]=new a(this);return this._handlers.push(u),this.options[r]&&u.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ht(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(x(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)ht(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,a){var u="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),f=Ue("div",u,a||this._mapPane);return r&&(this._panes[r]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),a=this.unproject(r.getBottomLeft()),u=this.unproject(r.getTopRight());return new at(a,u)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,a,u){r=Ie(r),u=W(u||[0,0]);var f=this.getZoom()||0,g=this.getMinZoom(),y=this.getMaxZoom(),D=r.getNorthWest(),V=r.getSouthEast(),B=this.getSize().subtract(u),K=Ne(this.project(V,f),this.project(D,f)).getSize(),re=ae.any3d?this.options.zoomSnap:1,we=B.x/K.x,Fe=B.y/K.y,cn=a?Math.max(we,Fe):Math.min(we,Fe);return f=this.getScaleZoom(cn,f),re&&(f=Math.round(f/(re/100))*(re/100),f=a?Math.ceil(f/re)*re:Math.floor(f/re)*re),Math.max(g,Math.min(y,f))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,a){var u=this._getTopLeftPoint(r,a);return new ce(u,u.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,a){var u=this.options.crs;return a=a===void 0?this._zoom:a,u.scale(r)/u.scale(a)},getScaleZoom:function(r,a){var u=this.options.crs;a=a===void 0?this._zoom:a;var f=u.zoom(r*u.scale(a));return isNaN(f)?1/0:f},project:function(r,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(de(r),a)},unproject:function(r,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(W(r),a)},layerPointToLatLng:function(r){var a=W(r).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(r){var a=this.project(de(r))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(de(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(Ie(r))},distance:function(r,a){return this.options.crs.distance(de(r),de(a))},containerPointToLayerPoint:function(r){return W(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return W(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var a=this.containerPointToLayerPoint(W(r));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(de(r)))},mouseEventToContainerPoint:function(r){return Tr(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var a=this._container=ss(r);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Se(a,"scroll",this._onScroll,this),this._containerId=l(a)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&ae.any3d,Ae(r,"leaflet-container"+(ae.touch?" leaflet-touch":"")+(ae.retina?" leaflet-retina":"")+(ae.ielt9?" leaflet-oldie":"")+(ae.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=ro(r,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&a!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),gt(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ae(r.markerPane,"leaflet-zoom-hide"),Ae(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,a,u){gt(this._mapPane,new H(0,0));var f=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var g=this._zoom!==a;this._moveStart(g,u)._move(r,a)._moveEnd(g),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(r,a){return r&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(r,a,u,f){a===void 0&&(a=this._zoom);var g=this._zoom!==a;return this._zoom=a,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),f?u&&u.pinch&&this.fire("zoom",u):((g||u&&u.pinch)&&this.fire("zoom",u),this.fire("move",u)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return x(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){gt(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[l(this._container)]=this;var a=r?ot:Se;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),ae.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){x(this._resizeRequest),this._resizeRequest=T(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,a){for(var u=[],f,g=a==="mouseout"||a==="mouseover",y=r.target||r.srcElement,D=!1;y;){if(f=this._targets[l(y)],f&&(a==="click"||a==="preclick")&&this._draggableMoved(f)){D=!0;break}if(f&&f.listens(a,!0)&&(g&&!uo(y,r)||(u.push(f),g))||y===this._container)break;y=y.parentNode}return!u.length&&!D&&!g&&this.listens(a,!0)&&(u=[this]),u},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var a=r.target||r.srcElement;if(!(!this._loaded||a._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(a))){var u=r.type;u==="mousedown"&&Aa(a),this._fireDOMEvent(r,u)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,a,u){if(r.type==="click"){var f=t({},r);f.type="preclick",this._fireDOMEvent(f,f.type,u)}var g=this._findEventTargets(r,a);if(u){for(var y=[],D=0;D<u.length;D++)u[D].listens(a,!0)&&y.push(u[D]);g=y.concat(g)}if(g.length){a==="contextmenu"&&Et(r);var V=g[0],B={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var K=V.getLatLng&&(!V._radius||V._radius<=10);B.containerPoint=K?this.latLngToContainerPoint(V.getLatLng()):this.mouseEventToContainerPoint(r),B.layerPoint=this.containerPointToLayerPoint(B.containerPoint),B.latlng=K?V.getLatLng():this.layerPointToLatLng(B.layerPoint)}for(D=0;D<g.length;D++)if(g[D].fire(a,B,!0),B.originalEvent._stopped||g[D].options.bubblingMouseEvents===!1&&oe(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,a=this._handlers.length;r<a;r++)this._handlers[r].disable()},whenReady:function(r,a){return this._loaded?r.call(a||this,{target:this}):this.on("load",r,a),this},_getMapPanePos:function(){return Gn(this._mapPane)||new H(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,a){var u=r&&a!==void 0?this._getNewPixelOrigin(r,a):this.getPixelOrigin();return u.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,a){var u=this.getSize()._divideBy(2);return this.project(r,a)._subtract(u)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,a,u){var f=this._getNewPixelOrigin(u,a);return this.project(r,a)._subtract(f)},_latLngBoundsToNewLayerBounds:function(r,a,u){var f=this._getNewPixelOrigin(u,a);return Ne([this.project(r.getSouthWest(),a)._subtract(f),this.project(r.getNorthWest(),a)._subtract(f),this.project(r.getSouthEast(),a)._subtract(f),this.project(r.getNorthEast(),a)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,a,u){if(!u)return r;var f=this.project(r,a),g=this.getSize().divideBy(2),y=new ce(f.subtract(g),f.add(g)),D=this._getBoundsOffset(y,u,a);return Math.abs(D.x)<=1&&Math.abs(D.y)<=1?r:this.unproject(f.add(D),a)},_limitOffset:function(r,a){if(!a)return r;var u=this.getPixelBounds(),f=new ce(u.min.add(r),u.max.add(r));return r.add(this._getBoundsOffset(f,a))},_getBoundsOffset:function(r,a,u){var f=Ne(this.project(a.getNorthEast(),u),this.project(a.getSouthWest(),u)),g=f.min.subtract(r.min),y=f.max.subtract(r.max),D=this._rebound(g.x,-y.x),V=this._rebound(g.y,-y.y);return new H(D,V)},_rebound:function(r,a){return r+a>0?Math.round(r-a)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(a))},_limitZoom:function(r){var a=this.getMinZoom(),u=this.getMaxZoom(),f=ae.any3d?this.options.zoomSnap:1;return f&&(r=Math.round(r/f)*f),Math.max(a,Math.min(u,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){bt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,a){var u=this._getCenterOffset(r)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(u)?!1:(this.panBy(u,a),!0)},_createAnimProxy:function(){var r=this._proxy=Ue("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(a){var u=io,f=this._proxy.style[u];Zt(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),f===this._proxy.style[u]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ht(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),a=this.getZoom();Zt(this._proxy,this.project(r,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,a,u){if(this._animatingZoom)return!0;if(u=u||{},!this._zoomAnimated||u.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var f=this.getZoomScale(a),g=this._getCenterOffset(r)._divideBy(1-1/f);return u.animate!==!0&&!this.getSize().contains(g)?!1:(T(function(){this._moveStart(!0,u.noMoveStart||!1)._animateZoom(r,a,!0)},this),!0)},_animateZoom:function(r,a,u,f){this._mapPane&&(u&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=a,Ae(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:a,noUpdate:f}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&bt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Bc(r,a){return new Be(r,a)}var mn=k.extend({options:{position:"topright"},initialize:function(r){A(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var a=this._map;return a&&a.removeControl(this),this.options.position=r,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var a=this._container=this.onAdd(r),u=this.getPosition(),f=r._controlCorners[u];return Ae(a,"leaflet-control"),u.indexOf("bottom")!==-1?f.insertBefore(a,f.firstChild):f.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ht(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),Pr=function(r){return new mn(r)};Be.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},a="leaflet-",u=this._controlContainer=Ue("div",a+"control-container",this._container);function f(g,y){var D=a+g+" "+a+y;r[g+y]=Ue("div",D,u)}f("top","left"),f("top","right"),f("bottom","left"),f("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)ht(this._controlCorners[r]);ht(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ho=mn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,a,u,f){return u<f?-1:f<u?1:0}},initialize:function(r,a,u){A(this,u),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var f in r)this._addLayer(r[f],f);for(f in a)this._addLayer(a[f],f,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return mn.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,a){return this._addLayer(r,a),this._map?this._update():this},addOverlay:function(r,a){return this._addLayer(r,a,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var a=this._getLayer(l(r));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){Ae(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Ae(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):bt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return bt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",a=this._container=Ue("div",r),u=this.options.collapsed;a.setAttribute("aria-haspopup",!0),lo(a),ka(a);var f=this._section=Ue("section",r+"-list");u&&(this._map.on("click",this.collapse,this),Se(a,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var g=this._layersLink=Ue("a",r+"-toggle",a);g.href="#",g.title="Layers",g.setAttribute("role","button"),Se(g,{keydown:function(y){y.keyCode===13&&this._expandSafely()},click:function(y){Et(y),this._expandSafely()}},this),u||this.expand(),this._baseLayersList=Ue("div",r+"-base",f),this._separator=Ue("div",r+"-separator",f),this._overlaysList=Ue("div",r+"-overlays",f),a.appendChild(f)},_getLayer:function(r){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&l(this._layers[a].layer)===r)return this._layers[a]},_addLayer:function(r,a,u){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:a,overlay:u}),this.options.sortLayers&&this._layers.sort(o(function(f,g){return this.options.sortFunction(f.layer,g.layer,f.name,g.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;oo(this._baseLayersList),oo(this._overlaysList),this._layerControlInputs=[];var r,a,u,f,g=0;for(u=0;u<this._layers.length;u++)f=this._layers[u],this._addItem(f),a=a||f.overlay,r=r||!f.overlay,g+=f.overlay?0:1;return this.options.hideSingleBase&&(r=r&&g>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=a&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var a=this._getLayer(l(r.target)),u=a.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;u&&this._map.fire(u,a)},_createRadioElement:function(r,a){var u='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(a?' checked="checked"':"")+"/>",f=document.createElement("div");return f.innerHTML=u,f.firstChild},_addItem:function(r){var a=document.createElement("label"),u=this._map.hasLayer(r.layer),f;r.overlay?(f=document.createElement("input"),f.type="checkbox",f.className="leaflet-control-layers-selector",f.defaultChecked=u):f=this._createRadioElement("leaflet-base-layers_"+l(this),u),this._layerControlInputs.push(f),f.layerId=l(r.layer),Se(f,"click",this._onInputClick,this);var g=document.createElement("span");g.innerHTML=" "+r.name;var y=document.createElement("span");a.appendChild(y),y.appendChild(f),y.appendChild(g);var D=r.overlay?this._overlaysList:this._baseLayersList;return D.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,a,u,f=[],g=[];this._handlingClick=!0;for(var y=r.length-1;y>=0;y--)a=r[y],u=this._getLayer(a.layerId).layer,a.checked?f.push(u):a.checked||g.push(u);for(y=0;y<g.length;y++)this._map.hasLayer(g[y])&&this._map.removeLayer(g[y]);for(y=0;y<f.length;y++)this._map.hasLayer(f[y])||this._map.addLayer(f[y]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,a,u,f=this._map.getZoom(),g=r.length-1;g>=0;g--)a=r[g],u=this._getLayer(a.layerId).layer,a.disabled=u.options.minZoom!==void 0&&f<u.options.minZoom||u.options.maxZoom!==void 0&&f>u.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Se(r,"click",Et),this.expand();var a=this;setTimeout(function(){ot(r,"click",Et),a._preventClick=!1})}}),zc=function(r,a,u){return new ho(r,a,u)},En=mn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var a="leaflet-control-zoom",u=Ue("div",a+" leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,a+"-in",u,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,a+"-out",u,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),u},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,a,u,f,g){var y=Ue("a",u,f);return y.innerHTML=r,y.href="#",y.title=a,y.setAttribute("role","button"),y.setAttribute("aria-label",a),lo(y),Se(y,"click",Hn),Se(y,"click",g,this),Se(y,"click",this._refocusOnMap,this),y},_updateDisabled:function(){var r=this._map,a="leaflet-disabled";bt(this._zoomInButton,a),bt(this._zoomOutButton,a),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(Ae(this._zoomOutButton,a),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(Ae(this._zoomInButton,a),this._zoomInButton.setAttribute("aria-disabled","true"))}});Be.mergeOptions({zoomControl:!0}),Be.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new En,this.addControl(this.zoomControl))});var Uc=function(r){return new En(r)},jc=mn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var a="leaflet-control-scale",u=Ue("div",a),f=this.options;return this._addScales(f,a+"-line",u),r.on(f.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),u},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,a,u){r.metric&&(this._mScale=Ue("div",a,u)),r.imperial&&(this._iScale=Ue("div",a,u))},_update:function(){var r=this._map,a=r.getSize().y/2,u=r.distance(r.containerPointToLatLng([0,a]),r.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(u)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var a=this._getRoundNum(r),u=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,u,a/r)},_updateImperial:function(r){var a=r*3.2808399,u,f,g;a>5280?(u=a/5280,f=this._getRoundNum(u),this._updateScale(this._iScale,f+" mi",f/u)):(g=this._getRoundNum(a),this._updateScale(this._iScale,g+" ft",g/a))},_updateScale:function(r,a,u){r.style.width=Math.round(this.options.maxWidth*u)+"px",r.innerHTML=a},_getRoundNum:function(r){var a=Math.pow(10,(Math.floor(r)+"").length-1),u=r/a;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:1,a*u}}),fo=function(r){return new jc(r)},$c='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',po=mn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ae.inlineSvg?$c+" ":"")+"Leaflet</a>"},initialize:function(r){A(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Ue("div","leaflet-control-attribution"),lo(this._container);for(var a in r._layers)r._layers[a].getAttribution&&this.addAttribution(r._layers[a].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var a in this._attributions)this._attributions[a]&&r.push(a);var u=[];this.options.prefix&&u.push(this.options.prefix),r.length&&u.push(r.join(", ")),this._container.innerHTML=u.join(' <span aria-hidden="true">|</span> ')}}});Be.mergeOptions({attributionControl:!0}),Be.addInitHook(function(){this.options.attributionControl&&new po().addTo(this)});var cs=function(r){return new po(r)};mn.Layers=ho,mn.Zoom=En,mn.Scale=jc,mn.Attribution=po,Pr.layers=zc,Pr.zoom=Uc,Pr.scale=fo,Pr.attribution=cs;var Sn=k.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Sn.addTo=function(r,a){return r.addHandler(a,this),this};var us={Events:ut},qc=ae.touch?"touchstart mousedown":"mousedown",li=pn.extend({options:{clickTolerance:3},initialize:function(r,a,u,f){A(this,f),this._element=r,this._dragStartTarget=a||r,this._preventOutline=u},enable:function(){this._enabled||(Se(this._dragStartTarget,qc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(li._dragging===this&&this.finishDrag(!0),ot(this._dragStartTarget,qc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!as(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){li._dragging===this&&this.finishDrag();return}if(!(li._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(li._dragging=this,this._preventOutline&&Aa(this._element),$i(),Er(),!this._moving)){this.fire("down");var a=r.touches?r.touches[0]:r,u=Vc(this._element);this._startPoint=new H(a.clientX,a.clientY),this._startPos=Gn(this._element),this._parentScale=qi(u);var f=r.type==="mousedown";Se(document,f?"mousemove":"touchmove",this._onMove,this),Se(document,f?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var a=r.touches&&r.touches.length===1?r.touches[0]:r,u=new H(a.clientX,a.clientY)._subtract(this._startPoint);!u.x&&!u.y||Math.abs(u.x)+Math.abs(u.y)<this.options.clickTolerance||(u.x/=this._parentScale.x,u.y/=this._parentScale.y,Et(r),this._moved||(this.fire("dragstart"),this._moved=!0,Ae(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ae(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(u),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),gt(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){bt(document.body,"leaflet-dragging"),this._lastTarget&&(bt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ot(document,"mousemove touchmove",this._onMove,this),ot(document,"mouseup touchend touchcancel",this._onUp,this),Da(),Qe();var a=this._moved&&this._moving;this._moving=!1,li._dragging=!1,a&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function Dr(r,a,u){var f,g=[1,4,2,8],y,D,V,B,K,re,we,Fe;for(y=0,re=r.length;y<re;y++)r[y]._code=bi(r[y],a);for(V=0;V<4;V++){for(we=g[V],f=[],y=0,re=r.length,D=re-1;y<re;D=y++)B=r[y],K=r[D],B._code&we?K._code&we||(Fe=mo(K,B,we,a,u),Fe._code=bi(Fe,a),f.push(Fe)):(K._code&we&&(Fe=mo(K,B,we,a,u),Fe._code=bi(Fe,a),f.push(Fe)),f.push(B));r=f}return r}function Fa(r,a){var u,f,g,y,D,V,B,K,re;if(!r||r.length===0)throw new Error("latlngs not passed");ln(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var we=de([0,0]),Fe=Ie(r),cn=Fe.getNorthWest().distanceTo(Fe.getSouthWest())*Fe.getNorthEast().distanceTo(Fe.getNorthWest());cn<1700&&(we=hs(r));var Ut=r.length,Kn=[];for(u=0;u<Ut;u++){var gn=de(r[u]);Kn.push(a.project(de([gn.lat-we.lat,gn.lng-we.lng])))}for(V=B=K=0,u=0,f=Ut-1;u<Ut;f=u++)g=Kn[u],y=Kn[f],D=g.y*y.x-y.y*g.x,B+=(g.x+y.x)*D,K+=(g.y+y.y)*D,V+=D*3;V===0?re=Kn[0]:re=[B/V,K/V];var ws=a.unproject(W(re));return de([ws.lat+we.lat,ws.lng+we.lng])}function hs(r){for(var a=0,u=0,f=0,g=0;g<r.length;g++){var y=de(r[g]);a+=y.lat,u+=y.lng,f++}return de([a/f,u/f])}var Va={__proto__:null,clipPolygon:Dr,polygonCenter:Fa,centroid:hs};function ds(r,a){if(!a||!r.length)return r.slice();var u=a*a;return r=Hi(r,u),r=Gc(r,u),r}function Na(r,a,u){return Math.sqrt(Lt(r,a,u,!0))}function fs(r,a,u){return Lt(r,a,u)}function Gc(r,a){var u=r.length,f=typeof Uint8Array<"u"?Uint8Array:Array,g=new f(u);g[0]=g[u-1]=1,ps(r,g,a,0,u-1);var y,D=[];for(y=0;y<u;y++)g[y]&&D.push(r[y]);return D}function ps(r,a,u,f,g){var y=0,D,V,B;for(V=f+1;V<=g-1;V++)B=Lt(r[V],r[f],r[g],!0),B>y&&(D=V,y=B);y>u&&(a[D]=1,ps(r,a,u,f,D),ps(r,a,u,D,g))}function Hi(r,a){for(var u=[r[0]],f=1,g=0,y=r.length;f<y;f++)ms(r[f],r[g])>a&&(u.push(r[f]),g=f);return g<y-1&&u.push(r[y-1]),u}var Ba;function za(r,a,u,f,g){var y=f?Ba:bi(r,u),D=bi(a,u),V,B,K;for(Ba=D;;){if(!(y|D))return[r,a];if(y&D)return!1;V=y||D,B=mo(r,a,V,u,g),K=bi(B,u),V===y?(r=B,y=K):(a=B,D=K)}}function mo(r,a,u,f,g){var y=a.x-r.x,D=a.y-r.y,V=f.min,B=f.max,K,re;return u&8?(K=r.x+y*(B.y-r.y)/D,re=B.y):u&4?(K=r.x+y*(V.y-r.y)/D,re=V.y):u&2?(K=B.x,re=r.y+D*(B.x-r.x)/y):u&1&&(K=V.x,re=r.y+D*(V.x-r.x)/y),new H(K,re,g)}function bi(r,a){var u=0;return r.x<a.min.x?u|=1:r.x>a.max.x&&(u|=2),r.y<a.min.y?u|=4:r.y>a.max.y&&(u|=8),u}function ms(r,a){var u=a.x-r.x,f=a.y-r.y;return u*u+f*f}function Lt(r,a,u,f){var g=a.x,y=a.y,D=u.x-g,V=u.y-y,B=D*D+V*V,K;return B>0&&(K=((r.x-g)*D+(r.y-y)*V)/B,K>1?(g=u.x,y=u.y):K>0&&(g+=D*K,y+=V*K)),D=r.x-g,V=r.y-y,f?D*D+V*V:new H(g,y)}function ln(r){return!ee(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function Ua(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ln(r)}function Ki(r,a){var u,f,g,y,D,V,B,K;if(!r||r.length===0)throw new Error("latlngs not passed");ln(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var re=de([0,0]),we=Ie(r),Fe=we.getNorthWest().distanceTo(we.getSouthWest())*we.getNorthEast().distanceTo(we.getNorthWest());Fe<1700&&(re=hs(r));var cn=r.length,Ut=[];for(u=0;u<cn;u++){var Kn=de(r[u]);Ut.push(a.project(de([Kn.lat-re.lat,Kn.lng-re.lng])))}for(u=0,f=0;u<cn-1;u++)f+=Ut[u].distanceTo(Ut[u+1])/2;if(f===0)K=Ut[0];else for(u=0,y=0;u<cn-1;u++)if(D=Ut[u],V=Ut[u+1],g=D.distanceTo(V),y+=g,y>f){B=(y-f)/g,K=[V.x-B*(V.x-D.x),V.y-B*(V.y-D.y)];break}var gn=a.unproject(W(K));return de([gn.lat+re.lat,gn.lng+re.lng])}var c={__proto__:null,simplify:ds,pointToSegmentDistance:Na,closestPointOnSegment:fs,clipSegment:za,_getEdgeIntersection:mo,_getBitCode:bi,_sqClosestPointOnSegment:Lt,isFlat:ln,_flat:Ua,polylineCenter:Ki},p={project:function(r){return new H(r.lng,r.lat)},unproject:function(r){return new ge(r.y,r.x)},bounds:new ce([-180,-90],[180,90])},_={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ce([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var a=Math.PI/180,u=this.R,f=r.lat*a,g=this.R_MINOR/u,y=Math.sqrt(1-g*g),D=y*Math.sin(f),V=Math.tan(Math.PI/4-f/2)/Math.pow((1-D)/(1+D),y/2);return f=-u*Math.log(Math.max(V,1e-10)),new H(r.lng*a*u,f)},unproject:function(r){for(var a=180/Math.PI,u=this.R,f=this.R_MINOR/u,g=Math.sqrt(1-f*f),y=Math.exp(-r.y/u),D=Math.PI/2-2*Math.atan(y),V=0,B=.1,K;V<15&&Math.abs(B)>1e-7;V++)K=g*Math.sin(D),K=Math.pow((1-K)/(1+K),g/2),B=Math.PI/2-2*Math.atan(y*K)-D,D+=B;return new ge(D*a,r.x*a/u)}},C={__proto__:null,LonLat:p,Mercator:_,SphericalMercator:wn},O=t({},jn,{code:"EPSG:3395",projection:_,transformation:function(){var r=.5/(Math.PI*_.R);return sn(r,.5,-r,.5)}()}),z=t({},jn,{code:"EPSG:4326",projection:p,transformation:sn(1/180,1,-1/180,.5)}),Y=t({},Ft,{projection:p,transformation:sn(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,a){var u=a.lng-r.lng,f=a.lat-r.lat;return Math.sqrt(u*u+f*f)},infinite:!0});Ft.Earth=jn,Ft.EPSG3395=O,Ft.EPSG3857=$n,Ft.EPSG900913=fa,Ft.EPSG4326=z,Ft.Simple=Y;var Le=pn.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[l(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[l(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var a=r.target;if(a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var u=this.getEvents();a.on(u,this),this.once("remove",function(){a.off(u,this)},this)}this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this})}}});Be.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var a=l(r);return this._layers[a]?this:(this._layers[a]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var a=l(r);return this._layers[a]?(this._loaded&&r.onRemove(this),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return l(r)in this._layers},eachLayer:function(r,a){for(var u in this._layers)r.call(a,this._layers[u]);return this},_addLayers:function(r){r=r?ee(r)?r:[r]:[];for(var a=0,u=r.length;a<u;a++)this.addLayer(r[a])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[l(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var a=l(r);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,a=-1/0,u=this._getZoomSpan();for(var f in this._zoomBoundLayers){var g=this._zoomBoundLayers[f].options;r=g.minZoom===void 0?r:Math.min(r,g.minZoom),a=g.maxZoom===void 0?a:Math.max(a,g.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=r===1/0?void 0:r,u!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var vt=Le.extend({initialize:function(r,a){A(this,a),this._layers={};var u,f;if(r)for(u=0,f=r.length;u<f;u++)this.addLayer(r[u])},addLayer:function(r){var a=this.getLayerId(r);return this._layers[a]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var a=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(r){var a=typeof r=="number"?r:this.getLayerId(r);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var a=Array.prototype.slice.call(arguments,1),u,f;for(u in this._layers)f=this._layers[u],f[r]&&f[r].apply(f,a);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,a){for(var u in this._layers)r.call(a,this._layers[u]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return l(r)}}),je=function(r,a){return new vt(r,a)},dt=vt.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),vt.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),vt.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new at;for(var a in this._layers){var u=this._layers[a];r.extend(u.getBounds?u.getBounds():u.getLatLng())}return r}}),zt=function(r,a){return new dt(r,a)},Tn=k.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){A(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,a){var u=this._getIconUrl(r);if(!u){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var f=this._createImg(u,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(f,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f},_setIconStyles:function(r,a){var u=this.options,f=u[a+"Size"];typeof f=="number"&&(f=[f,f]);var g=W(f),y=W(a==="shadow"&&u.shadowAnchor||u.iconAnchor||g&&g.divideBy(2,!0));r.className="leaflet-marker-"+a+" "+(u.className||""),y&&(r.style.marginLeft=-y.x+"px",r.style.marginTop=-y.y+"px"),g&&(r.style.width=g.x+"px",r.style.height=g.y+"px")},_createImg:function(r,a){return a=a||document.createElement("img"),a.src=r,a},_getIconUrl:function(r){return ae.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Pn(r){return new Tn(r)}var Ei=Tn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof Ei.imagePath!="string"&&(Ei.imagePath=this._detectIconPath()),(this.options.imagePath||Ei.imagePath)+Tn.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var a=function(u,f,g){var y=f.exec(u);return y&&y[g]};return r=a(r,/^url\((['"])?(.+)\1\)$/,2),r&&a(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Ue("div","leaflet-default-icon-path",document.body),a=ro(r,"background-image")||ro(r,"backgroundImage");if(document.body.removeChild(r),a=this._stripUrl(a),a)return a;var u=document.querySelector('link[href$="leaflet.css"]');return u?u.href.substring(0,u.href.length-11-1):""}}),gs=Sn.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new li(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ae(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&bt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var a=this._marker,u=a._map,f=this._marker.options.autoPanSpeed,g=this._marker.options.autoPanPadding,y=Gn(a._icon),D=u.getPixelBounds(),V=u.getPixelOrigin(),B=Ne(D.min._subtract(V).add(g),D.max._subtract(V).subtract(g));if(!B.contains(y)){var K=W((Math.max(B.max.x,y.x)-B.max.x)/(D.max.x-B.max.x)-(Math.min(B.min.x,y.x)-B.min.x)/(D.min.x-B.min.x),(Math.max(B.max.y,y.y)-B.max.y)/(D.max.y-B.max.y)-(Math.min(B.min.y,y.y)-B.min.y)/(D.min.y-B.min.y)).multiplyBy(f);u.panBy(K,{animate:!1}),this._draggable._newPos._add(K),this._draggable._startPos._add(K),gt(a._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=T(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(x(this._panRequest),this._panRequest=T(this._adjustPan.bind(this,r)))},_onDrag:function(r){var a=this._marker,u=a._shadow,f=Gn(a._icon),g=a._map.layerPointToLatLng(f);u&&gt(u,f),a._latlng=g,r.latlng=g,r.oldLatLng=this._oldLatLng,a.fire("move",r).fire("drag",r)},_onDragEnd:function(r){x(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),Hc=Le.extend({options:{icon:new Ei,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,a){A(this,a),this._latlng=de(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var a=this._latlng;return this._latlng=de(r),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),u=r.icon.createIcon(this._icon),f=!1;u!==this._icon&&(this._icon&&this._removeIcon(),f=!0,r.title&&(u.title=r.title),u.tagName==="IMG"&&(u.alt=r.alt||"")),Ae(u,a),r.keyboard&&(u.tabIndex="0",u.setAttribute("role","button")),this._icon=u,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Se(u,"focus",this._panOnFocus,this);var g=r.icon.createShadow(this._shadow),y=!1;g!==this._shadow&&(this._removeShadow(),y=!0),g&&(Ae(g,a),g.alt=""),this._shadow=g,r.opacity<1&&this._updateOpacity(),f&&this.getPane().appendChild(this._icon),this._initInteraction(),g&&y&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ot(this._icon,"focus",this._panOnFocus,this),ht(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ht(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&gt(this._icon,r),this._shadow&&gt(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(Ae(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),gs)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new gs(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&an(this._icon,r),this._shadow&&an(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var a=this.options.icon.options,u=a.iconSize?W(a.iconSize):W(0,0),f=a.iconAnchor?W(a.iconAnchor):W(0,0);r.panInside(this._latlng,{paddingTopLeft:f,paddingBottomRight:u.subtract(f)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function yC(r,a){return new Hc(r,a)}var Ir=Le.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return A(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Kc=Ir.extend({options:{fill:!0,radius:10},initialize:function(r,a){A(this,a),this._latlng=de(r),this._radius=this.options.radius},setLatLng:function(r){var a=this._latlng;return this._latlng=de(r),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var a=r&&r.radius||this._radius;return Ir.prototype.setStyle.call(this,r),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,a=this._radiusY||r,u=this._clickTolerance(),f=[r+u,a+u];this._pxBounds=new ce(this._point.subtract(f),this._point.add(f))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function wC(r,a){return new Kc(r,a)}var Ad=Kc.extend({initialize:function(r,a,u){if(typeof a=="number"&&(a=t({},u,{radius:a})),A(this,a),this._latlng=de(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new at(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Ir.prototype.setStyle,_project:function(){var r=this._latlng.lng,a=this._latlng.lat,u=this._map,f=u.options.crs;if(f.distance===jn.distance){var g=Math.PI/180,y=this._mRadius/jn.R/g,D=u.project([a+y,r]),V=u.project([a-y,r]),B=D.add(V).divideBy(2),K=u.unproject(B).lat,re=Math.acos((Math.cos(y*g)-Math.sin(a*g)*Math.sin(K*g))/(Math.cos(a*g)*Math.cos(K*g)))/g;(isNaN(re)||re===0)&&(re=y/Math.cos(Math.PI/180*a)),this._point=B.subtract(u.getPixelOrigin()),this._radius=isNaN(re)?0:B.x-u.project([K,r-re]).x,this._radiusY=B.y-D.y}else{var we=f.unproject(f.project(this._latlng).subtract([this._mRadius,0]));this._point=u.latLngToLayerPoint(this._latlng),this._radius=this._point.x-u.latLngToLayerPoint(we).x}this._updateBounds()}});function CC(r,a,u){return new Ad(r,a,u)}var Wi=Ir.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,a){A(this,a),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var a=1/0,u=null,f=Lt,g,y,D=0,V=this._parts.length;D<V;D++)for(var B=this._parts[D],K=1,re=B.length;K<re;K++){g=B[K-1],y=B[K];var we=f(r,g,y,!0);we<a&&(a=we,u=f(r,g,y))}return u&&(u.distance=Math.sqrt(a)),u},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ki(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,a){return a=a||this._defaultShape(),r=de(r),a.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new at,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return ln(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var a=[],u=ln(r),f=0,g=r.length;f<g;f++)u?(a[f]=de(r[f]),this._bounds.extend(a[f])):a[f]=this._convertLatLngs(r[f]);return a},_project:function(){var r=new ce;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),a=new H(r,r);this._rawPxBounds&&(this._pxBounds=new ce([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)]))},_projectLatlngs:function(r,a,u){var f=r[0]instanceof ge,g=r.length,y,D;if(f){for(D=[],y=0;y<g;y++)D[y]=this._map.latLngToLayerPoint(r[y]),u.extend(D[y]);a.push(D)}else for(y=0;y<g;y++)this._projectLatlngs(r[y],a,u)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,u,f,g,y,D,V,B;for(u=0,g=0,y=this._rings.length;u<y;u++)for(B=this._rings[u],f=0,D=B.length;f<D-1;f++)V=za(B[f],B[f+1],r,f,!0),V&&(a[g]=a[g]||[],a[g].push(V[0]),(V[1]!==B[f+1]||f===D-2)&&(a[g].push(V[1]),g++))}},_simplifyPoints:function(){for(var r=this._parts,a=this.options.smoothFactor,u=0,f=r.length;u<f;u++)r[u]=ds(r[u],a)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,a){var u,f,g,y,D,V,B=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(u=0,y=this._parts.length;u<y;u++)for(V=this._parts[u],f=0,D=V.length,g=D-1;f<D;g=f++)if(!(!a&&f===0)&&Na(r,V[g],V[f])<=B)return!0;return!1}});function bC(r,a){return new Wi(r,a)}Wi._flat=Ua;var _s=Wi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Fa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var a=Wi.prototype._convertLatLngs.call(this,r),u=a.length;return u>=2&&a[0]instanceof ge&&a[0].equals(a[u-1])&&a.pop(),a},_setLatLngs:function(r){Wi.prototype._setLatLngs.call(this,r),ln(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ln(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,a=this.options.weight,u=new H(a,a);if(r=new ce(r.min.subtract(u),r.max.add(u)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var f=0,g=this._rings.length,y;f<g;f++)y=Dr(this._rings[f],r,!0),y.length&&this._parts.push(y)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var a=!1,u,f,g,y,D,V,B,K;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(y=0,B=this._parts.length;y<B;y++)for(u=this._parts[y],D=0,K=u.length,V=K-1;D<K;V=D++)f=u[D],g=u[V],f.y>r.y!=g.y>r.y&&r.x<(g.x-f.x)*(r.y-f.y)/(g.y-f.y)+f.x&&(a=!a);return a||Wi.prototype._containsPoint.call(this,r,!0)}});function EC(r,a){return new _s(r,a)}var Zi=dt.extend({initialize:function(r,a){A(this,a),this._layers={},r&&this.addData(r)},addData:function(r){var a=ee(r)?r:r.features,u,f,g;if(a){for(u=0,f=a.length;u<f;u++)g=a[u],(g.geometries||g.geometry||g.features||g.coordinates)&&this.addData(g);return this}var y=this.options;if(y.filter&&!y.filter(r))return this;var D=Wc(r,y);return D?(D.feature=Yc(r),D.defaultOptions=D.options,this.resetStyle(D),y.onEachFeature&&y.onEachFeature(r,D),this.addLayer(D)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=t({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(a){this._setLayerStyle(a,r)},this)},_setLayerStyle:function(r,a){r.setStyle&&(typeof a=="function"&&(a=a(r.feature)),r.setStyle(a))}});function Wc(r,a){var u=r.type==="Feature"?r.geometry:r,f=u?u.coordinates:null,g=[],y=a&&a.pointToLayer,D=a&&a.coordsToLatLng||xd,V,B,K,re;if(!f&&!u)return null;switch(u.type){case"Point":return V=D(f),p_(y,r,V,a);case"MultiPoint":for(K=0,re=f.length;K<re;K++)V=D(f[K]),g.push(p_(y,r,V,a));return new dt(g);case"LineString":case"MultiLineString":return B=Zc(f,u.type==="LineString"?0:1,D),new Wi(B,a);case"Polygon":case"MultiPolygon":return B=Zc(f,u.type==="Polygon"?1:2,D),new _s(B,a);case"GeometryCollection":for(K=0,re=u.geometries.length;K<re;K++){var we=Wc({geometry:u.geometries[K],type:"Feature",properties:r.properties},a);we&&g.push(we)}return new dt(g);case"FeatureCollection":for(K=0,re=u.features.length;K<re;K++){var Fe=Wc(u.features[K],a);Fe&&g.push(Fe)}return new dt(g);default:throw new Error("Invalid GeoJSON object.")}}function p_(r,a,u,f){return r?r(a,u):new Hc(u,f&&f.markersInheritOptions&&f)}function xd(r){return new ge(r[1],r[0],r[2])}function Zc(r,a,u){for(var f=[],g=0,y=r.length,D;g<y;g++)D=a?Zc(r[g],a-1,u):(u||xd)(r[g]),f.push(D);return f}function Md(r,a){return r=de(r),r.alt!==void 0?[v(r.lng,a),v(r.lat,a),v(r.alt,a)]:[v(r.lng,a),v(r.lat,a)]}function Qc(r,a,u,f){for(var g=[],y=0,D=r.length;y<D;y++)g.push(a?Qc(r[y],ln(r[y])?0:a-1,u,f):Md(r[y],f));return!a&&u&&g.length>0&&g.push(g[0].slice()),g}function vs(r,a){return r.feature?t({},r.feature,{geometry:a}):Yc(a)}function Yc(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Rd={toGeoJSON:function(r){return vs(this,{type:"Point",coordinates:Md(this.getLatLng(),r)})}};Hc.include(Rd),Ad.include(Rd),Kc.include(Rd),Wi.include({toGeoJSON:function(r){var a=!ln(this._latlngs),u=Qc(this._latlngs,a?1:0,!1,r);return vs(this,{type:(a?"Multi":"")+"LineString",coordinates:u})}}),_s.include({toGeoJSON:function(r){var a=!ln(this._latlngs),u=a&&!ln(this._latlngs[0]),f=Qc(this._latlngs,u?2:a?1:0,!0,r);return a||(f=[f]),vs(this,{type:(u?"Multi":"")+"Polygon",coordinates:f})}}),vt.include({toMultiPoint:function(r){var a=[];return this.eachLayer(function(u){a.push(u.toGeoJSON(r).geometry.coordinates)}),vs(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(r){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(r);var u=a==="GeometryCollection",f=[];return this.eachLayer(function(g){if(g.toGeoJSON){var y=g.toGeoJSON(r);if(u)f.push(y.geometry);else{var D=Yc(y);D.type==="FeatureCollection"?f.push.apply(f,D.features):f.push(D)}}}),u?vs(this,{geometries:f,type:"GeometryCollection"}):{type:"FeatureCollection",features:f}}});function m_(r,a){return new Zi(r,a)}var SC=m_,Xc=Le.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,a,u){this._url=r,this._bounds=Ie(a),A(this,u)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ae(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ht(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&yi(this._image),this},bringToBack:function(){return this._map&&wi(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=Ie(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",a=this._image=r?this._url:Ue("img");if(Ae(a,"leaflet-image-layer"),this._zoomAnimated&&Ae(a,"leaflet-zoom-animated"),this.options.className&&Ae(a,this.options.className),a.onselectstart=m,a.onmousemove=m,a.onload=o(this.fire,this,"load"),a.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(r){var a=this._map.getZoomScale(r.zoom),u=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Zt(this._image,u,a)},_reset:function(){var r=this._image,a=new ce(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),u=a.getSize();gt(r,a.min),r.style.width=u.x+"px",r.style.height=u.y+"px"},_updateOpacity:function(){an(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),TC=function(r,a,u){return new Xc(r,a,u)},g_=Xc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",a=this._image=r?this._url:Ue("video");if(Ae(a,"leaflet-image-layer"),this._zoomAnimated&&Ae(a,"leaflet-zoom-animated"),this.options.className&&Ae(a,this.options.className),a.onselectstart=m,a.onmousemove=m,a.onloadeddata=o(this.fire,this,"load"),r){for(var u=a.getElementsByTagName("source"),f=[],g=0;g<u.length;g++)f.push(u[g].src);this._url=u.length>0?f:[a.src];return}ee(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted,a.playsInline=!!this.options.playsInline;for(var y=0;y<this._url.length;y++){var D=Ue("source");D.src=this._url[y],a.appendChild(D)}}});function PC(r,a,u){return new g_(r,a,u)}var __=Xc.extend({_initImage:function(){var r=this._image=this._url;Ae(r,"leaflet-image-layer"),this._zoomAnimated&&Ae(r,"leaflet-zoom-animated"),this.options.className&&Ae(r,this.options.className),r.onselectstart=m,r.onmousemove=m}});function DC(r,a,u){return new __(r,a,u)}var Si=Le.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,a){r&&(r instanceof ge||ee(r))?(this._latlng=de(r),A(this,a)):(A(this,r),this._source=a),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&an(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&an(this._container,1),this.bringToFront(),this.options.interactive&&(Ae(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(an(this._container,0),this._removeTimeout=setTimeout(o(ht,void 0,this._container),200)):ht(this._container),this.options.interactive&&(bt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=de(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&yi(this._container),this},bringToBack:function(){return this._map&&wi(this._container),this},_prepareOpen:function(r){var a=this._source;if(!a._map)return!1;if(a instanceof dt){a=null;var u=this._source._layers;for(var f in u)if(u[f]._map){a=u[f];break}if(!a)return!1;this._source=a}if(!r)if(a.getCenter)r=a.getCenter();else if(a.getLatLng)r=a.getLatLng();else if(a.getBounds)r=a.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")r.innerHTML=a;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),a=W(this.options.offset),u=this._getAnchor();this._zoomAnimated?gt(this._container,r.add(u)):a=a.add(r).add(u);var f=this._containerBottom=-a.y,g=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=f+"px",this._container.style.left=g+"px"}},_getAnchor:function(){return[0,0]}});Be.include({_initOverlay:function(r,a,u,f){var g=a;return g instanceof r||(g=new r(f).setContent(a)),u&&g.setLatLng(u),g}}),Le.include({_initOverlay:function(r,a,u,f){var g=u;return g instanceof r?(A(g,f),g._source=this):(g=a&&!f?a:new r(f,this),g.setContent(u)),g}});var Jc=Si.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,Si.prototype.openOn.call(this,r)},onAdd:function(r){Si.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ir||this._source.on("preclick",Yt))},onRemove:function(r){Si.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ir||this._source.off("preclick",Yt))},getEvents:function(){var r=Si.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",a=this._container=Ue("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),u=this._wrapper=Ue("div",r+"-content-wrapper",a);if(this._contentNode=Ue("div",r+"-content",u),lo(a),ka(this._contentNode),Se(a,"contextmenu",Yt),this._tipContainer=Ue("div",r+"-tip-container",a),this._tip=Ue("div",r+"-tip",this._tipContainer),this.options.closeButton){var f=this._closeButton=Ue("a",r+"-close-button",a);f.setAttribute("role","button"),f.setAttribute("aria-label","Close popup"),f.href="#close",f.innerHTML='<span aria-hidden="true">&#215;</span>',Se(f,"click",function(g){Et(g),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,a=r.style;a.width="",a.whiteSpace="nowrap";var u=r.offsetWidth;u=Math.min(u,this.options.maxWidth),u=Math.max(u,this.options.minWidth),a.width=u+1+"px",a.whiteSpace="",a.height="";var f=r.offsetHeight,g=this.options.maxHeight,y="leaflet-popup-scrolled";g&&f>g?(a.height=g+"px",Ae(r,y)):bt(r,y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),u=this._getAnchor();gt(this._container,a.add(u))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,a=parseInt(ro(this._container,"marginBottom"),10)||0,u=this._container.offsetHeight+a,f=this._containerWidth,g=new H(this._containerLeft,-u-this._containerBottom);g._add(Gn(this._container));var y=r.layerPointToContainerPoint(g),D=W(this.options.autoPanPadding),V=W(this.options.autoPanPaddingTopLeft||D),B=W(this.options.autoPanPaddingBottomRight||D),K=r.getSize(),re=0,we=0;y.x+f+B.x>K.x&&(re=y.x+f-K.x+B.x),y.x-re-V.x<0&&(re=y.x-V.x),y.y+u+B.y>K.y&&(we=y.y+u-K.y+B.y),y.y-we-V.y<0&&(we=y.y-V.y),(re||we)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([re,we]))}},_getAnchor:function(){return W(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),IC=function(r,a){return new Jc(r,a)};Be.mergeOptions({closePopupOnClick:!0}),Be.include({openPopup:function(r,a,u){return this._initOverlay(Jc,r,a,u).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),Le.include({bindPopup:function(r,a){return this._popup=this._initOverlay(Jc,this._popup,r,a),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof dt||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){Hn(r);var a=r.layer||r.target;if(this._popup._source===a&&!(a instanceof Ir)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=a,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var eu=Si.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){Si.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){Si.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=Si.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",a=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ue("div",a),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var a,u,f=this._map,g=this._container,y=f.latLngToContainerPoint(f.getCenter()),D=f.layerPointToContainerPoint(r),V=this.options.direction,B=g.offsetWidth,K=g.offsetHeight,re=W(this.options.offset),we=this._getAnchor();V==="top"?(a=B/2,u=K):V==="bottom"?(a=B/2,u=0):V==="center"?(a=B/2,u=K/2):V==="right"?(a=0,u=K/2):V==="left"?(a=B,u=K/2):D.x<y.x?(V="right",a=0,u=K/2):(V="left",a=B+(re.x+we.x)*2,u=K/2),r=r.subtract(W(a,u,!0)).add(re).add(we),bt(g,"leaflet-tooltip-right"),bt(g,"leaflet-tooltip-left"),bt(g,"leaflet-tooltip-top"),bt(g,"leaflet-tooltip-bottom"),Ae(g,"leaflet-tooltip-"+V),gt(g,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&an(this._container,r)},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(a)},_getAnchor:function(){return W(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),AC=function(r,a){return new eu(r,a)};Be.include({openTooltip:function(r,a,u){return this._initOverlay(eu,r,a,u).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),Le.include({bindTooltip:function(r,a){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(eu,this._tooltip,r,a),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var a=r?"off":"on",u={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?u.add=this._openTooltip:(u.mouseover=this._openTooltip,u.mouseout=this.closeTooltip,u.click=this._openTooltip,this._map?this._addFocusListeners():u.add=this._addFocusListeners),this._tooltip.options.sticky&&(u.mousemove=this._moveTooltip),this[a](u),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof dt||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var a=typeof r.getElement=="function"&&r.getElement();a&&(Se(a,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Se(a,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var a=typeof r.getElement=="function"&&r.getElement();a&&a.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var a=this;this._map.once("moveend",function(){a._openOnceFlag=!1,a._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var a=r.latlng,u,f;this._tooltip.options.sticky&&r.originalEvent&&(u=this._map.mouseEventToContainerPoint(r.originalEvent),f=this._map.containerPointToLayerPoint(u),a=this._map.layerPointToLatLng(f)),this._tooltip.setLatLng(a)}});var v_=Tn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var a=r&&r.tagName==="DIV"?r:document.createElement("div"),u=this.options;if(u.html instanceof Element?(oo(a),a.appendChild(u.html)):a.innerHTML=u.html!==!1?u.html:"",u.bgPos){var f=W(u.bgPos);a.style.backgroundPosition=-f.x+"px "+-f.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function xC(r){return new v_(r)}Tn.Default=Ei;var ja=Le.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ae.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){A(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),ht(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(yi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(wi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof H?r:new H(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var a=this.getPane().children,u=-r(-1/0,1/0),f=0,g=a.length,y;f<g;f++)y=a[f].style.zIndex,a[f]!==this._container&&y&&(u=r(u,+y));isFinite(u)&&(this.options.zIndex=u+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ae.ielt9){an(this._container,this.options.opacity);var r=+new Date,a=!1,u=!1;for(var f in this._tiles){var g=this._tiles[f];if(!(!g.current||!g.loaded)){var y=Math.min(1,(r-g.loaded)/200);an(g.el,y),y<1?a=!0:(g.active?u=!0:this._onOpaqueTile(g),g.active=!0)}}u&&!this._noPrune&&this._pruneTiles(),a&&(x(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Ue("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,a=this.options.maxZoom;if(r!==void 0){for(var u in this._levels)u=Number(u),this._levels[u].el.children.length||u===r?(this._levels[u].el.style.zIndex=a-Math.abs(r-u),this._onUpdateLevel(u)):(ht(this._levels[u].el),this._removeTilesAtZoom(u),this._onRemoveLevel(u),delete this._levels[u]);var f=this._levels[r],g=this._map;return f||(f=this._levels[r]={},f.el=Ue("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=a,f.origin=g.project(g.unproject(g.getPixelOrigin()),r).round(),f.zoom=r,this._setZoomTransform(f,g.getCenter(),g.getZoom()),m(f.el.offsetWidth),this._onCreateLevel(f)),this._level=f,f}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var r,a,u=this._map.getZoom();if(u>this.options.maxZoom||u<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)a=this._tiles[r],a.retain=a.current;for(r in this._tiles)if(a=this._tiles[r],a.current&&!a.active){var f=a.coords;this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var a in this._tiles)this._tiles[a].coords.z===r&&this._removeTile(a)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)ht(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,a,u,f){var g=Math.floor(r/2),y=Math.floor(a/2),D=u-1,V=new H(+g,+y);V.z=+D;var B=this._tileCoordsToKey(V),K=this._tiles[B];return K&&K.active?(K.retain=!0,!0):(K&&K.loaded&&(K.retain=!0),D>f?this._retainParent(g,y,D,f):!1)},_retainChildren:function(r,a,u,f){for(var g=2*r;g<2*r+2;g++)for(var y=2*a;y<2*a+2;y++){var D=new H(g,y);D.z=u+1;var V=this._tileCoordsToKey(D),B=this._tiles[V];if(B&&B.active){B.retain=!0;continue}else B&&B.loaded&&(B.retain=!0);u+1<f&&this._retainChildren(g,y,u+1,f)}},_resetView:function(r){var a=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var a=this.options;return a.minNativeZoom!==void 0&&r<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<r?a.maxNativeZoom:r},_setView:function(r,a,u,f){var g=Math.round(a);this.options.maxZoom!==void 0&&g>this.options.maxZoom||this.options.minZoom!==void 0&&g<this.options.minZoom?g=void 0:g=this._clampZoom(g);var y=this.options.updateWhenZooming&&g!==this._tileZoom;(!f||y)&&(this._tileZoom=g,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),g!==void 0&&this._update(r),u||this._pruneTiles(),this._noPrune=!!u),this._setZoomTransforms(r,a)},_setZoomTransforms:function(r,a){for(var u in this._levels)this._setZoomTransform(this._levels[u],r,a)},_setZoomTransform:function(r,a,u){var f=this._map.getZoomScale(u,r.zoom),g=r.origin.multiplyBy(f).subtract(this._map._getNewPixelOrigin(a,u)).round();ae.any3d?Zt(r.el,g,f):gt(r.el,g)},_resetGrid:function(){var r=this._map,a=r.options.crs,u=this._tileSize=this.getTileSize(),f=this._tileZoom,g=this._map.getPixelWorldBounds(this._tileZoom);g&&(this._globalTileRange=this._pxBoundsToTileRange(g)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,a.wrapLng[0]],f).x/u.x),Math.ceil(r.project([0,a.wrapLng[1]],f).x/u.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([a.wrapLat[0],0],f).y/u.x),Math.ceil(r.project([a.wrapLat[1],0],f).y/u.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var a=this._map,u=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),f=a.getZoomScale(u,this._tileZoom),g=a.project(r,this._tileZoom).floor(),y=a.getSize().divideBy(f*2);return new ce(g.subtract(y),g.add(y))},_update:function(r){var a=this._map;if(a){var u=this._clampZoom(a.getZoom());if(r===void 0&&(r=a.getCenter()),this._tileZoom!==void 0){var f=this._getTiledPixelBounds(r),g=this._pxBoundsToTileRange(f),y=g.getCenter(),D=[],V=this.options.keepBuffer,B=new ce(g.getBottomLeft().subtract([V,-V]),g.getTopRight().add([V,-V]));if(!(isFinite(g.min.x)&&isFinite(g.min.y)&&isFinite(g.max.x)&&isFinite(g.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var K in this._tiles){var re=this._tiles[K].coords;(re.z!==this._tileZoom||!B.contains(new H(re.x,re.y)))&&(this._tiles[K].current=!1)}if(Math.abs(u-this._tileZoom)>1){this._setView(r,u);return}for(var we=g.min.y;we<=g.max.y;we++)for(var Fe=g.min.x;Fe<=g.max.x;Fe++){var cn=new H(Fe,we);if(cn.z=this._tileZoom,!!this._isValidTile(cn)){var Ut=this._tiles[this._tileCoordsToKey(cn)];Ut?Ut.current=!0:D.push(cn)}}if(D.sort(function(gn,ws){return gn.distanceTo(y)-ws.distanceTo(y)}),D.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Kn=document.createDocumentFragment();for(Fe=0;Fe<D.length;Fe++)this._addTile(D[Fe],Kn);this._level.el.appendChild(Kn)}}}},_isValidTile:function(r){var a=this._map.options.crs;if(!a.infinite){var u=this._globalTileRange;if(!a.wrapLng&&(r.x<u.min.x||r.x>u.max.x)||!a.wrapLat&&(r.y<u.min.y||r.y>u.max.y))return!1}if(!this.options.bounds)return!0;var f=this._tileCoordsToBounds(r);return Ie(this.options.bounds).overlaps(f)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var a=this._map,u=this.getTileSize(),f=r.scaleBy(u),g=f.add(u),y=a.unproject(f,r.z),D=a.unproject(g,r.z);return[y,D]},_tileCoordsToBounds:function(r){var a=this._tileCoordsToNwSe(r),u=new at(a[0],a[1]);return this.options.noWrap||(u=this._map.wrapLatLngBounds(u)),u},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var a=r.split(":"),u=new H(+a[0],+a[1]);return u.z=+a[2],u},_removeTile:function(r){var a=this._tiles[r];a&&(ht(a.el),delete this._tiles[r],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Ae(r,"leaflet-tile");var a=this.getTileSize();r.style.width=a.x+"px",r.style.height=a.y+"px",r.onselectstart=m,r.onmousemove=m,ae.ielt9&&this.options.opacity<1&&an(r,this.options.opacity)},_addTile:function(r,a){var u=this._getTilePos(r),f=this._tileCoordsToKey(r),g=this.createTile(this._wrapCoords(r),o(this._tileReady,this,r));this._initTile(g),this.createTile.length<2&&T(o(this._tileReady,this,r,null,g)),gt(g,u),this._tiles[f]={el:g,coords:r,current:!0},a.appendChild(g),this.fire("tileloadstart",{tile:g,coords:r})},_tileReady:function(r,a,u){a&&this.fire("tileerror",{error:a,tile:u,coords:r});var f=this._tileCoordsToKey(r);u=this._tiles[f],u&&(u.loaded=+new Date,this._map._fadeAnimated?(an(u.el,0),x(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this)):(u.active=!0,this._pruneTiles()),a||(Ae(u.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:u.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ae.ielt9||!this._map._fadeAnimated?T(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var a=new H(this._wrapX?d(r.x,this._wrapX):r.x,this._wrapY?d(r.y,this._wrapY):r.y);return a.z=r.z,a},_pxBoundsToTileRange:function(r){var a=this.getTileSize();return new ce(r.min.unscaleBy(a).floor(),r.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function MC(r){return new ja(r)}var ys=ja.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,a){this._url=r,a=A(this,a),a.detectRetina&&ae.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom=Math.min(a.maxZoom,a.minZoom+1)):(a.zoomOffset++,a.maxZoom=Math.max(a.minZoom,a.maxZoom-1)),a.minZoom=Math.max(0,a.minZoom)):a.zoomReverse?a.minZoom=Math.min(a.maxZoom,a.minZoom):a.maxZoom=Math.max(a.minZoom,a.maxZoom),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,a){return this._url===r&&a===void 0&&(a=!0),this._url=r,a||this.redraw(),this},createTile:function(r,a){var u=document.createElement("img");return Se(u,"load",o(this._tileOnLoad,this,a,u)),Se(u,"error",o(this._tileOnError,this,a,u)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(u.referrerPolicy=this.options.referrerPolicy),u.alt="",u.src=this.getTileUrl(r),u},getTileUrl:function(r){var a={r:ae.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var u=this._globalTileRange.max.y-r.y;this.options.tms&&(a.y=u),a["-y"]=u}return $(this._url,t(a,this.options))},_tileOnLoad:function(r,a){ae.ielt9?setTimeout(o(r,this,null,a),0):r(null,a)},_tileOnError:function(r,a,u){var f=this.options.errorTileUrl;f&&a.getAttribute("src")!==f&&(a.src=f),r(u,a)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,a=this.options.maxZoom,u=this.options.zoomReverse,f=this.options.zoomOffset;return u&&(r=a-r),r+f},_getSubdomain:function(r){var a=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var r,a;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(a=this._tiles[r].el,a.onload=m,a.onerror=m,!a.complete)){a.src=me;var u=this._tiles[r].coords;ht(a),delete this._tiles[r],this.fire("tileabort",{tile:a,coords:u})}},_removeTile:function(r){var a=this._tiles[r];if(a)return a.el.setAttribute("src",me),ja.prototype._removeTile.call(this,r)},_tileReady:function(r,a,u){if(!(!this._map||u&&u.getAttribute("src")===me))return ja.prototype._tileReady.call(this,r,a,u)}});function y_(r,a){return new ys(r,a)}var w_=ys.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,a){this._url=r;var u=t({},this.defaultWmsParams);for(var f in a)f in this.options||(u[f]=a[f]);a=A(this,a);var g=a.detectRetina&&ae.retina?2:1,y=this.getTileSize();u.width=y.x*g,u.height=y.y*g,this.wmsParams=u},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,ys.prototype.onAdd.call(this,r)},getTileUrl:function(r){var a=this._tileCoordsToNwSe(r),u=this._crs,f=Ne(u.project(a[0]),u.project(a[1])),g=f.min,y=f.max,D=(this._wmsVersion>=1.3&&this._crs===z?[g.y,g.x,y.y,y.x]:[g.x,g.y,y.x,y.y]).join(","),V=ys.prototype.getTileUrl.call(this,r);return V+F(this.wmsParams,V,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+D},setParams:function(r,a){return t(this.wmsParams,r),a||this.redraw(),this}});function RC(r,a){return new w_(r,a)}ys.WMS=w_,y_.wms=RC;var Qi=Le.extend({options:{padding:.1},initialize:function(r){A(this,r),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ae(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,a){var u=this._map.getZoomScale(a,this._zoom),f=this._map.getSize().multiplyBy(.5+this.options.padding),g=this._map.project(this._center,a),y=f.multiplyBy(-u).add(g).subtract(this._map._getNewPixelOrigin(r,a));ae.any3d?Zt(this._container,y,u):gt(this._container,y)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,a=this._map.getSize(),u=this._map.containerPointToLayerPoint(a.multiplyBy(-r)).round();this._bounds=new ce(u,u.add(a.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),C_=Qi.extend({options:{tolerance:0},getEvents:function(){var r=Qi.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Qi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Se(r,"mousemove",this._onMouseMove,this),Se(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Se(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){x(this._redrawRequest),delete this._ctx,ht(this._container),ot(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var a in this._layers)r=this._layers[a],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Qi.prototype._update.call(this);var r=this._bounds,a=this._container,u=r.getSize(),f=ae.retina?2:1;gt(a,r.min),a.width=f*u.x,a.height=f*u.y,a.style.width=u.x+"px",a.style.height=u.y+"px",ae.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){Qi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[l(r)]=r;var a=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var a=r._order,u=a.next,f=a.prev;u?u.prev=f:this._drawLast=f,f?f.next=u:this._drawFirst=u,delete r._order,delete this._layers[l(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var a=r.options.dashArray.split(/[, ]+/),u=[],f,g;for(g=0;g<a.length;g++){if(f=Number(a[g]),isNaN(f))return;u.push(f)}r.options._dashArray=u}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||T(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var a=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ce,this._redrawBounds.extend(r._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(r._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var a=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,a=this._redrawBounds;if(this._ctx.save(),a){var u=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,u.x,u.y),this._ctx.clip()}this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)r=f.layer,(!a||r._pxBounds&&r._pxBounds.intersects(a))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,a){if(this._drawing){var u,f,g,y,D=r._parts,V=D.length,B=this._ctx;if(V){for(B.beginPath(),u=0;u<V;u++){for(f=0,g=D[u].length;f<g;f++)y=D[u][f],B[f?"lineTo":"moveTo"](y.x,y.y);a&&B.closePath()}this._fillStroke(B,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var a=r._point,u=this._ctx,f=Math.max(Math.round(r._radius),1),g=(Math.max(Math.round(r._radiusY),1)||f)/f;g!==1&&(u.save(),u.scale(1,g)),u.beginPath(),u.arc(a.x,a.y/g,f,0,Math.PI*2,!1),g!==1&&u.restore(),this._fillStroke(u,r)}},_fillStroke:function(r,a){var u=a.options;u.fill&&(r.globalAlpha=u.fillOpacity,r.fillStyle=u.fillColor||u.color,r.fill(u.fillRule||"evenodd")),u.stroke&&u.weight!==0&&(r.setLineDash&&r.setLineDash(a.options&&a.options._dashArray||[]),r.globalAlpha=u.opacity,r.lineWidth=u.weight,r.strokeStyle=u.color,r.lineCap=u.lineCap,r.lineJoin=u.lineJoin,r.stroke())},_onClick:function(r){for(var a=this._map.mouseEventToLayerPoint(r),u,f,g=this._drawFirst;g;g=g.next)u=g.layer,u.options.interactive&&u._containsPoint(a)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(u))&&(f=u);this._fireEvent(f?[f]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,a)}},_handleMouseOut:function(r){var a=this._hoveredLayer;a&&(bt(this._container,"leaflet-interactive"),this._fireEvent([a],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,a){if(!this._mouseHoverThrottled){for(var u,f,g=this._drawFirst;g;g=g.next)u=g.layer,u.options.interactive&&u._containsPoint(a)&&(f=u);f!==this._hoveredLayer&&(this._handleMouseOut(r),f&&(Ae(this._container,"leaflet-interactive"),this._fireEvent([f],r,"mouseover"),this._hoveredLayer=f)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,a,u){this._map._fireDOMEvent(a,u||a.type,r)},_bringToFront:function(r){var a=r._order;if(a){var u=a.next,f=a.prev;if(u)u.prev=f;else return;f?f.next=u:u&&(this._drawFirst=u),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(r)}},_bringToBack:function(r){var a=r._order;if(a){var u=a.next,f=a.prev;if(f)f.next=u;else return;u?u.prev=f:f&&(this._drawLast=f),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(r)}}});function b_(r){return ae.canvas?new C_(r):null}var $a=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),kC={_initContainer:function(){this._container=Ue("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Qi.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var a=r._container=$a("shape");Ae(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",r._path=$a("path"),a.appendChild(r._path),this._updateStyle(r),this._layers[l(r)]=r},_addPath:function(r){var a=r._container;this._container.appendChild(a),r.options.interactive&&r.addInteractiveTarget(a)},_removePath:function(r){var a=r._container;ht(a),r.removeInteractiveTarget(a),delete this._layers[l(r)]},_updateStyle:function(r){var a=r._stroke,u=r._fill,f=r.options,g=r._container;g.stroked=!!f.stroke,g.filled=!!f.fill,f.stroke?(a||(a=r._stroke=$a("stroke")),g.appendChild(a),a.weight=f.weight+"px",a.color=f.color,a.opacity=f.opacity,f.dashArray?a.dashStyle=ee(f.dashArray)?f.dashArray.join(" "):f.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=f.lineCap.replace("butt","flat"),a.joinstyle=f.lineJoin):a&&(g.removeChild(a),r._stroke=null),f.fill?(u||(u=r._fill=$a("fill")),g.appendChild(u),u.color=f.fillColor||f.color,u.opacity=f.fillOpacity):u&&(g.removeChild(u),r._fill=null)},_updateCircle:function(r){var a=r._point.round(),u=Math.round(r._radius),f=Math.round(r._radiusY||u);this._setPath(r,r._empty()?"M0 0":"AL "+a.x+","+a.y+" "+u+","+f+" 0,"+65535*360)},_setPath:function(r,a){r._path.v=a},_bringToFront:function(r){yi(r._container)},_bringToBack:function(r){wi(r._container)}},tu=ae.vml?$a:Yo,qa=Qi.extend({_initContainer:function(){this._container=tu("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=tu("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ht(this._container),ot(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Qi.prototype._update.call(this);var r=this._bounds,a=r.getSize(),u=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,u.setAttribute("width",a.x),u.setAttribute("height",a.y)),gt(u,r.min),u.setAttribute("viewBox",[r.min.x,r.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(r){var a=r._path=tu("path");r.options.className&&Ae(a,r.options.className),r.options.interactive&&Ae(a,"leaflet-interactive"),this._updateStyle(r),this._layers[l(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){ht(r._path),r.removeInteractiveTarget(r._path),delete this._layers[l(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var a=r._path,u=r.options;a&&(u.stroke?(a.setAttribute("stroke",u.color),a.setAttribute("stroke-opacity",u.opacity),a.setAttribute("stroke-width",u.weight),a.setAttribute("stroke-linecap",u.lineCap),a.setAttribute("stroke-linejoin",u.lineJoin),u.dashArray?a.setAttribute("stroke-dasharray",u.dashArray):a.removeAttribute("stroke-dasharray"),u.dashOffset?a.setAttribute("stroke-dashoffset",u.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),u.fill?(a.setAttribute("fill",u.fillColor||u.color),a.setAttribute("fill-opacity",u.fillOpacity),a.setAttribute("fill-rule",u.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(r,a){this._setPath(r,Xo(r._parts,a))},_updateCircle:function(r){var a=r._point,u=Math.max(Math.round(r._radius),1),f=Math.max(Math.round(r._radiusY),1)||u,g="a"+u+","+f+" 0 1,0 ",y=r._empty()?"M0 0":"M"+(a.x-u)+","+a.y+g+u*2+",0 "+g+-u*2+",0 ";this._setPath(r,y)},_setPath:function(r,a){r._path.setAttribute("d",a)},_bringToFront:function(r){yi(r._path)},_bringToBack:function(r){wi(r._path)}});ae.vml&&qa.include(kC);function E_(r){return ae.svg||ae.vml?new qa(r):null}Be.include({getRenderer:function(r){var a=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var a=this._paneRenderers[r];return a===void 0&&(a=this._createRenderer({pane:r}),this._paneRenderers[r]=a),a},_createRenderer:function(r){return this.options.preferCanvas&&b_(r)||E_(r)}});var S_=_s.extend({initialize:function(r,a){_s.prototype.initialize.call(this,this._boundsToLatLngs(r),a)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=Ie(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function OC(r,a){return new S_(r,a)}qa.create=tu,qa.pointsToPath=Xo,Zi.geometryToLayer=Wc,Zi.coordsToLatLng=xd,Zi.coordsToLatLngs=Zc,Zi.latLngToCoords=Md,Zi.latLngsToCoords=Qc,Zi.getFeature=vs,Zi.asFeature=Yc,Be.mergeOptions({boxZoom:!0});var T_=Sn.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Se(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ot(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ht(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Er(),$i(),this._startPoint=this._map.mouseEventToContainerPoint(r),Se(document,{contextmenu:Hn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Ue("div","leaflet-zoom-box",this._container),Ae(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var a=new ce(this._point,this._startPoint),u=a.getSize();gt(this._box,a.min),this._box.style.width=u.x+"px",this._box.style.height=u.y+"px"},_finish:function(){this._moved&&(ht(this._box),bt(this._container,"leaflet-crosshair")),Qe(),Da(),ot(document,{contextmenu:Hn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var a=new at(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Be.addInitHook("addHandler","boxZoom",T_),Be.mergeOptions({doubleClickZoom:!0});var P_=Sn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var a=this._map,u=a.getZoom(),f=a.options.zoomDelta,g=r.originalEvent.shiftKey?u-f:u+f;a.options.doubleClickZoom==="center"?a.setZoom(g):a.setZoomAround(r.containerPoint,g)}});Be.addInitHook("addHandler","doubleClickZoom",P_),Be.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var D_=Sn.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new li(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}Ae(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){bt(this._map._container,"leaflet-grab"),bt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=Ie(this._map.options.maxBounds);this._offsetLimit=Ne(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var a=this._lastTime=+new Date,u=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(u),this._times.push(a),this._prunePositions(a)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,a){return r-(r-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;r.x<a.min.x&&(r.x=this._viscousLimit(r.x,a.min.x)),r.y<a.min.y&&(r.y=this._viscousLimit(r.y,a.min.y)),r.x>a.max.x&&(r.x=this._viscousLimit(r.x,a.max.x)),r.y>a.max.y&&(r.y=this._viscousLimit(r.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,a=Math.round(r/2),u=this._initialWorldOffset,f=this._draggable._newPos.x,g=(f-a+u)%r+a-u,y=(f+a+u)%r-a-u,D=Math.abs(g+u)<Math.abs(y+u)?g:y;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=D},_onDragEnd:function(r){var a=this._map,u=a.options,f=!u.inertia||r.noInertia||this._times.length<2;if(a.fire("dragend",r),f)a.fire("moveend");else{this._prunePositions(+new Date);var g=this._lastPos.subtract(this._positions[0]),y=(this._lastTime-this._times[0])/1e3,D=u.easeLinearity,V=g.multiplyBy(D/y),B=V.distanceTo([0,0]),K=Math.min(u.inertiaMaxSpeed,B),re=V.multiplyBy(K/B),we=K/(u.inertiaDeceleration*D),Fe=re.multiplyBy(-we/2).round();!Fe.x&&!Fe.y?a.fire("moveend"):(Fe=a._limitOffset(Fe,a.options.maxBounds),T(function(){a.panBy(Fe,{duration:we,easeLinearity:D,noMoveStart:!0,animate:!0})}))}}});Be.addInitHook("addHandler","dragging",D_),Be.mergeOptions({keyboard:!0,keyboardPanDelta:80});var I_=Sn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Se(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ot(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,a=document.documentElement,u=r.scrollTop||a.scrollTop,f=r.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(f,u)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var a=this._panKeys={},u=this.keyCodes,f,g;for(f=0,g=u.left.length;f<g;f++)a[u.left[f]]=[-1*r,0];for(f=0,g=u.right.length;f<g;f++)a[u.right[f]]=[r,0];for(f=0,g=u.down.length;f<g;f++)a[u.down[f]]=[0,r];for(f=0,g=u.up.length;f<g;f++)a[u.up[f]]=[0,-1*r]},_setZoomDelta:function(r){var a=this._zoomKeys={},u=this.keyCodes,f,g;for(f=0,g=u.zoomIn.length;f<g;f++)a[u.zoomIn[f]]=r;for(f=0,g=u.zoomOut.length;f<g;f++)a[u.zoomOut[f]]=-r},_addHooks:function(){Se(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ot(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var a=r.keyCode,u=this._map,f;if(a in this._panKeys){if(!u._panAnim||!u._panAnim._inProgress)if(f=this._panKeys[a],r.shiftKey&&(f=W(f).multiplyBy(3)),u.options.maxBounds&&(f=u._limitOffset(W(f),u.options.maxBounds)),u.options.worldCopyJump){var g=u.wrapLatLng(u.unproject(u.project(u.getCenter()).add(f)));u.panTo(g)}else u.panBy(f)}else if(a in this._zoomKeys)u.setZoom(u.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&u._popup&&u._popup.options.closeOnEscapeKey)u.closePopup();else return;Hn(r)}}});Be.addInitHook("addHandler","keyboard",I_),Be.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var A_=Sn.extend({addHooks:function(){Se(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ot(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var a=La(r),u=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var f=Math.max(u-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),f),Hn(r)},_performZoom:function(){var r=this._map,a=r.getZoom(),u=this._map.options.zoomSnap||0;r._stop();var f=this._delta/(this._map.options.wheelPxPerZoomLevel*4),g=4*Math.log(2/(1+Math.exp(-Math.abs(f))))/Math.LN2,y=u?Math.ceil(g/u)*u:g,D=r._limitZoom(a+(this._delta>0?y:-y))-a;this._delta=0,this._startTime=null,D&&(r.options.scrollWheelZoom==="center"?r.setZoom(a+D):r.setZoomAround(this._lastMousePos,a+D))}});Be.addInitHook("addHandler","scrollWheelZoom",A_);var LC=600;Be.mergeOptions({tapHold:ae.touchNative&&ae.safari&&ae.mobile,tapTolerance:15});var x_=Sn.extend({addHooks:function(){Se(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ot(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var a=r.touches[0];this._startPos=this._newPos=new H(a.clientX,a.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Se(document,"touchend",Et),Se(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",a))},this),LC),Se(document,"touchend touchcancel contextmenu",this._cancel,this),Se(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){ot(document,"touchend",Et),ot(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),ot(document,"touchend touchcancel contextmenu",this._cancel,this),ot(document,"touchmove",this._onMove,this)},_onMove:function(r){var a=r.touches[0];this._newPos=new H(a.clientX,a.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,a){var u=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY});u._simulated=!0,a.target.dispatchEvent(u)}});Be.addInitHook("addHandler","tapHold",x_),Be.mergeOptions({touchZoom:ae.touch,bounceAtZoomLimits:!0});var M_=Sn.extend({addHooks:function(){Ae(this._map._container,"leaflet-touch-zoom"),Se(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){bt(this._map._container,"leaflet-touch-zoom"),ot(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var a=this._map;if(!(!r.touches||r.touches.length!==2||a._animatingZoom||this._zooming)){var u=a.mouseEventToContainerPoint(r.touches[0]),f=a.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(u.add(f)._divideBy(2))),this._startDist=u.distanceTo(f),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Se(document,"touchmove",this._onTouchMove,this),Se(document,"touchend touchcancel",this._onTouchEnd,this),Et(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var a=this._map,u=a.mouseEventToContainerPoint(r.touches[0]),f=a.mouseEventToContainerPoint(r.touches[1]),g=u.distanceTo(f)/this._startDist;if(this._zoom=a.getScaleZoom(g,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&g<1||this._zoom>a.getMaxZoom()&&g>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,g===1)return}else{var y=u._add(f)._divideBy(2)._subtract(this._centerPoint);if(g===1&&y.x===0&&y.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(y),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),x(this._animRequest);var D=o(a._move,a,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=T(D,this,!0),Et(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,x(this._animRequest),ot(document,"touchmove",this._onTouchMove,this),ot(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Be.addInitHook("addHandler","touchZoom",M_),Be.BoxZoom=T_,Be.DoubleClickZoom=P_,Be.Drag=D_,Be.Keyboard=I_,Be.ScrollWheelZoom=A_,Be.TapHold=x_,Be.TouchZoom=M_,n.Bounds=ce,n.Browser=ae,n.CRS=Ft,n.Canvas=C_,n.Circle=Ad,n.CircleMarker=Kc,n.Class=k,n.Control=mn,n.DivIcon=v_,n.DivOverlay=Si,n.DomEvent=_t,n.DomUtil=Ci,n.Draggable=li,n.Evented=pn,n.FeatureGroup=dt,n.GeoJSON=Zi,n.GridLayer=ja,n.Handler=Sn,n.Icon=Tn,n.ImageOverlay=Xc,n.LatLng=ge,n.LatLngBounds=at,n.Layer=Le,n.LayerGroup=vt,n.LineUtil=c,n.Map=Be,n.Marker=Hc,n.Mixin=us,n.Path=Ir,n.Point=H,n.PolyUtil=Va,n.Polygon=_s,n.Polyline=Wi,n.Popup=Jc,n.PosAnimation=Nc,n.Projection=C,n.Rectangle=S_,n.Renderer=Qi,n.SVG=qa,n.SVGOverlay=__,n.TileLayer=ys,n.Tooltip=eu,n.Transformation=Vt,n.Util=R,n.VideoOverlay=g_,n.bind=o,n.bounds=Ne,n.canvas=b_,n.circle=CC,n.circleMarker=wC,n.control=Pr,n.divIcon=xC,n.extend=t,n.featureGroup=zt,n.geoJSON=m_,n.geoJson=SC,n.gridLayer=MC,n.icon=Pn,n.imageOverlay=TC,n.latLng=de,n.latLngBounds=Ie,n.layerGroup=je,n.map=Bc,n.marker=yC,n.point=W,n.polygon=EC,n.polyline=bC,n.popup=IC,n.rectangle=OC,n.setOptions=A,n.stamp=l,n.svg=E_,n.svgOverlay=DC,n.tileLayer=y_,n.tooltip=AC,n.transformation=sn,n.version=e,n.videoOverlay=PC;var FC=window.L;n.noConflict=function(){return window.L=FC,this},window.L=n})});var q0=null;function ar(){return q0}function G0(n){q0??=n}var wu=class{};var Jt=new tt(""),ff=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>ue(ZC),providedIn:"platform"})}}return n})(),H0=new tt(""),ZC=(()=>{class n extends ff{constructor(){super(),this._doc=ue(Jt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ar().getBaseHref(this._doc)}onPopState(t){let i=ar().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=ar().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,o){this._history.pushState(t,i,o)}replaceState(t,i,o){this._history.replaceState(t,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function pf(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function N0(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,i=t-(n[t-1]==="/"?1:0);return n.slice(0,i)+n.slice(t)}function rr(n){return n&&n[0]!=="?"?"?"+n:n}var lr=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>ue(mf),providedIn:"root"})}}return n})(),K0=new tt(""),mf=(()=>{class n extends lr{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??ue(Jt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return pf(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+rr(this._platformLocation.search),o=this._platformLocation.hash;return o&&t?`${i}${o}`:i}pushState(t,i,o,s){let l=this.prepareExternalUrl(o+rr(s));this._platformLocation.pushState(t,i,l)}replaceState(t,i,o,s){let l=this.prepareExternalUrl(o+rr(s));this._platformLocation.replaceState(t,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(i){return new(i||n)(xe(ff),xe(K0,8))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),W0=(()=>{class n extends lr{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){let i=pf(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,o,s){let l=this.prepareExternalUrl(o+rr(s));l.length==0&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,i,l)}replaceState(t,i,o,s){let l=this.prepareExternalUrl(o+rr(s));l.length==0&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(i){return new(i||n)(xe(ff),xe(K0,8))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),Ps=(()=>{class n{constructor(t){this._subject=new yt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=XC(N0(B0(i))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+rr(i))}normalize(t){return n.stripTrailingSlash(YC(this._basePath,B0(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",o=null){this._locationStrategy.pushState(o,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+rr(i)),o)}replaceState(t,i="",o=null){this._locationStrategy.replaceState(o,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+rr(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(o=>o(t,i))}subscribe(t,i,o){return this._subject.subscribe({next:t,error:i,complete:o})}static{this.normalizeQueryParams=rr}static{this.joinWithSlash=pf}static{this.stripTrailingSlash=N0}static{this.\u0275fac=function(i){return new(i||n)(xe(lr))}}static{this.\u0275prov=be({token:n,factory:()=>QC(),providedIn:"root"})}}return n})();function QC(){return new Ps(xe(lr))}function YC(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function B0(n){return n.replace(/\/index.html$/,"")}function XC(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Z0=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(Z0||{});var hn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(hn||{}),lt=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(lt||{}),kn=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(kn||{}),On={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function JC(n){return An(n)[At.LocaleId]}function eb(n,e,t){let i=An(n),o=[i[At.DayPeriodsFormat],i[At.DayPeriodsStandalone]],s=Yn(o,e);return Yn(s,t)}function tb(n,e,t){let i=An(n),o=[i[At.DaysFormat],i[At.DaysStandalone]],s=Yn(o,e);return Yn(s,t)}function nb(n,e,t){let i=An(n),o=[i[At.MonthsFormat],i[At.MonthsStandalone]],s=Yn(o,e);return Yn(s,t)}function ib(n,e){let i=An(n)[At.Eras];return Yn(i,e)}function du(n,e){let t=An(n);return Yn(t[At.DateFormat],e)}function fu(n,e){let t=An(n);return Yn(t[At.TimeFormat],e)}function pu(n,e){let i=An(n)[At.DateTimeFormat];return Yn(i,e)}function or(n,e){let t=An(n),i=t[At.NumberSymbols][e];if(typeof i>"u"){if(e===On.CurrencyDecimal)return t[At.NumberSymbols][On.Decimal];if(e===On.CurrencyGroup)return t[At.NumberSymbols][On.Group]}return i}function rb(n,e){return An(n)[At.NumberFormats][e]}function Q0(n){if(!n[At.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[At.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ob(n){let e=An(n);return Q0(e),(e[At.ExtraData][2]||[]).map(i=>typeof i=="string"?nf(i):[nf(i[0]),nf(i[1])])}function sb(n,e,t){let i=An(n);Q0(i);let o=[i[At.ExtraData][0],i[At.ExtraData][1]],s=Yn(o,e)||[];return Yn(s,t)||[]}function Yn(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function nf(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var ab=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,mu={},lb=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,sr=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(sr||{}),et=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(et||{}),Je=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(Je||{});function cb(n,e,t,i){let o=vb(n);e=ir(t,e)||e;let l=[],h;for(;e;)if(h=lb.exec(e),h){l=l.concat(h.slice(1));let v=l.pop();if(!v)break;e=v}else{l.push(e);break}let d=o.getTimezoneOffset();i&&(d=X0(i,d),o=_b(o,i,!0));let m="";return l.forEach(v=>{let w=mb(v);m+=w?w(o,t,d):v==="''"?"'":v.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),m}function Cu(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function ir(n,e){let t=JC(n);if(mu[t]??={},mu[t][e])return mu[t][e];let i="";switch(e){case"shortDate":i=du(n,kn.Short);break;case"mediumDate":i=du(n,kn.Medium);break;case"longDate":i=du(n,kn.Long);break;case"fullDate":i=du(n,kn.Full);break;case"shortTime":i=fu(n,kn.Short);break;case"mediumTime":i=fu(n,kn.Medium);break;case"longTime":i=fu(n,kn.Long);break;case"fullTime":i=fu(n,kn.Full);break;case"short":let o=ir(n,"shortTime"),s=ir(n,"shortDate");i=gu(pu(n,kn.Short),[o,s]);break;case"medium":let l=ir(n,"mediumTime"),h=ir(n,"mediumDate");i=gu(pu(n,kn.Medium),[l,h]);break;case"long":let d=ir(n,"longTime"),m=ir(n,"longDate");i=gu(pu(n,kn.Long),[d,m]);break;case"full":let v=ir(n,"fullTime"),w=ir(n,"fullDate");i=gu(pu(n,kn.Full),[v,w]);break}return i&&(mu[t][e]=i),i}function gu(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function hi(n,e,t="-",i,o){let s="";(n<0||o&&n<=0)&&(o?n=-n+1:(n=-n,s=t));let l=String(n);for(;l.length<e;)l="0"+l;return i&&(l=l.slice(l.length-e)),s+l}function ub(n,e){return hi(n,3).substring(0,e)}function Mt(n,e,t=0,i=!1,o=!1){return function(s,l){let h=hb(n,s);if((t>0||h>-t)&&(h+=t),n===et.Hours)h===0&&t===-12&&(h=12);else if(n===et.FractionalSeconds)return ub(h,e);let d=or(l,On.MinusSign);return hi(h,e,d,i,o)}}function hb(n,e){switch(n){case et.FullYear:return e.getFullYear();case et.Month:return e.getMonth();case et.Date:return e.getDate();case et.Hours:return e.getHours();case et.Minutes:return e.getMinutes();case et.Seconds:return e.getSeconds();case et.FractionalSeconds:return e.getMilliseconds();case et.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function ft(n,e,t=hn.Format,i=!1){return function(o,s){return db(o,s,n,e,t,i)}}function db(n,e,t,i,o,s){switch(t){case Je.Months:return nb(e,o,i)[n.getMonth()];case Je.Days:return tb(e,o,i)[n.getDay()];case Je.DayPeriods:let l=n.getHours(),h=n.getMinutes();if(s){let m=ob(e),v=sb(e,o,i),w=m.findIndex(S=>{if(Array.isArray(S)){let[A,F]=S,j=l>=A.hours&&h>=A.minutes,$=l<F.hours||l===F.hours&&h<F.minutes;if(A.hours<F.hours){if(j&&$)return!0}else if(j||$)return!0}else if(S.hours===l&&S.minutes===h)return!0;return!1});if(w!==-1)return v[w]}return eb(e,o,i)[l<12?0:1];case Je.Eras:return ib(e,i)[n.getFullYear()<=0?0:1];default:let d=t;throw new Error(`unexpected translation type ${d}`)}}function _u(n){return function(e,t,i){let o=-1*i,s=or(t,On.MinusSign),l=o>0?Math.floor(o/60):Math.ceil(o/60);switch(n){case sr.Short:return(o>=0?"+":"")+hi(l,2,s)+hi(Math.abs(o%60),2,s);case sr.ShortGMT:return"GMT"+(o>=0?"+":"")+hi(l,1,s);case sr.Long:return"GMT"+(o>=0?"+":"")+hi(l,2,s)+":"+hi(Math.abs(o%60),2,s);case sr.Extended:return i===0?"Z":(o>=0?"+":"")+hi(l,2,s)+":"+hi(Math.abs(o%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}var fb=0,yu=4;function pb(n){let e=Cu(n,fb,1).getDay();return Cu(n,0,1+(e<=yu?yu:yu+7)-e)}function Y0(n){let e=n.getDay(),t=e===0?-3:yu-e;return Cu(n.getFullYear(),n.getMonth(),n.getDate()+t)}function rf(n,e=!1){return function(t,i){let o;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,l=t.getDate();o=1+Math.floor((l+s)/7)}else{let s=Y0(t),l=pb(s.getFullYear()),h=s.getTime()-l.getTime();o=1+Math.round(h/6048e5)}return hi(o,n,or(i,On.MinusSign))}}function vu(n,e=!1){return function(t,i){let s=Y0(t).getFullYear();return hi(s,n,or(i,On.MinusSign),e)}}var of={};function mb(n){if(of[n])return of[n];let e;switch(n){case"G":case"GG":case"GGG":e=ft(Je.Eras,lt.Abbreviated);break;case"GGGG":e=ft(Je.Eras,lt.Wide);break;case"GGGGG":e=ft(Je.Eras,lt.Narrow);break;case"y":e=Mt(et.FullYear,1,0,!1,!0);break;case"yy":e=Mt(et.FullYear,2,0,!0,!0);break;case"yyy":e=Mt(et.FullYear,3,0,!1,!0);break;case"yyyy":e=Mt(et.FullYear,4,0,!1,!0);break;case"Y":e=vu(1);break;case"YY":e=vu(2,!0);break;case"YYY":e=vu(3);break;case"YYYY":e=vu(4);break;case"M":case"L":e=Mt(et.Month,1,1);break;case"MM":case"LL":e=Mt(et.Month,2,1);break;case"MMM":e=ft(Je.Months,lt.Abbreviated);break;case"MMMM":e=ft(Je.Months,lt.Wide);break;case"MMMMM":e=ft(Je.Months,lt.Narrow);break;case"LLL":e=ft(Je.Months,lt.Abbreviated,hn.Standalone);break;case"LLLL":e=ft(Je.Months,lt.Wide,hn.Standalone);break;case"LLLLL":e=ft(Je.Months,lt.Narrow,hn.Standalone);break;case"w":e=rf(1);break;case"ww":e=rf(2);break;case"W":e=rf(1,!0);break;case"d":e=Mt(et.Date,1);break;case"dd":e=Mt(et.Date,2);break;case"c":case"cc":e=Mt(et.Day,1);break;case"ccc":e=ft(Je.Days,lt.Abbreviated,hn.Standalone);break;case"cccc":e=ft(Je.Days,lt.Wide,hn.Standalone);break;case"ccccc":e=ft(Je.Days,lt.Narrow,hn.Standalone);break;case"cccccc":e=ft(Je.Days,lt.Short,hn.Standalone);break;case"E":case"EE":case"EEE":e=ft(Je.Days,lt.Abbreviated);break;case"EEEE":e=ft(Je.Days,lt.Wide);break;case"EEEEE":e=ft(Je.Days,lt.Narrow);break;case"EEEEEE":e=ft(Je.Days,lt.Short);break;case"a":case"aa":case"aaa":e=ft(Je.DayPeriods,lt.Abbreviated);break;case"aaaa":e=ft(Je.DayPeriods,lt.Wide);break;case"aaaaa":e=ft(Je.DayPeriods,lt.Narrow);break;case"b":case"bb":case"bbb":e=ft(Je.DayPeriods,lt.Abbreviated,hn.Standalone,!0);break;case"bbbb":e=ft(Je.DayPeriods,lt.Wide,hn.Standalone,!0);break;case"bbbbb":e=ft(Je.DayPeriods,lt.Narrow,hn.Standalone,!0);break;case"B":case"BB":case"BBB":e=ft(Je.DayPeriods,lt.Abbreviated,hn.Format,!0);break;case"BBBB":e=ft(Je.DayPeriods,lt.Wide,hn.Format,!0);break;case"BBBBB":e=ft(Je.DayPeriods,lt.Narrow,hn.Format,!0);break;case"h":e=Mt(et.Hours,1,-12);break;case"hh":e=Mt(et.Hours,2,-12);break;case"H":e=Mt(et.Hours,1);break;case"HH":e=Mt(et.Hours,2);break;case"m":e=Mt(et.Minutes,1);break;case"mm":e=Mt(et.Minutes,2);break;case"s":e=Mt(et.Seconds,1);break;case"ss":e=Mt(et.Seconds,2);break;case"S":e=Mt(et.FractionalSeconds,1);break;case"SS":e=Mt(et.FractionalSeconds,2);break;case"SSS":e=Mt(et.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=_u(sr.Short);break;case"ZZZZZ":e=_u(sr.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=_u(sr.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=_u(sr.Long);break;default:return null}return of[n]=e,e}function X0(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function gb(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function _b(n,e,t){let i=t?-1:1,o=n.getTimezoneOffset(),s=X0(e,o);return gb(n,i*(s-o))}function vb(n){if(z0(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[o,s=1,l=1]=n.split("-").map(h=>+h);return Cu(o,s-1,l)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(ab))return yb(i)}let e=new Date(n);if(!z0(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function yb(n){let e=new Date(0),t=0,i=0,o=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),o.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let l=Number(n[4]||0)-t,h=Number(n[5]||0)-i,d=Number(n[6]||0),m=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,l,h,d,m),e}function z0(n){return n instanceof Date&&!isNaN(n.valueOf())}var wb=/^(\d+)?\.((\d+)(-(\d+))?)?$/,U0=22,bu=".",el="0",Cb=";",bb=",",sf="#";function Eb(n,e,t,i,o,s,l=!1){let h="",d=!1;if(!isFinite(n))h=or(t,On.Infinity);else{let m=Db(n);l&&(m=Pb(m));let v=e.minInt,w=e.minFrac,S=e.maxFrac;if(s){let oe=s.match(wb);if(oe===null)throw new Error(`${s} is not a valid digit info`);let me=oe[1],Ce=oe[3],pt=oe[5];me!=null&&(v=af(me)),Ce!=null&&(w=af(Ce)),pt!=null?S=af(pt):Ce!=null&&w>S&&(S=w)}Ib(m,w,S);let A=m.digits,F=m.integerLen,j=m.exponent,$=[];for(d=A.every(oe=>!oe);F<v;F++)A.unshift(0);for(;F<0;F++)A.unshift(0);F>0?$=A.splice(F,A.length):($=A,A=[0]);let ee=[];for(A.length>=e.lgSize&&ee.unshift(A.splice(-e.lgSize,A.length).join(""));A.length>e.gSize;)ee.unshift(A.splice(-e.gSize,A.length).join(""));A.length&&ee.unshift(A.join("")),h=ee.join(or(t,i)),$.length&&(h+=or(t,o)+$.join("")),j&&(h+=or(t,On.Exponential)+"+"+j)}return n<0&&!d?h=e.negPre+h+e.negSuf:h=e.posPre+h+e.posSuf,h}function Sb(n,e,t){let i=rb(e,Z0.Decimal),o=Tb(i,or(e,On.MinusSign));return Eb(n,o,e,On.Group,On.Decimal,t)}function Tb(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(Cb),o=i[0],s=i[1],l=o.indexOf(bu)!==-1?o.split(bu):[o.substring(0,o.lastIndexOf(el)+1),o.substring(o.lastIndexOf(el)+1)],h=l[0],d=l[1]||"";t.posPre=h.substring(0,h.indexOf(sf));for(let v=0;v<d.length;v++){let w=d.charAt(v);w===el?t.minFrac=t.maxFrac=v+1:w===sf?t.maxFrac=v+1:t.posSuf+=w}let m=h.split(bb);if(t.gSize=m[1]?m[1].length:0,t.lgSize=m[2]||m[1]?(m[2]||m[1]).length:0,s){let v=o.length-t.posPre.length-t.posSuf.length,w=s.indexOf(sf);t.negPre=s.substring(0,w).replace(/'/g,""),t.negSuf=s.slice(w+v).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function Pb(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function Db(n){let e=Math.abs(n)+"",t=0,i,o,s,l,h;for((o=e.indexOf(bu))>-1&&(e=e.replace(bu,"")),(s=e.search(/e/i))>0?(o<0&&(o=s),o+=+e.slice(s+1),e=e.substring(0,s)):o<0&&(o=e.length),s=0;e.charAt(s)===el;s++);if(s===(h=e.length))i=[0],o=1;else{for(h--;e.charAt(h)===el;)h--;for(o-=s,i=[],l=0;s<=h;s++,l++)i[l]=Number(e.charAt(s))}return o>U0&&(i=i.splice(0,U0-1),t=o-1,o=1),{digits:i,exponent:t,integerLen:o}}function Ib(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let i=n.digits,o=i.length-n.integerLen,s=Math.min(Math.max(e,o),t),l=s+n.integerLen,h=i[l];if(l>0){i.splice(Math.max(n.integerLen,l));for(let w=l;w<i.length;w++)i[w]=0}else{o=Math.max(0,o),n.integerLen=1,i.length=Math.max(1,l=s+1),i[0]=0;for(let w=1;w<l;w++)i[w]=0}if(h>=5)if(l-1<0){for(let w=0;w>l;w--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[l-1]++;for(;o<Math.max(0,s);o++)i.push(0);let d=s!==0,m=e+n.integerLen,v=i.reduceRight(function(w,S,A,F){return S=S+w,F[A]=S<10?S:S-10,d&&(F[A]===0&&A>=m?F.pop():d=!1),S>=10?1:0},0);v&&(i.unshift(v),n.integerLen++)}function af(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function J0(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[o,s]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(o.trim()===e)return decodeURIComponent(s)}return null}var lf=class{constructor(e,t,i,o){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=o}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},en=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,o){this._viewContainer=t,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((o,s,l)=>{if(o.previousIndex==null)i.createEmbeddedView(this._template,new lf(o.item,this._ngForOf,-1,-1),l===null?void 0:l);else if(l==null)i.remove(s===null?void 0:s);else if(s!==null){let h=i.get(s);i.move(h,l),j0(h,o)}});for(let o=0,s=i.length;o<s;o++){let h=i.get(o).context;h.index=o,h.count=s,h.ngForOf=this._ngForOf}t.forEachIdentityChange(o=>{let s=i.get(o.currentIndex);j0(s,o)})}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(ne(Za),ne(Kd),ne(l0))}}static{this.\u0275dir=Qt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function j0(n,e){n.context.$implicit=e.item}var Pt=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new cf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){$0("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){$0("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static{this.\u0275fac=function(i){return new(i||n)(ne(Za),ne(Kd))}}static{this.\u0275dir=Qt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})(),cf=class{constructor(){this.$implicit=null,this.ngIf=null}};function $0(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${W_(e)}'.`)}function ev(n,e){return new _e(2100,!1)}var Ab="mediumDate",xb=new tt(""),Mb=new tt(""),tv=(()=>{class n{constructor(t,i,o){this.locale=t,this.defaultTimezone=i,this.defaultOptions=o}transform(t,i,o,s){if(t==null||t===""||t!==t)return null;try{let l=i??this.defaultOptions?.dateFormat??Ab,h=o??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return cb(t,l,s||this.locale,h)}catch(l){throw ev(n,l.message)}}static{this.\u0275fac=function(i){return new(i||n)(ne(ef,16),ne(xb,24),ne(Mb,24))}}static{this.\u0275pipe=Ud({name:"date",type:n,pure:!0,standalone:!0})}}return n})();var nv=(()=>{class n{constructor(t){this._locale=t}transform(t,i,o){if(!Rb(t))return null;o||=this._locale;try{let s=kb(t);return Sb(s,o,i)}catch(s){throw ev(n,s.message)}}static{this.\u0275fac=function(i){return new(i||n)(ne(ef,16))}}static{this.\u0275pipe=Ud({name:"number",type:n,pure:!0,standalone:!0})}}return n})();function Rb(n){return!(n==null||n===""||n!==n)}function kb(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var ct=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Xi({type:n})}static{this.\u0275inj=Yi({})}}return n})(),gf="browser",Ob="server";function Lb(n){return n===gf}function _f(n){return n===Ob}var iv=(()=>{class n{static{this.\u0275prov=be({token:n,providedIn:"root",factory:()=>Lb(ue(wo))?new uf(ue(Jt),window):new hf})}}return n})(),uf=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Fb(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,o=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],o-s[1])}};function Fb(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),o=i.currentNode;for(;o;){let s=o.shadowRoot;if(s){let l=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(l)return l}o=i.nextNode()}}return null}var hf=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Eu=class{};var wf=class extends wu{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Cf=class n extends wf{static makeCurrent(){G0(new n)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Nb();return t==null?null:Bb(t)}resetBaseElement(){tl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return J0(document.cookie,e)}},tl=null;function Nb(){return tl=tl||document.querySelector("base"),tl?tl.getAttribute("href"):null}function Bb(n){return new URL(n,document.baseURI).pathname}var zb=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),bf=new tt(""),sv=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(o=>{o.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,o){return this._findPluginFor(i).addEventListener(t,i,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new _e(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(xe(bf),xe(In))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),Su=class{constructor(e){this._doc=e}},vf="ng-app-id",av=(()=>{class n{constructor(t,i,o,s={}){this.doc=t,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=_f(s),this.resetHostNodes()}addStyles(t){for(let i of t)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(t){for(let i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){let i=this.styleRef;i.get(t)?.elements?.forEach(o=>o.remove()),i.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${vf}="${this.appId}"]`);if(t?.length){let i=new Map;return t.forEach(o=>{o.textContent!=null&&i.set(o.textContent,o)}),i}return null}changeUsageCount(t,i){let o=this.styleRef;if(o.has(t)){let s=o.get(t);return s.usage+=i,s.usage}return o.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){let o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===t)return o.delete(i),s.removeAttribute(vf),s;{let l=this.doc.createElement("style");return this.nonce&&l.setAttribute("nonce",this.nonce),l.textContent=i,this.platformIsServer&&l.setAttribute(vf,this.appId),t.appendChild(l),l}}addStyleToHost(t,i){let o=this.getStyleElement(t,i),s=this.styleRef,l=s.get(i)?.elements;l?l.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(xe(Jt),xe(qd),xe(Hd,8),xe(wo))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),yf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Sf=/%COMP%/g,lv="%COMP%",Ub=`_nghost-${lv}`,jb=`_ngcontent-${lv}`,$b=!0,qb=new tt("",{providedIn:"root",factory:()=>$b});function Gb(n){return jb.replace(Sf,n)}function Hb(n){return Ub.replace(Sf,n)}function cv(n,e){return e.map(t=>t.replace(Sf,n))}var Tu=(()=>{class n{constructor(t,i,o,s,l,h,d,m=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=l,this.platformId=h,this.ngZone=d,this.nonce=m,this.rendererByCompId=new Map,this.platformIsServer=_f(h),this.defaultRenderer=new nl(t,l,d,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ha.ShadowDom&&(i=qe(J({},i),{encapsulation:Ha.Emulated}));let o=this.getOrCreateRenderer(t,i);return o instanceof Pu?o.applyToHost(t):o instanceof il&&o.applyStyles(),o}getOrCreateRenderer(t,i){let o=this.rendererByCompId,s=o.get(i.id);if(!s){let l=this.doc,h=this.ngZone,d=this.eventManager,m=this.sharedStylesHost,v=this.removeStylesOnCompDestroy,w=this.platformIsServer;switch(i.encapsulation){case Ha.Emulated:s=new Pu(d,m,i,this.appId,v,l,h,w);break;case Ha.ShadowDom:return new Ef(d,m,t,i,l,h,this.nonce,w);default:s=new il(d,m,i,v,l,h,w);break}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(xe(sv),xe(av),xe(qd),xe(qb),xe(Jt),xe(wo),xe(In),xe(Hd))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),nl=class{constructor(e,t,i,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=o,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(yf[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(rv(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(rv(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new _e(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,o){if(o){t=o+":"+t;let s=yf[o];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let o=yf[i];o?e.removeAttributeNS(o,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,o){o&(Ss.DashCase|Ss.Important)?e.style.setProperty(t,i,o&Ss.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ss.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if(typeof e=="string"&&(e=ar().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function rv(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Ef=class extends nl{constructor(e,t,i,o,s,l,h,d){super(e,s,l,d),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let m=cv(o.id,o.styles);for(let v of m){let w=document.createElement("style");h&&w.setAttribute("nonce",h),w.textContent=v,this.shadowRoot.appendChild(w)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},il=class extends nl{constructor(e,t,i,o,s,l,h,d){super(e,s,l,h),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=o,this.styles=d?cv(d,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Pu=class extends il{constructor(e,t,i,o,s,l,h,d){let m=o+"-"+i.id;super(e,t,i,s,l,h,d,m),this.contentAttr=Gb(m),this.hostAttr=Hb(m)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}},Kb=(()=>{class n extends Su{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,o){return t.addEventListener(i,o,!1),()=>this.removeEventListener(t,i,o)}removeEventListener(t,i,o){return t.removeEventListener(i,o)}static{this.\u0275fac=function(i){return new(i||n)(xe(Jt))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),ov=["alt","control","meta","shift"],Wb={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Zb={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Qb=(()=>{class n extends Su{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,o){let s=n.parseEventName(i),l=n.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ar().onAndCancel(t,s.domEventName,l))}static parseEventName(t){let i=t.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let s=n._normalizeKey(i.pop()),l="",h=i.indexOf("code");if(h>-1&&(i.splice(h,1),l="code."),ov.forEach(m=>{let v=i.indexOf(m);v>-1&&(i.splice(v,1),l+=m+".")}),l+=s,i.length!=0||s.length===0)return null;let d={};return d.domEventName=o,d.fullKey=l,d}static matchEventFullKeyCode(t,i){let o=Wb[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(o=t.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),ov.forEach(l=>{if(l!==o){let h=Zb[l];h(t)&&(s+=l+".")}}),s+=o,s===i)}static eventCallback(t,i,o){return s=>{n.matchEventFullKeyCode(s,t)&&o.runGuarded(()=>i(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(xe(Jt))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})();function uv(n,e,t){return c0(J({rootComponent:n,platformRef:t?.platformRef},Yb(e)))}function Yb(n){return{appProviders:[...nE,...n?.providers??[]],platformProviders:tE}}function Xb(){Cf.makeCurrent()}function Jb(){return new $d}function eE(){return J_(document),document}var tE=[{provide:wo,useValue:gf},{provide:e0,useValue:Xb,multi:!0},{provide:Jt,useFactory:eE,deps:[]}];var nE=[{provide:Y_,useValue:"root"},{provide:$d,useFactory:Jb,deps:[]},{provide:bf,useClass:Kb,multi:!0,deps:[Jt,In,wo]},{provide:bf,useClass:Qb,multi:!0,deps:[Jt]},Tu,av,sv,{provide:ou,useExisting:Tu},{provide:Eu,useClass:zb,deps:[]},[]];var hv=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(i){return new(i||n)(xe(Jt))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Re="primary",vl=Symbol("RouteTitle"),Af=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Rs(n){return new Af(n)}function rE(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let o={};for(let s=0;s<i.length;s++){let l=i[s],h=n[s];if(l[0]===":")o[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,i.length),posParams:o}}function oE(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Di(n[t],e[t]))return!1;return!0}function Di(n,e){let t=n?xf(n):void 0,i=e?xf(e):void 0;if(!t||!i||t.length!=i.length)return!1;let o;for(let s=0;s<t.length;s++)if(o=t[s],!bv(n[o],e[o]))return!1;return!0}function xf(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function bv(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((o,s)=>i[s]===o)}else return n===e}function Ev(n){return n.length>0?n[n.length-1]:null}function Fr(n){return B_(n)?n:Xa(n)?un(Promise.resolve(n)):Te(n)}var sE={exact:Tv,subset:Pv},Sv={exact:aE,subset:lE,ignored:()=>!0};function dv(n,e,t){return sE[t.paths](n.root,e.root,t.matrixParams)&&Sv[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function aE(n,e){return Di(n,e)}function Tv(n,e,t){if(!To(n.segments,e.segments)||!Au(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!Tv(n.children[i],e.children[i],t))return!1;return!0}function lE(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>bv(n[t],e[t]))}function Pv(n,e,t){return Dv(n,e,e.segments,t)}function Dv(n,e,t,i){if(n.segments.length>t.length){let o=n.segments.slice(0,t.length);return!(!To(o,t)||e.hasChildren()||!Au(o,t,i))}else if(n.segments.length===t.length){if(!To(n.segments,t)||!Au(n.segments,t,i))return!1;for(let o in e.children)if(!n.children[o]||!Pv(n.children[o],e.children[o],i))return!1;return!0}else{let o=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!To(n.segments,o)||!Au(n.segments,o,i)||!n.children[Re]?!1:Dv(n.children[Re],e,s,i)}}function Au(n,e,t){return e.every((i,o)=>Sv[t](n[o].parameters,i.parameters))}var ur=class{constructor(e=new rt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Rs(this.queryParams),this._queryParamMap}toString(){return hE.serialize(this)}},rt=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xu(this)}},So=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Rs(this.parameters),this._parameterMap}toString(){return Av(this)}};function cE(n,e){return To(n,e)&&n.every((t,i)=>Di(t.parameters,e[i].parameters))}function To(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function uE(n,e){let t=[];return Object.entries(n.children).forEach(([i,o])=>{i===Re&&(t=t.concat(e(o,i)))}),Object.entries(n.children).forEach(([i,o])=>{i!==Re&&(t=t.concat(e(o,i)))}),t}var yl=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>new ks,providedIn:"root"})}}return n})(),ks=class{parse(e){let t=new Rf(e);return new ur(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${rl(e.root,!0)}`,i=pE(e.queryParams),o=typeof e.fragment=="string"?`#${dE(e.fragment)}`:"";return`${t}${i}${o}`}},hE=new ks;function xu(n){return n.segments.map(e=>Av(e)).join("/")}function rl(n,e){if(!n.hasChildren())return xu(n);if(e){let t=n.children[Re]?rl(n.children[Re],!1):"",i=[];return Object.entries(n.children).forEach(([o,s])=>{o!==Re&&i.push(`${o}:${rl(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=uE(n,(i,o)=>o===Re?[rl(n.children[Re],!1)]:[`${o}:${rl(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Re]!=null?`${xu(n)}/${t[0]}`:`${xu(n)}/(${t.join("//")})`}}function Iv(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Du(n){return Iv(n).replace(/%3B/gi,";")}function dE(n){return encodeURI(n)}function Mf(n){return Iv(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Mu(n){return decodeURIComponent(n)}function fv(n){return Mu(n.replace(/\+/g,"%20"))}function Av(n){return`${Mf(n.path)}${fE(n.parameters)}`}function fE(n){return Object.entries(n).map(([e,t])=>`;${Mf(e)}=${Mf(t)}`).join("")}function pE(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(o=>`${Du(t)}=${Du(o)}`).join("&"):`${Du(t)}=${Du(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var mE=/^[^\/()?;#]+/;function Tf(n){let e=n.match(mE);return e?e[0]:""}var gE=/^[^\/()?;=#]+/;function _E(n){let e=n.match(gE);return e?e[0]:""}var vE=/^[^=?&#]+/;function yE(n){let e=n.match(vE);return e?e[0]:""}var wE=/^[^&#]+/;function CE(n){let e=n.match(wE);return e?e[0]:""}var Rf=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new rt([],{}):new rt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Re]=new rt(e,t)),i}parseSegment(){let e=Tf(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new _e(4009,!1);return this.capture(e),new So(Mu(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=_E(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let o=Tf(this.remaining);o&&(i=o,this.capture(i))}e[Mu(t)]=Mu(i)}parseQueryParam(e){let t=yE(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let l=CE(this.remaining);l&&(i=l,this.capture(i))}let o=fv(t),s=fv(i);if(e.hasOwnProperty(o)){let l=e[o];Array.isArray(l)||(l=[l],e[o]=l),l.push(s)}else e[o]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Tf(this.remaining),o=this.remaining[i.length];if(o!=="/"&&o!==")"&&o!==";")throw new _e(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Re);let l=this.parseChildren();t[s]=Object.keys(l).length===1?l[Re]:new rt([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new _e(4011,!1)}};function xv(n){return n.segments.length>0?new rt([],{[Re]:n}):n}function Mv(n){let e={};for(let[i,o]of Object.entries(n.children)){let s=Mv(o);if(i===Re&&s.segments.length===0&&s.hasChildren())for(let[l,h]of Object.entries(s.children))e[l]=h;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let t=new rt(n.segments,e);return bE(t)}function bE(n){if(n.numberOfChildren===1&&n.children[Re]){let e=n.children[Re];return new rt(n.segments.concat(e.segments),e.children)}return n}function Po(n){return n instanceof ur}function EE(n,e,t=null,i=null){let o=Rv(n);return kv(o,e,t,i)}function Rv(n){let e;function t(s){let l={};for(let d of s.children){let m=t(d);l[d.outlet]=m}let h=new rt(s.url,l);return s===n&&(e=h),h}let i=t(n.root),o=xv(i);return e??o}function kv(n,e,t,i){let o=n;for(;o.parent;)o=o.parent;if(e.length===0)return Pf(o,o,o,t,i);let s=SE(e);if(s.toRoot())return Pf(o,o,new rt([],{}),t,i);let l=TE(s,o,n),h=l.processChildren?al(l.segmentGroup,l.index,s.commands):Lv(l.segmentGroup,l.index,s.commands);return Pf(o,l.segmentGroup,h,t,i)}function Ru(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function ul(n){return typeof n=="object"&&n!=null&&n.outlets}function Pf(n,e,t,i,o){let s={};i&&Object.entries(i).forEach(([d,m])=>{s[d]=Array.isArray(m)?m.map(v=>`${v}`):`${m}`});let l;n===e?l=t:l=Ov(n,e,t);let h=xv(Mv(l));return new ur(h,s,o)}function Ov(n,e,t){let i={};return Object.entries(n.children).forEach(([o,s])=>{s===e?i[o]=t:i[o]=Ov(s,e,t)}),new rt(n.segments,i)}var ku=class{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Ru(i[0]))throw new _e(4003,!1);let o=i.find(ul);if(o&&o!==Ev(i))throw new _e(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function SE(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ku(!0,0,n);let e=0,t=!1,i=n.reduce((o,s,l)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let h={};return Object.entries(s.outlets).forEach(([d,m])=>{h[d]=typeof m=="string"?m.split("/"):m}),[...o,{outlets:h}]}if(s.segmentPath)return[...o,s.segmentPath]}return typeof s!="string"?[...o,s]:l===0?(s.split("/").forEach((h,d)=>{d==0&&h==="."||(d==0&&h===""?t=!0:h===".."?e++:h!=""&&o.push(h))}),o):[...o,s]},[]);return new ku(t,e,i)}var As=class{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function TE(n,e,t){if(n.isAbsolute)return new As(e,!0,0);if(!t)return new As(e,!1,NaN);if(t.parent===null)return new As(t,!0,0);let i=Ru(n.commands[0])?0:1,o=t.segments.length-1+i;return PE(t,o,n.numberOfDoubleDots)}function PE(n,e,t){let i=n,o=e,s=t;for(;s>o;){if(s-=o,i=i.parent,!i)throw new _e(4005,!1);o=i.segments.length}return new As(i,!1,o-s)}function DE(n){return ul(n[0])?n[0].outlets:{[Re]:n}}function Lv(n,e,t){if(n??=new rt([],{}),n.segments.length===0&&n.hasChildren())return al(n,e,t);let i=IE(n,e,t),o=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let s=new rt(n.segments.slice(0,i.pathIndex),{});return s.children[Re]=new rt(n.segments.slice(i.pathIndex),n.children),al(s,0,o)}else return i.match&&o.length===0?new rt(n.segments,{}):i.match&&!n.hasChildren()?kf(n,e,t):i.match?al(n,0,o):kf(n,e,t)}function al(n,e,t){if(t.length===0)return new rt(n.segments,{});{let i=DE(t),o={};if(Object.keys(i).some(s=>s!==Re)&&n.children[Re]&&n.numberOfChildren===1&&n.children[Re].segments.length===0){let s=al(n.children[Re],e,t);return new rt(n.segments,s.children)}return Object.entries(i).forEach(([s,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(o[s]=Lv(n.children[s],e,l))}),Object.entries(n.children).forEach(([s,l])=>{i[s]===void 0&&(o[s]=l)}),new rt(n.segments,o)}}function IE(n,e,t){let i=0,o=e,s={match:!1,pathIndex:0,commandIndex:0};for(;o<n.segments.length;){if(i>=t.length)return s;let l=n.segments[o],h=t[i];if(ul(h))break;let d=`${h}`,m=i<t.length-1?t[i+1]:null;if(o>0&&d===void 0)break;if(d&&m&&typeof m=="object"&&m.outlets===void 0){if(!mv(d,m,l))return s;i+=2}else{if(!mv(d,{},l))return s;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}function kf(n,e,t){let i=n.segments.slice(0,e),o=0;for(;o<t.length;){let s=t[o];if(ul(s)){let d=AE(s.outlets);return new rt(i,d)}if(o===0&&Ru(t[0])){let d=n.segments[e];i.push(new So(d.path,pv(t[0]))),o++;continue}let l=ul(s)?s.outlets[Re]:`${s}`,h=o<t.length-1?t[o+1]:null;l&&h&&Ru(h)?(i.push(new So(l,pv(h))),o+=2):(i.push(new So(l,{})),o++)}return new rt(i,{})}function AE(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=kf(new rt([],{}),0,i))}),e}function pv(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function mv(n,e,t){return n==t.path&&Di(e,t.parameters)}var ll="imperative",Ht=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ht||{}),Jn=class{constructor(e,t){this.id=e,this.url=t}},Os=class extends Jn{constructor(e,t,i="imperative",o=null){super(e,t),this.type=Ht.NavigationStart,this.navigationTrigger=i,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ii=class extends Jn{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=Ht.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Fn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Fn||{}),Ou=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Ou||{}),cr=class extends Jn{constructor(e,t,i,o){super(e,t),this.reason=i,this.code=o,this.type=Ht.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Or=class extends Jn{constructor(e,t,i,o){super(e,t),this.reason=i,this.code=o,this.type=Ht.NavigationSkipped}},hl=class extends Jn{constructor(e,t,i,o){super(e,t),this.error=i,this.target=o,this.type=Ht.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Lu=class extends Jn{constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o,this.type=Ht.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Of=class extends Jn{constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o,this.type=Ht.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lf=class extends Jn{constructor(e,t,i,o,s){super(e,t),this.urlAfterRedirects=i,this.state=o,this.shouldActivate=s,this.type=Ht.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ff=class extends Jn{constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o,this.type=Ht.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vf=class extends Jn{constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o,this.type=Ht.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nf=class{constructor(e){this.route=e,this.type=Ht.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Bf=class{constructor(e){this.route=e,this.type=Ht.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},zf=class{constructor(e){this.snapshot=e,this.type=Ht.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Uf=class{constructor(e){this.snapshot=e,this.type=Ht.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jf=class{constructor(e){this.snapshot=e,this.type=Ht.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$f=class{constructor(e){this.snapshot=e,this.type=Ht.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Fu=class{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=Ht.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},dl=class{},Ls=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function xE(n,e){return n.providers&&!n._injector&&(n._injector=Qd(n.providers,e,`Route: ${n.path}`)),n._injector??e}function di(n){return n.outlet||Re}function ME(n,e){let t=n.filter(i=>di(i)===e);return t.push(...n.filter(i=>di(i)!==e)),t}function wl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var qf=class{get injector(){return wl(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Cl(this.rootInjector),this.attachRef=null}},Cl=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,i){let o=this.getOrCreateContext(t);o.outlet=i,this.contexts.set(t,o)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new qf(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(i){return new(i||n)(xe(Wa))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Vu=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Gf(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=Gf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Hf(e,this._root);return t.length<2?[]:t[t.length-2].children.map(o=>o.value).filter(o=>o!==e)}pathFromRoot(e){return Hf(e,this._root).map(t=>t.value)}};function Gf(n,e){if(n===e.value)return e;for(let t of e.children){let i=Gf(n,t);if(i)return i}return null}function Hf(n,e){if(n===e.value)return[e];for(let t of e.children){let i=Hf(n,t);if(i.length)return i.unshift(e),i}return[]}var Ln=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Is(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Nu=class extends Vu{constructor(e,t){super(e),this.snapshot=t,tp(this,e)}toString(){return this.snapshot.toString()}};function Fv(n){let e=RE(n),t=new _n([new So("",{})]),i=new _n({}),o=new _n({}),s=new _n({}),l=new _n(""),h=new Lr(t,i,s,l,o,Re,n,e.root);return h.snapshot=e.root,new Nu(new Ln(h,[]),e)}function RE(n){let e={},t={},i={},o="",s=new xs([],e,i,o,t,Re,n,null,{});return new zu("",new Ln(s,[]))}var Lr=class{constructor(e,t,i,o,s,l,h,d){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=o,this.dataSubject=s,this.outlet=l,this.component=h,this._futureSnapshot=d,this.title=this.dataSubject?.pipe(We(m=>m[vl]))??Te(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=o,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(We(e=>Rs(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(We(e=>Rs(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Bu(n,e,t="emptyOnly"){let i,{routeConfig:o}=n;return e!==null&&(t==="always"||o?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:J(J({},e.params),n.params),data:J(J({},e.data),n.data),resolve:J(J(J(J({},n.data),e.data),o?.data),n._resolvedData)}:i={params:J({},n.params),data:J({},n.data),resolve:J(J({},n.data),n._resolvedData??{})},o&&Nv(o)&&(i.resolve[vl]=o.title),i}var xs=class{get title(){return this.data?.[vl]}constructor(e,t,i,o,s,l,h,d,m){this.url=e,this.params=t,this.queryParams=i,this.fragment=o,this.data=s,this.outlet=l,this.component=h,this.routeConfig=d,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Rs(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Rs(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},zu=class extends Vu{constructor(e,t){super(t),this.url=e,tp(this,t)}toString(){return Vv(this._root)}};function tp(n,e){e.value._routerState=n,e.children.forEach(t=>tp(n,t))}function Vv(n){let e=n.children.length>0?` { ${n.children.map(Vv).join(", ")} } `:"";return`${n.value}${e}`}function Df(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Di(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Di(e.params,t.params)||n.paramsSubject.next(t.params),oE(e.url,t.url)||n.urlSubject.next(t.url),Di(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Kf(n,e){let t=Di(n.params,e.params)&&cE(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||Kf(n.parent,e.parent))}function Nv(n){return typeof n.title=="string"||n.title===null}var np=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Re,this.activateEvents=new yt,this.deactivateEvents=new yt,this.attachEvents=new yt,this.detachEvents=new yt,this.parentContexts=ue(Cl),this.location=ue(Za),this.changeDetector=ue(Rn),this.inputBinder=ue(qu,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:o}=t.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new _e(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new _e(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new _e(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new _e(4013,!1);this._activatedRoute=t;let o=this.location,l=t.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,d=new Wf(t,h,o.injector);this.activated=o.createComponent(l,{index:o.length,injector:d,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=Qt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ui]})}}return n})(),Wf=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Lr?this.route:e===Cl?this.childContexts:this.parent.get(e,t)}},qu=new tt(""),gv=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:i}=t,o=iu([i.queryParams,i.params,i.data]).pipe(ci(([s,l,h],d)=>(h=J(J(J({},s),l),h),d===0?Te(h):Promise.resolve(h)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(t);return}let l=u0(i.component);if(!l){this.unsubscribeFromRouteData(t);return}for(let{templateName:h}of l.inputs)t.activatedComponentRef.setInput(h,s[h])});this.outletDataSubscriptions.set(t,o)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})();function kE(n,e,t){let i=fl(n,e._root,t?t._root:void 0);return new Nu(i,e)}function fl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let o=OE(n,e,t);return new Ln(i,o)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let l=s.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>fl(n,h)),l}}let i=LE(e.value),o=e.children.map(s=>fl(n,s));return new Ln(i,o)}}function OE(n,e,t){return e.children.map(i=>{for(let o of t.children)if(n.shouldReuseRoute(i.value,o.value.snapshot))return fl(n,i,o);return fl(n,i)})}function LE(n){return new Lr(new _n(n.url),new _n(n.params),new _n(n.queryParams),new _n(n.fragment),new _n(n.data),n.outlet,n.component,n)}var pl=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Bv="ngNavigationCancelingError";function Uu(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=Po(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,o=zv(!1,Fn.Redirect);return o.url=t,o.navigationBehaviorOptions=i,o}function zv(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Bv]=!0,t.cancellationCode=e,t}function FE(n){return Uv(n)&&Po(n.url)}function Uv(n){return!!n&&n[Bv]}var VE=(n,e,t,i)=>We(o=>(new Zf(e,o.targetRouterState,o.currentRouterState,t,i).activate(n),o)),Zf=class{constructor(e,t,i,o,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=o,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Df(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let o=Is(t);e.children.forEach(s=>{let l=s.value.outlet;this.deactivateRoutes(s,o[l],i),delete o[l]}),Object.values(o).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){let o=e.value,s=t?t.value:null;if(o===s)if(o.component){let l=i.getContext(o.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),o=i&&e.value.component?i.children:t,s=Is(e);for(let l of Object.values(s))this.deactivateRouteAndItsChildren(l,o);if(i&&i.outlet){let l=i.outlet.detach(),h=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),o=i&&e.value.component?i.children:t,s=Is(e);for(let l of Object.values(s))this.deactivateRouteAndItsChildren(l,o);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let o=Is(t);e.children.forEach(s=>{this.activateRoutes(s,o[s.value.outlet],i),this.forwardEvent(new $f(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Uf(e.value.snapshot))}activateRoutes(e,t,i){let o=e.value,s=t?t.value:null;if(Df(o),o===s)if(o.component){let l=i.getOrCreateContext(o.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,i);else if(o.component){let l=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let h=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),Df(h.route.value),this.activateChildRoutes(e,null,l.children)}else l.attachRef=null,l.route=o,l.outlet&&l.outlet.activateWith(o,l.injector),this.activateChildRoutes(e,null,l.children)}else this.activateChildRoutes(e,null,i)}},ju=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ms=class{constructor(e,t){this.component=e,this.route=t}};function NE(n,e,t){let i=n._root,o=e?e._root:null;return ol(i,o,t,[i.value])}function BE(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Vs(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!Z_(n)?n:e.get(n):i}function ol(n,e,t,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=Is(e);return n.children.forEach(l=>{zE(l,s[l.value.outlet],t,i.concat([l.value]),o),delete s[l.value.outlet]}),Object.entries(s).forEach(([l,h])=>cl(h,t.getContext(l),o)),o}function zE(n,e,t,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&s.routeConfig===l.routeConfig){let d=UE(l,s,s.routeConfig.runGuardsAndResolvers);d?o.canActivateChecks.push(new ju(i)):(s.data=l.data,s._resolvedData=l._resolvedData),s.component?ol(n,e,h?h.children:null,i,o):ol(n,e,t,i,o),d&&h&&h.outlet&&h.outlet.isActivated&&o.canDeactivateChecks.push(new Ms(h.outlet.component,l))}else l&&cl(e,h,o),o.canActivateChecks.push(new ju(i)),s.component?ol(n,null,h?h.children:null,i,o):ol(n,null,t,i,o);return o}function UE(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!To(n.url,e.url);case"pathParamsOrQueryParamsChange":return!To(n.url,e.url)||!Di(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Kf(n,e)||!Di(n.queryParams,e.queryParams);case"paramsChange":default:return!Kf(n,e)}}function cl(n,e,t){let i=Is(n),o=n.value;Object.entries(i).forEach(([s,l])=>{o.component?e?cl(l,e.children.getContext(s),t):cl(l,null,t):cl(l,e,t)}),o.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ms(e.outlet.component,o)):t.canDeactivateChecks.push(new Ms(null,o)):t.canDeactivateChecks.push(new Ms(null,o))}function bl(n){return typeof n=="function"}function jE(n){return typeof n=="boolean"}function $E(n){return n&&bl(n.canLoad)}function qE(n){return n&&bl(n.canActivate)}function GE(n){return n&&bl(n.canActivateChild)}function HE(n){return n&&bl(n.canDeactivate)}function KE(n){return n&&bl(n.canMatch)}function jv(n){return n instanceof z_||n?.name==="EmptyError"}var Iu=Symbol("INITIAL_VALUE");function Fs(){return ci(n=>iu(n.map(e=>e.pipe(Es(1),H_(Iu)))).pipe(We(e=>{for(let t of e)if(t!==!0){if(t===Iu)return Iu;if(t===!1||WE(t))return t}return!0}),go(e=>e!==Iu),Es(1)))}function WE(n){return Po(n)||n instanceof pl}function ZE(n,e){return Dn(t=>{let{targetSnapshot:i,currentSnapshot:o,guards:{canActivateChecks:s,canDeactivateChecks:l}}=t;return l.length===0&&s.length===0?Te(qe(J({},t),{guardsResult:!0})):QE(l,i,o,n).pipe(Dn(h=>h&&jE(h)?YE(i,s,n,e):Te(h)),We(h=>qe(J({},t),{guardsResult:h})))})}function QE(n,e,t,i){return un(n).pipe(Dn(o=>nS(o.component,o.route,t,e,i)),xr(o=>o!==!0,!0))}function YE(n,e,t,i){return un(e).pipe(bs(o=>U_(JE(o.route.parent,i),XE(o.route,i),tS(n,o.path,t),eS(n,o.route,t))),xr(o=>o!==!0,!0))}function XE(n,e){return n!==null&&e&&e(new jf(n)),Te(!0)}function JE(n,e){return n!==null&&e&&e(new zf(n)),Te(!0)}function eS(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return Te(!0);let o=i.map(s=>Vd(()=>{let l=wl(e)??t,h=Vs(s,l),d=qE(h)?h.canActivate(e,n):Pi(l,()=>h(e,n));return Fr(d).pipe(xr())}));return Te(o).pipe(Fs())}function tS(n,e,t){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(l=>BE(l)).filter(l=>l!==null).map(l=>Vd(()=>{let h=l.guards.map(d=>{let m=wl(l.node)??t,v=Vs(d,m),w=GE(v)?v.canActivateChild(i,n):Pi(m,()=>v(i,n));return Fr(w).pipe(xr())});return Te(h).pipe(Fs())}));return Te(s).pipe(Fs())}function nS(n,e,t,i,o){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Te(!0);let l=s.map(h=>{let d=wl(e)??o,m=Vs(h,d),v=HE(m)?m.canDeactivate(n,e,t,i):Pi(d,()=>m(n,e,t,i));return Fr(v).pipe(xr())});return Te(l).pipe(Fs())}function iS(n,e,t,i){let o=e.canLoad;if(o===void 0||o.length===0)return Te(!0);let s=o.map(l=>{let h=Vs(l,n),d=$E(h)?h.canLoad(e,t):Pi(n,()=>h(e,t));return Fr(d)});return Te(s).pipe(Fs(),$v(i))}function $v(n){return V_(Xt(e=>{if(typeof e!="boolean")throw Uu(n,e)}),We(e=>e===!0))}function rS(n,e,t,i){let o=e.canMatch;if(!o||o.length===0)return Te(!0);let s=o.map(l=>{let h=Vs(l,n),d=KE(h)?h.canMatch(e,t):Pi(n,()=>h(e,t));return Fr(d)});return Te(s).pipe(Fs(),$v(i))}var ml=class{constructor(e){this.segmentGroup=e||null}},gl=class extends Error{constructor(e){super(),this.urlTree=e}};function Ds(n){return Ga(new ml(n))}function oS(n){return Ga(new _e(4e3,!1))}function sS(n){return Ga(zv(!1,Fn.GuardRejected))}var Qf=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],o=t.root;for(;;){if(i=i.concat(o.segments),o.numberOfChildren===0)return Te(i);if(o.numberOfChildren>1||!o.children[Re])return oS(`${e.redirectTo}`);o=o.children[Re]}}applyRedirectCommands(e,t,i,o,s){if(typeof t!="string"){let h=t,{queryParams:d,fragment:m,routeConfig:v,url:w,outlet:S,params:A,data:F,title:j}=o,$=Pi(s,()=>h({params:A,data:F,queryParams:d,fragment:m,routeConfig:v,url:w,outlet:S,title:j}));if($ instanceof ur)throw new gl($);t=$}let l=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t[0]==="/")throw new gl(l);return l}applyRedirectCreateUrlTree(e,t,i,o){let s=this.createSegmentGroup(e,t.root,i,o);return new ur(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([o,s])=>{if(typeof s=="string"&&s[0]===":"){let h=s.substring(1);i[o]=t[h]}else i[o]=s}),i}createSegmentGroup(e,t,i,o){let s=this.createSegments(e,t.segments,i,o),l={};return Object.entries(t.children).forEach(([h,d])=>{l[h]=this.createSegmentGroup(e,d,i,o)}),new rt(s,l)}createSegments(e,t,i,o){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,o):this.findOrReturn(s,i))}findPosParam(e,t,i){let o=i[t.path.substring(1)];if(!o)throw new _e(4001,!1);return o}findOrReturn(e,t){let i=0;for(let o of t){if(o.path===e.path)return t.splice(i),o;i++}return e}},Yf={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function aS(n,e,t,i,o){let s=qv(n,e,t);return s.matched?(i=xE(e,i),rS(i,e,t,o).pipe(We(l=>l===!0?s:J({},Yf)))):Te(s)}function qv(n,e,t){if(e.path==="**")return lS(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?J({},Yf):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let o=(e.matcher||rE)(t,n,e);if(!o)return J({},Yf);let s={};Object.entries(o.posParams??{}).forEach(([h,d])=>{s[h]=d.path});let l=o.consumed.length>0?J(J({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,remainingSegments:t.slice(o.consumed.length),parameters:l,positionalParamSegments:o.posParams??{}}}function lS(n){return{matched:!0,parameters:n.length>0?Ev(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function _v(n,e,t,i){return t.length>0&&hS(n,t,i)?{segmentGroup:new rt(e,uS(i,new rt(t,n.children))),slicedSegments:[]}:t.length===0&&dS(n,t,i)?{segmentGroup:new rt(n.segments,cS(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new rt(n.segments,n.children),slicedSegments:t}}function cS(n,e,t,i){let o={};for(let s of t)if(Gu(n,e,s)&&!i[di(s)]){let l=new rt([],{});o[di(s)]=l}return J(J({},i),o)}function uS(n,e){let t={};t[Re]=e;for(let i of n)if(i.path===""&&di(i)!==Re){let o=new rt([],{});t[di(i)]=o}return t}function hS(n,e,t){return t.some(i=>Gu(n,e,i)&&di(i)!==Re)}function dS(n,e,t){return t.some(i=>Gu(n,e,i))}function Gu(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function fS(n,e,t){return e.length===0&&!n.children[t]}var Xf=class{};function pS(n,e,t,i,o,s,l="emptyOnly"){return new Jf(n,e,t,i,o,l,s).recognize()}var mS=31,Jf=class{constructor(e,t,i,o,s,l,h){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=o,this.urlTree=s,this.paramsInheritanceStrategy=l,this.urlSerializer=h,this.applyRedirects=new Qf(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new _e(4002,`'${e.segmentGroup}'`)}recognize(){let e=_v(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(We(({children:t,rootSnapshot:i})=>{let o=new Ln(i,t),s=new zu("",o),l=EE(i,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(l),{state:s,tree:l}}))}match(e){let t=new xs([],Object.freeze({}),Object.freeze(J({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Re,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Re,t).pipe(We(i=>({children:i,rootSnapshot:t})),Cs(i=>{if(i instanceof gl)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof ml?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,o,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,s):this.processSegment(e,t,i,i.segments,o,!0,s).pipe(We(l=>l instanceof Ln?[l]:[]))}processChildren(e,t,i,o){let s=[];for(let l of Object.keys(i.children))l==="primary"?s.unshift(l):s.push(l);return un(s).pipe(bs(l=>{let h=i.children[l],d=ME(t,l);return this.processSegmentGroup(e,d,h,l,o)}),G_((l,h)=>(l.push(...h),l)),Nd(null),q_(),Dn(l=>{if(l===null)return Ds(i);let h=Gv(l);return gS(h),Te(h)}))}processSegment(e,t,i,o,s,l,h){return un(t).pipe(bs(d=>this.processSegmentAgainstRoute(d._injector??e,t,d,i,o,s,l,h).pipe(Cs(m=>{if(m instanceof ml)return Te(null);throw m}))),xr(d=>!!d),Cs(d=>{if(jv(d))return fS(i,o,s)?Te(new Xf):Ds(i);throw d}))}processSegmentAgainstRoute(e,t,i,o,s,l,h,d){return di(i)!==l&&(l===Re||!Gu(o,s,i))?Ds(o):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,o,i,s,l,d):this.allowRedirects&&h?this.expandSegmentAgainstRouteUsingRedirect(e,o,t,i,s,l,d):Ds(o)}expandSegmentAgainstRouteUsingRedirect(e,t,i,o,s,l,h){let{matched:d,parameters:m,consumedSegments:v,positionalParamSegments:w,remainingSegments:S}=qv(t,o,s);if(!d)return Ds(t);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>mS&&(this.allowRedirects=!1));let A=new xs(s,m,Object.freeze(J({},this.urlTree.queryParams)),this.urlTree.fragment,vv(o),di(o),o.component??o._loadedComponent??null,o,yv(o)),F=Bu(A,h,this.paramsInheritanceStrategy);A.params=Object.freeze(F.params),A.data=Object.freeze(F.data);let j=this.applyRedirects.applyRedirectCommands(v,o.redirectTo,w,A,e);return this.applyRedirects.lineralizeSegments(o,j).pipe(Dn($=>this.processSegment(e,i,t,$.concat(S),l,!1,h)))}matchSegmentAgainstRoute(e,t,i,o,s,l){let h=aS(t,i,o,e,this.urlSerializer);return i.path==="**"&&(t.children={}),h.pipe(ci(d=>d.matched?(e=i._injector??e,this.getChildConfig(e,i,o).pipe(ci(({routes:m})=>{let v=i._loadedInjector??e,{parameters:w,consumedSegments:S,remainingSegments:A}=d,F=new xs(S,w,Object.freeze(J({},this.urlTree.queryParams)),this.urlTree.fragment,vv(i),di(i),i.component??i._loadedComponent??null,i,yv(i)),j=Bu(F,l,this.paramsInheritanceStrategy);F.params=Object.freeze(j.params),F.data=Object.freeze(j.data);let{segmentGroup:$,slicedSegments:ee}=_v(t,S,A,m);if(ee.length===0&&$.hasChildren())return this.processChildren(v,m,$,F).pipe(We(me=>new Ln(F,me)));if(m.length===0&&ee.length===0)return Te(new Ln(F,[]));let oe=di(i)===s;return this.processSegment(v,m,$,ee,oe?Re:s,!0,F).pipe(We(me=>new Ln(F,me instanceof Ln?[me]:[])))}))):Ds(t)))}getChildConfig(e,t,i){return t.children?Te({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Te({routes:t._loadedRoutes,injector:t._loadedInjector}):iS(e,t,i,this.urlSerializer).pipe(Dn(o=>o?this.configLoader.loadChildren(e,t).pipe(Xt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):sS(t))):Te({routes:[],injector:e})}};function gS(n){n.sort((e,t)=>e.value.outlet===Re?-1:t.value.outlet===Re?1:e.value.outlet.localeCompare(t.value.outlet))}function _S(n){let e=n.value.routeConfig;return e&&e.path===""}function Gv(n){let e=[],t=new Set;for(let i of n){if(!_S(i)){e.push(i);continue}let o=e.find(s=>i.value.routeConfig===s.value.routeConfig);o!==void 0?(o.children.push(...i.children),t.add(o)):e.push(i)}for(let i of t){let o=Gv(i.children);e.push(new Ln(i.value,o))}return e.filter(i=>!t.has(i))}function vv(n){return n.data||{}}function yv(n){return n.resolve||{}}function vS(n,e,t,i,o,s){return Dn(l=>pS(n,e,t,i,l.extractedUrl,o,s).pipe(We(({state:h,tree:d})=>qe(J({},l),{targetSnapshot:h,urlAfterRedirects:d}))))}function yS(n,e){return Dn(t=>{let{targetSnapshot:i,guards:{canActivateChecks:o}}=t;if(!o.length)return Te(t);let s=new Set(o.map(d=>d.route)),l=new Set;for(let d of s)if(!l.has(d))for(let m of Hv(d))l.add(m);let h=0;return un(l).pipe(bs(d=>s.has(d)?wS(d,i,n,e):(d.data=Bu(d,d.parent,n).resolve,Te(void 0))),Xt(()=>h++),Bd(1),Dn(d=>h===l.size?Te(t):Ar))})}function Hv(n){let e=n.children.map(t=>Hv(t)).flat();return[n,...e]}function wS(n,e,t,i){let o=n.routeConfig,s=n._resolve;return o?.title!==void 0&&!Nv(o)&&(s[vl]=o.title),CS(s,n,e,i).pipe(We(l=>(n._resolvedData=l,n.data=Bu(n,n.parent,t).resolve,null)))}function CS(n,e,t,i){let o=xf(n);if(o.length===0)return Te({});let s={};return un(o).pipe(Dn(l=>bS(n[l],e,t,i).pipe(xr(),Xt(h=>{if(h instanceof pl)throw Uu(new ks,h);s[l]=h}))),Bd(1),$_(s),Cs(l=>jv(l)?Ar:Ga(l)))}function bS(n,e,t,i){let o=wl(e)??i,s=Vs(n,o),l=s.resolve?s.resolve(e,t):Pi(o,()=>s(e,t));return Fr(l)}function If(n){return ci(e=>{let t=n(e);return t?un(t).pipe(We(()=>e)):Te(e)})}var Kv=(()=>{class n{buildTitle(t){let i,o=t.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===Re);return i}getResolvedTitleForRoute(t){return t.data[vl]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>ue(ES),providedIn:"root"})}}return n})(),ES=(()=>{class n extends Kv{constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||n)(xe(hv))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),El=new tt("",{providedIn:"root",factory:()=>({})}),SS=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=nt({type:n,selectors:[["ng-component"]],standalone:!0,features:[it],decls:1,vars:0,template:function(i,o){i&1&&X(0,"router-outlet")},dependencies:[np],encapsulation:2})}}return n})();function ip(n){let e=n.children&&n.children.map(ip),t=e?qe(J({},n),{children:e}):J({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Re&&(t.component=SS),t}var _l=new tt(""),rp=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ue(lu)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Te(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let i=Fr(t.loadComponent()).pipe(We(Wv),Xt(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),ru(()=>{this.componentLoaders.delete(t)})),o=new Ld(i,()=>new Ti).pipe(Od());return this.componentLoaders.set(t,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Te({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=TS(i,this.compiler,t,this.onLoadEndListener).pipe(ru(()=>{this.childrenLoaders.delete(i)})),l=new Ld(s,()=>new Ti).pipe(Od());return this.childrenLoaders.set(i,l),l}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function TS(n,e,t,i){return Fr(n.loadChildren()).pipe(We(Wv),Dn(o=>o instanceof i0||Array.isArray(o)?Te(o):un(e.compileModuleAsync(o))),We(o=>{i&&i(n);let s,l,h=!1;return Array.isArray(o)?(l=o,h=!0):(s=o.create(t).injector,l=s.get(_l,[],{optional:!0,self:!0}).flat()),{routes:l.map(ip),injector:s}}))}function PS(n){return n&&typeof n=="object"&&"default"in n}function Wv(n){return PS(n)?n.default:n}var op=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>ue(DS),providedIn:"root"})}}return n})(),DS=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Zv=new tt(""),Qv=new tt("");function IS(n,e,t){let i=n.get(Qv),o=n.get(Jt);return n.get(In).runOutsideAngular(()=>{if(!o.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(m=>setTimeout(m));let s,l=new Promise(m=>{s=m}),h=o.startViewTransition(()=>(s(),AS(n))),{onViewTransitionCreated:d}=i;return d&&Pi(n,()=>d({transition:h,from:e,to:t})),l})}function AS(n){return new Promise(e=>{r0({read:()=>setTimeout(e)},{injector:n})})}var xS=new tt(""),sp=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ti,this.transitionAbortSubject=new Ti,this.configLoader=ue(rp),this.environmentInjector=ue(Wa),this.urlSerializer=ue(yl),this.rootContexts=ue(Cl),this.location=ue(Ps),this.inputBindingEnabled=ue(qu,{optional:!0})!==null,this.titleStrategy=ue(Kv),this.options=ue(El,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ue(op),this.createViewTransition=ue(Zv,{optional:!0}),this.navigationErrorHandler=ue(xS,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Te(void 0),this.rootComponentType=null;let t=o=>this.events.next(new Nf(o)),i=o=>this.events.next(new Bf(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;this.transitions?.next(qe(J(J({},this.transitions.value),t),{id:i}))}setupNavigations(t,i,o){return this.transitions=new _n({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:ll,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(go(s=>s.id!==0),We(s=>qe(J({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),ci(s=>{let l=!1,h=!1;return Te(s).pipe(ci(d=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Fn.SupersededByNewNavigation),Ar;this.currentTransition=s,this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,targetBrowserUrl:typeof d.extras.browserUrl=="string"?this.urlSerializer.parse(d.extras.browserUrl):d.extras.browserUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?qe(J({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let m=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),v=d.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!m&&v!=="reload"){let w="";return this.events.next(new Or(d.id,this.urlSerializer.serialize(d.rawUrl),w,Ou.IgnoredSameUrlNavigation)),d.resolve(!1),Ar}if(this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return Te(d).pipe(ci(w=>{let S=this.transitions?.getValue();return this.events.next(new Os(w.id,this.urlSerializer.serialize(w.extractedUrl),w.source,w.restoredState)),S!==this.transitions?.getValue()?Ar:Promise.resolve(w)}),vS(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Xt(w=>{s.targetSnapshot=w.targetSnapshot,s.urlAfterRedirects=w.urlAfterRedirects,this.currentNavigation=qe(J({},this.currentNavigation),{finalUrl:w.urlAfterRedirects});let S=new Lu(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(S)}));if(m&&this.urlHandlingStrategy.shouldProcessUrl(d.currentRawUrl)){let{id:w,extractedUrl:S,source:A,restoredState:F,extras:j}=d,$=new Os(w,this.urlSerializer.serialize(S),A,F);this.events.next($);let ee=Fv(this.rootComponentType).snapshot;return this.currentTransition=s=qe(J({},d),{targetSnapshot:ee,urlAfterRedirects:S,extras:qe(J({},j),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=S,Te(s)}else{let w="";return this.events.next(new Or(d.id,this.urlSerializer.serialize(d.extractedUrl),w,Ou.IgnoredByUrlHandlingStrategy)),d.resolve(!1),Ar}}),Xt(d=>{let m=new Of(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}),We(d=>(this.currentTransition=s=qe(J({},d),{guards:NE(d.targetSnapshot,d.currentSnapshot,this.rootContexts)}),s)),ZE(this.environmentInjector,d=>this.events.next(d)),Xt(d=>{if(s.guardsResult=d.guardsResult,d.guardsResult&&typeof d.guardsResult!="boolean")throw Uu(this.urlSerializer,d.guardsResult);let m=new Lf(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.events.next(m)}),go(d=>d.guardsResult?!0:(this.cancelNavigationTransition(d,"",Fn.GuardRejected),!1)),If(d=>{if(d.guards.canActivateChecks.length)return Te(d).pipe(Xt(m=>{let v=new Ff(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}),ci(m=>{let v=!1;return Te(m).pipe(yS(this.paramsInheritanceStrategy,this.environmentInjector),Xt({next:()=>v=!0,complete:()=>{v||this.cancelNavigationTransition(m,"",Fn.NoDataFromResolver)}}))}),Xt(m=>{let v=new Vf(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}))}),If(d=>{let m=v=>{let w=[];v.routeConfig?.loadComponent&&!v.routeConfig._loadedComponent&&w.push(this.configLoader.loadComponent(v.routeConfig).pipe(Xt(S=>{v.component=S}),We(()=>{})));for(let S of v.children)w.push(...m(S));return w};return iu(m(d.targetSnapshot.root)).pipe(Nd(null),Es(1))}),If(()=>this.afterPreactivation()),ci(()=>{let{currentSnapshot:d,targetSnapshot:m}=s,v=this.createViewTransition?.(this.environmentInjector,d.root,m.root);return v?un(v).pipe(We(()=>s)):Te(s)}),We(d=>{let m=kE(t.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return this.currentTransition=s=qe(J({},d),{targetRouterState:m}),this.currentNavigation.targetRouterState=m,s}),Xt(()=>{this.events.next(new dl)}),VE(this.rootContexts,t.routeReuseStrategy,d=>this.events.next(d),this.inputBindingEnabled),Es(1),Xt({next:d=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ii(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects))),this.titleStrategy?.updateTitle(d.targetRouterState.snapshot),d.resolve(!0)},complete:()=>{l=!0}}),K_(this.transitionAbortSubject.pipe(Xt(d=>{throw d}))),ru(()=>{!l&&!h&&this.cancelNavigationTransition(s,"",Fn.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Cs(d=>{if(h=!0,Uv(d))this.events.next(new cr(s.id,this.urlSerializer.serialize(s.extractedUrl),d.message,d.cancellationCode)),FE(d)?this.events.next(new Ls(d.url,d.navigationBehaviorOptions)):s.resolve(!1);else{let m=new hl(s.id,this.urlSerializer.serialize(s.extractedUrl),d,s.targetSnapshot??void 0);try{let v=Pi(this.environmentInjector,()=>this.navigationErrorHandler?.(m));if(v instanceof pl){let{message:w,cancellationCode:S}=Uu(this.urlSerializer,v);this.events.next(new cr(s.id,this.urlSerializer.serialize(s.extractedUrl),w,S)),this.events.next(new Ls(v.redirectTo,v.navigationBehaviorOptions))}else{this.events.next(m);let w=t.errorHandler(d);s.resolve(!!w)}}catch(v){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(v)}}return Ar}))}))}cancelNavigationTransition(t,i,o){let s=new cr(t.id,this.urlSerializer.serialize(t.extractedUrl),i,o);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function MS(n){return n!==ll}var RS=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>ue(kS),providedIn:"root"})}}return n})(),ep=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},kS=(()=>{class n extends ep{static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Yv=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:()=>ue(OS),providedIn:"root"})}}return n})(),OS=(()=>{class n extends Yv{constructor(){super(...arguments),this.location=ue(Ps),this.urlSerializer=ue(yl),this.options=ue(El,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ue(op),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ur,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Fv(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof Os)this.stateMemento=this.createStateMemento();else if(t instanceof Or)this.rawUrlTree=i.initialUrl;else if(t instanceof Lu){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??o,i)}}else t instanceof dl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):t instanceof cr&&(t.code===Fn.GuardRejected||t.code===Fn.NoDataFromResolver)?this.restoreHistory(i):t instanceof hl?this.restoreHistory(i,!0):t instanceof Ii&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){let o=t instanceof ur?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){let s=this.browserPageId,l=J(J({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(o,"",l)}else{let s=J(J({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),sl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(sl||{});function Xv(n,e){n.events.pipe(go(t=>t instanceof Ii||t instanceof cr||t instanceof hl||t instanceof Or),We(t=>t instanceof Ii||t instanceof Or?sl.COMPLETE:(t instanceof cr?t.code===Fn.Redirect||t.code===Fn.SupersededByNewNavigation:!1)?sl.REDIRECTING:sl.FAILED),go(t=>t!==sl.REDIRECTING),Es(1)).subscribe(()=>{e()})}function LS(n){throw n}var FS={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},VS={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ke=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=ue(au),this.stateManager=ue(Yv),this.options=ue(El,{optional:!0})||{},this.pendingTasks=ue(X_),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ue(sp),this.urlSerializer=ue(yl),this.location=ue(Ps),this.urlHandlingStrategy=ue(op),this._events=new Ti,this.errorHandler=this.options.errorHandler||LS,this.navigated=!1,this.routeReuseStrategy=ue(RS),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ue(_l,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ue(qu,{optional:!0}),this.eventsSubscription=new F_,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof cr&&i.code!==Fn.Redirect&&i.code!==Fn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ii)this.navigated=!0;else if(i instanceof Ls){let l=i.navigationBehaviorOptions,h=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),d=J({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||MS(o.source)},l);this.scheduleNavigation(h,ll,null,d,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}BS(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ll,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,o){let s={replaceUrl:!0},l=o?.navigationId?o:null;if(o){let d=J({},o);delete d.navigationId,delete d.\u0275routerPageId,Object.keys(d).length!==0&&(s.state=d)}let h=this.parseUrl(t);this.scheduleNavigation(h,i,l,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ip),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:o,queryParams:s,fragment:l,queryParamsHandling:h,preserveFragment:d}=i,m=d?this.currentUrlTree.fragment:l,v=null;switch(h??this.options.defaultQueryParamsHandling){case"merge":v=J(J({},this.currentUrlTree.queryParams),s);break;case"preserve":v=this.currentUrlTree.queryParams;break;default:v=s||null}v!==null&&(v=this.removeEmptyProps(v));let w;try{let S=o?o.snapshot:this.routerState.snapshot.root;w=Rv(S)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),w=this.currentUrlTree.root}return kv(w,t,v,m??null)}navigateByUrl(t,i={skipLocationChange:!1}){let o=Po(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,ll,null,i)}navigate(t,i={skipLocationChange:!1}){return NS(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let o;if(i===!0?o=J({},FS):i===!1?o=J({},VS):o=i,Po(t))return dv(this.currentUrlTree,t,o);let s=this.parseUrl(t);return dv(this.currentUrlTree,s,o)}removeEmptyProps(t){return Object.entries(t).reduce((i,[o,s])=>(s!=null&&(i[o]=s),i),{})}scheduleNavigation(t,i,o,s,l){if(this.disposed)return Promise.resolve(!1);let h,d,m;l?(h=l.resolve,d=l.reject,m=l.promise):m=new Promise((w,S)=>{h=w,d=S});let v=this.pendingTasks.add();return Xv(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(v))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:h,reject:d,promise:m,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),m.catch(w=>Promise.reject(w))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function NS(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new _e(4008,!1)}function BS(n){return!(n instanceof dl)&&!(n instanceof Ls)}var Jv=(()=>{class n{constructor(t,i,o,s,l,h){this.router=t,this.route=i,this.tabIndexAttribute=o,this.renderer=s,this.el=l,this.locationStrategy=h,this.href=null,this.onChanges=new Ti,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let d=l.nativeElement.tagName?.toLowerCase();this.isAnchorElement=d==="a"||d==="area",this.isAnchorElement?this.subscription=t.events.subscribe(m=>{m instanceof Ii&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Po(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,o,s,l){let h=this.urlTree;if(h===null||this.isAnchorElement&&(t!==0||i||o||s||l||typeof this.target=="string"&&this.target!="_self"))return!0;let d={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(h,d),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let i=this.href===null?null:t0(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){let o=this.renderer,s=this.el.nativeElement;i!==null?o.setAttribute(s,t,i):o.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:Po(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(i){return new(i||n)(ne(Ke),ne(Lr),jd("tabindex"),ne(Co),ne(yo),ne(lr))}}static{this.\u0275dir=Qt({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,o){i&1&&ie("click",function(l){return o.onClick(l.button,l.ctrlKey,l.shiftKey,l.altKey,l.metaKey)}),i&2&&tr("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Eo],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Eo],replaceUrl:[2,"replaceUrl","replaceUrl",Eo],routerLink:"routerLink"},standalone:!0,features:[Zd,ui]})}}return n})();var $u=class{};var zS=(()=>{class n{constructor(t,i,o,s,l){this.router=t,this.injector=o,this.preloadingStrategy=s,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(go(t=>t instanceof Ii),bs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){let o=[];for(let s of i){s.providers&&!s._injector&&(s._injector=Qd(s.providers,t,`Route: ${s.path}`));let l=s._injector??t,h=s._loadedInjector??l;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(l,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(h,s.children??s._loadedRoutes))}return un(o).pipe(Fd())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let o;i.loadChildren&&i.canLoad===void 0?o=this.loader.loadChildren(t,i):o=Te(null);let s=o.pipe(Dn(l=>l===null?Te(void 0):(i._loadedRoutes=l.routes,i._loadedInjector=l.injector,this.processRoutes(l.injector??t,l.routes))));if(i.loadComponent&&!i._loadedComponent){let l=this.loader.loadComponent(i);return un([s,l]).pipe(Fd())}else return s})}static{this.\u0275fac=function(i){return new(i||n)(xe(Ke),xe(lu),xe(Wa),xe($u),xe(rp))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ey=new tt(""),US=(()=>{class n{constructor(t,i,o,s,l={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=o,this.zone=s,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration||="disabled",l.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Os?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ii?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Or&&t.code===Ou.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Fu&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Fu(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(i){n0()}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})();function ty(n,...e){return Ka([{provide:_l,multi:!0,useValue:n},[],{provide:Lr,useFactory:ny,deps:[Ke]},{provide:Xd,multi:!0,useFactory:iy},e.map(t=>t.\u0275providers)])}function ny(n){return n.routerState.root}function Sl(n,e){return{\u0275kind:n,\u0275providers:e}}function iy(){let n=ue(vo);return e=>{let t=n.get(Jd);if(e!==t.components[0])return;let i=n.get(Ke),o=n.get(ry);n.get(ap)===1&&i.initialNavigation(),n.get(oy,null,zd.Optional)?.setUpPreloading(),n.get(ey,null,zd.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var ry=new tt("",{factory:()=>new Ti}),ap=new tt("",{providedIn:"root",factory:()=>1});function jS(){return Sl(2,[{provide:ap,useValue:0},{provide:Yd,multi:!0,deps:[vo],useFactory:e=>{let t=e.get(H0,Promise.resolve());return()=>t.then(()=>new Promise(i=>{let o=e.get(Ke),s=e.get(ry);Xv(o,()=>{i(!0)}),e.get(sp).afterPreactivation=()=>(i(!0),s.closed?Te(void 0):s),o.initialNavigation()}))}}])}function $S(){return Sl(3,[{provide:Yd,multi:!0,useFactory:()=>{let e=ue(Ke);return()=>{e.setUpLocationChangeListener()}}},{provide:ap,useValue:2}])}var oy=new tt("");function qS(n){return Sl(0,[{provide:oy,useExisting:zS},{provide:$u,useExisting:n}])}function GS(){return Sl(8,[gv,{provide:qu,useExisting:gv}])}function HS(n){let e=[{provide:Zv,useValue:IS},{provide:Qv,useValue:J({skipNextTransition:!!n?.skipInitialTransition},n)}];return Sl(9,e)}var wv=new tt("ROUTER_FORROOT_GUARD"),KS=[Ps,{provide:yl,useClass:ks},Ke,Cl,{provide:Lr,useFactory:ny,deps:[Ke]},rp,[]],sy=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[KS,[],{provide:_l,multi:!0,useValue:t},{provide:wv,useFactory:YS,deps:[[Ke,new Mr,new Q_]]},{provide:El,useValue:i||{}},i?.useHash?ZS():QS(),WS(),i?.preloadingStrategy?qS(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?XS(i):[],i?.bindToComponentInputs?GS().\u0275providers:[],i?.enableViewTransitions?HS().\u0275providers:[],JS()]}}static forChild(t){return{ngModule:n,providers:[{provide:_l,multi:!0,useValue:t}]}}static{this.\u0275fac=function(i){return new(i||n)(xe(wv,8))}}static{this.\u0275mod=Xi({type:n})}static{this.\u0275inj=Yi({})}}return n})();function WS(){return{provide:ey,useFactory:()=>{let n=ue(iv),e=ue(In),t=ue(El),i=ue(sp),o=ue(yl);return t.scrollOffset&&n.setOffset(t.scrollOffset),new US(o,i,n,e,t)}}}function ZS(){return{provide:lr,useClass:W0}}function QS(){return{provide:lr,useClass:mf}}function YS(n){return"guarded"}function XS(n){return[n.initialNavigation==="disabled"?$S().\u0275providers:[],n.initialNavigation==="enabledBlocking"?jS().\u0275providers:[]]}var Cv=new tt("");function JS(){return[{provide:Cv,useFactory:iy},{provide:Xd,multi:!0,useExisting:Cv}]}var ke=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(ke||{}),xi="*";function lp(n,e){return{type:ke.Trigger,name:n,definitions:e,options:{}}}function Pl(n,e=null){return{type:ke.Animate,styles:e,timings:n}}function ay(n,e=null){return{type:ke.Sequence,steps:n,options:e}}function Mi(n){return{type:ke.Style,styles:n,offset:null}}function Dl(n,e,t=null){return{type:ke.Transition,expr:n,animation:e,options:t}}var Vr=class{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}},Tl=class{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,o=0,s=this.players.length;s==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++t==s&&this._onFinish()}),l.onDestroy(()=>{++i==s&&this._onDestroy()}),l.onStart(()=>{++o==s&&this._onStart()})}),this.totalTime=this.players.reduce((l,h)=>Math.max(l,h.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let t=e*this.totalTime;this.players.forEach(i=>{let o=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(o)})}getPosition(){let e=this.players.reduce((t,i)=>t===null||i.totalTime>t.totalTime?i:t,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}},Hu="!";function ly(n){return new _e(3e3,!1)}function eT(){return new _e(3100,!1)}function tT(){return new _e(3101,!1)}function nT(n){return new _e(3001,!1)}function iT(n){return new _e(3003,!1)}function rT(n){return new _e(3004,!1)}function oT(n,e){return new _e(3005,!1)}function sT(){return new _e(3006,!1)}function aT(){return new _e(3007,!1)}function lT(n,e){return new _e(3008,!1)}function cT(n){return new _e(3002,!1)}function uT(n,e,t,i,o){return new _e(3010,!1)}function hT(){return new _e(3011,!1)}function dT(){return new _e(3012,!1)}function fT(){return new _e(3200,!1)}function pT(){return new _e(3202,!1)}function mT(){return new _e(3013,!1)}function gT(n){return new _e(3014,!1)}function _T(n){return new _e(3015,!1)}function vT(n){return new _e(3016,!1)}function yT(n,e){return new _e(3404,!1)}function wT(n){return new _e(3502,!1)}function CT(n){return new _e(3503,!1)}function bT(){return new _e(3300,!1)}function ET(n){return new _e(3504,!1)}function ST(n){return new _e(3301,!1)}function TT(n,e){return new _e(3302,!1)}function PT(n){return new _e(3303,!1)}function DT(n,e){return new _e(3400,!1)}function IT(n){return new _e(3401,!1)}function AT(n){return new _e(3402,!1)}function xT(n,e){return new _e(3505,!1)}function Nr(n){switch(n.length){case 0:return new Vr;case 1:return n[0];default:return new Tl(n)}}function by(n,e,t=new Map,i=new Map){let o=[],s=[],l=-1,h=null;if(e.forEach(d=>{let m=d.get("offset"),v=m==l,w=v&&h||new Map;d.forEach((S,A)=>{let F=A,j=S;if(A!=="offset")switch(F=n.normalizePropertyName(F,o),j){case Hu:j=t.get(A);break;case xi:j=i.get(A);break;default:j=n.normalizeStyleValue(A,F,j,o);break}w.set(F,j)}),v||s.push(w),h=w,l=m}),o.length)throw wT(o);return s}function Mp(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&cp(t,"start",n)));break;case"done":n.onDone(()=>i(t&&cp(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&cp(t,"destroy",n)));break}}function cp(n,e,t){let i=t.totalTime,o=!!t.disabled,s=Rp(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,i??n.totalTime,o),l=n._data;return l!=null&&(s._data=l),s}function Rp(n,e,t,i,o="",s=0,l){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:o,totalTime:s,disabled:!!l}}function Nn(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function cy(n){let e=n.indexOf(":"),t=n.substring(1,e),i=n.slice(e+1);return[t,i]}var MT=typeof document>"u"?null:document.documentElement;function kp(n){let e=n.parentNode||n.host||null;return e===MT?null:e}function RT(n){return n.substring(1,6)=="ebkit"}var Do=null,uy=!1;function kT(n){Do||(Do=OT()||{},uy=Do.style?"WebkitAppearance"in Do.style:!1);let e=!0;return Do.style&&!RT(n)&&(e=n in Do.style,!e&&uy&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Do.style)),e}function OT(){return typeof document<"u"?document.body:null}function Ey(n,e){for(;e;){if(e===n)return!0;e=kp(e)}return!1}function Sy(n,e,t){if(t)return Array.from(n.querySelectorAll(e));let i=n.querySelector(e);return i?[i]:[]}var Op=(()=>{class n{validateStyleProperty(t){return kT(t)}containsElement(t,i){return Ey(t,i)}getParentElement(t){return kp(t)}query(t,i,o){return Sy(t,i,o)}computeStyle(t,i,o){return o||""}animate(t,i,o,s,l,h=[],d){return new Vr(o,s)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})(),xo=class{static{this.NOOP=new Op}},Mo=class{};var LT=1e3,Ty="{{",FT="}}",Py="ng-enter",mp="ng-leave",Ku="ng-trigger",Xu=".ng-trigger",hy="ng-animating",gp=".ng-animating";function hr(n){if(typeof n=="number")return n;let e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:_p(parseFloat(e[1]),e[2])}function _p(n,e){switch(e){case"s":return n*LT;default:return n}}function Ju(n,e,t){return n.hasOwnProperty("duration")?n:VT(n,e,t)}function VT(n,e,t){let i=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,o,s=0,l="";if(typeof n=="string"){let h=n.match(i);if(h===null)return e.push(ly(n)),{duration:0,delay:0,easing:""};o=_p(parseFloat(h[1]),h[2]);let d=h[3];d!=null&&(s=_p(parseFloat(d),h[4]));let m=h[5];m&&(l=m)}else o=n;if(!t){let h=!1,d=e.length;o<0&&(e.push(eT()),h=!0),s<0&&(e.push(tT()),h=!0),h&&e.splice(d,0,ly(n))}return{duration:o,delay:s,easing:l}}function NT(n){return n.length?n[0]instanceof Map?n:n.map(e=>new Map(Object.entries(e))):[]}function Ri(n,e,t){e.forEach((i,o)=>{let s=Lp(o);t&&!t.has(o)&&t.set(o,n.style[s]),n.style[s]=i})}function Ao(n,e){e.forEach((t,i)=>{let o=Lp(i);n.style[o]=""})}function Il(n){return Array.isArray(n)?n.length==1?n[0]:ay(n):n}function BT(n,e,t){let i=e.params||{},o=Dy(n);o.length&&o.forEach(s=>{i.hasOwnProperty(s)||t.push(nT(s))})}var vp=new RegExp(`${Ty}\\s*(.+?)\\s*${FT}`,"g");function Dy(n){let e=[];if(typeof n=="string"){let t;for(;t=vp.exec(n);)e.push(t[1]);vp.lastIndex=0}return e}function xl(n,e,t){let i=`${n}`,o=i.replace(vp,(s,l)=>{let h=e[l];return h==null&&(t.push(iT(l)),h=""),h.toString()});return o==i?n:o}var zT=/-+([a-z0-9])/g;function Lp(n){return n.replace(zT,(...e)=>e[1].toUpperCase())}function UT(n,e){return n===0||e===0}function jT(n,e,t){if(t.size&&e.length){let i=e[0],o=[];if(t.forEach((s,l)=>{i.has(l)||o.push(l),i.set(l,s)}),o.length)for(let s=1;s<e.length;s++){let l=e[s];o.forEach(h=>l.set(h,Fp(n,h)))}}return e}function Vn(n,e,t){switch(e.type){case ke.Trigger:return n.visitTrigger(e,t);case ke.State:return n.visitState(e,t);case ke.Transition:return n.visitTransition(e,t);case ke.Sequence:return n.visitSequence(e,t);case ke.Group:return n.visitGroup(e,t);case ke.Animate:return n.visitAnimate(e,t);case ke.Keyframes:return n.visitKeyframes(e,t);case ke.Style:return n.visitStyle(e,t);case ke.Reference:return n.visitReference(e,t);case ke.AnimateChild:return n.visitAnimateChild(e,t);case ke.AnimateRef:return n.visitAnimateRef(e,t);case ke.Query:return n.visitQuery(e,t);case ke.Stagger:return n.visitStagger(e,t);default:throw rT(e.type)}}function Fp(n,e){return window.getComputedStyle(n)[e]}var $T=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),eh=class extends Mo{normalizePropertyName(e,t){return Lp(e)}normalizeStyleValue(e,t,i,o){let s="",l=i.toString().trim();if($T.has(t)&&i!==0&&i!=="0")if(typeof i=="number")s="px";else{let h=i.match(/^[+-]?[\d\.]+([a-z]*)$/);h&&h[1].length==0&&o.push(oT(e,i))}return l+s}};var th="*";function qT(n,e){let t=[];return typeof n=="string"?n.split(/\s*,\s*/).forEach(i=>GT(i,t,e)):t.push(n),t}function GT(n,e,t){if(n[0]==":"){let d=HT(n,t);if(typeof d=="function"){e.push(d);return}n=d}let i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(i==null||i.length<4)return t.push(_T(n)),e;let o=i[1],s=i[2],l=i[3];e.push(dy(o,l));let h=o==th&&l==th;s[0]=="<"&&!h&&e.push(dy(l,o))}function HT(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(vT(n)),"* => *"}}var Wu=new Set(["true","1"]),Zu=new Set(["false","0"]);function dy(n,e){let t=Wu.has(n)||Zu.has(n),i=Wu.has(e)||Zu.has(e);return(o,s)=>{let l=n==th||n==o,h=e==th||e==s;return!l&&t&&typeof o=="boolean"&&(l=o?Wu.has(n):Zu.has(n)),!h&&i&&typeof s=="boolean"&&(h=s?Wu.has(e):Zu.has(e)),l&&h}}var Iy=":self",KT=new RegExp(`s*${Iy}s*,?`,"g");function Ay(n,e,t,i){return new yp(n).build(e,t,i)}var fy="",yp=class{constructor(e){this._driver=e}build(e,t,i){let o=new wp(t);return this._resetContextStyleTimingState(o),Vn(this,Il(e),o)}_resetContextStyleTimingState(e){e.currentQuerySelector=fy,e.collectedStyles=new Map,e.collectedStyles.set(fy,new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,o=t.depCount=0,s=[],l=[];return e.name.charAt(0)=="@"&&t.errors.push(sT()),e.definitions.forEach(h=>{if(this._resetContextStyleTimingState(t),h.type==ke.State){let d=h,m=d.name;m.toString().split(/\s*,\s*/).forEach(v=>{d.name=v,s.push(this.visitState(d,t))}),d.name=m}else if(h.type==ke.Transition){let d=this.visitTransition(h,t);i+=d.queryCount,o+=d.depCount,l.push(d)}else t.errors.push(aT())}),{type:ke.Trigger,name:e.name,states:s,transitions:l,queryCount:i,depCount:o,options:null}}visitState(e,t){let i=this.visitStyle(e.styles,t),o=e.options&&e.options.params||null;if(i.containsDynamicStyles){let s=new Set,l=o||{};i.styles.forEach(h=>{h instanceof Map&&h.forEach(d=>{Dy(d).forEach(m=>{l.hasOwnProperty(m)||s.add(m)})})}),s.size&&t.errors.push(lT(e.name,[...s.values()]))}return{type:ke.State,name:e.name,style:i,options:o?{params:o}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let i=Vn(this,Il(e.animation),t),o=qT(e.expr,t.errors);return{type:ke.Transition,matchers:o,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Io(e.options)}}visitSequence(e,t){return{type:ke.Sequence,steps:e.steps.map(i=>Vn(this,i,t)),options:Io(e.options)}}visitGroup(e,t){let i=t.currentTime,o=0,s=e.steps.map(l=>{t.currentTime=i;let h=Vn(this,l,t);return o=Math.max(o,t.currentTime),h});return t.currentTime=o,{type:ke.Group,steps:s,options:Io(e.options)}}visitAnimate(e,t){let i=YT(e.timings,t.errors);t.currentAnimateTimings=i;let o,s=e.styles?e.styles:Mi({});if(s.type==ke.Keyframes)o=this.visitKeyframes(s,t);else{let l=e.styles,h=!1;if(!l){h=!0;let m={};i.easing&&(m.easing=i.easing),l=Mi(m)}t.currentTime+=i.duration+i.delay;let d=this.visitStyle(l,t);d.isEmptyStep=h,o=d}return t.currentAnimateTimings=null,{type:ke.Animate,timings:i,style:o,options:null}}visitStyle(e,t){let i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){let i=[],o=Array.isArray(e.styles)?e.styles:[e.styles];for(let h of o)typeof h=="string"?h===xi?i.push(h):t.errors.push(cT(h)):i.push(new Map(Object.entries(h)));let s=!1,l=null;return i.forEach(h=>{if(h instanceof Map&&(h.has("easing")&&(l=h.get("easing"),h.delete("easing")),!s)){for(let d of h.values())if(d.toString().indexOf(Ty)>=0){s=!0;break}}}),{type:ke.Style,styles:i,easing:l,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){let i=t.currentAnimateTimings,o=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(l=>{typeof l!="string"&&l.forEach((h,d)=>{let m=t.collectedStyles.get(t.currentQuerySelector),v=m.get(d),w=!0;v&&(s!=o&&s>=v.startTime&&o<=v.endTime&&(t.errors.push(uT(d,v.startTime,v.endTime,s,o)),w=!1),s=v.startTime),w&&m.set(d,{startTime:s,endTime:o}),t.options&&BT(h,t.options,t.errors)})})}visitKeyframes(e,t){let i={type:ke.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(hT()),i;let o=1,s=0,l=[],h=!1,d=!1,m=0,v=e.steps.map(ee=>{let oe=this._makeStyleAst(ee,t),me=oe.offset!=null?oe.offset:QT(oe.styles),Ce=0;return me!=null&&(s++,Ce=oe.offset=me),d=d||Ce<0||Ce>1,h=h||Ce<m,m=Ce,l.push(Ce),oe});d&&t.errors.push(dT()),h&&t.errors.push(fT());let w=e.steps.length,S=0;s>0&&s<w?t.errors.push(pT()):s==0&&(S=o/(w-1));let A=w-1,F=t.currentTime,j=t.currentAnimateTimings,$=j.duration;return v.forEach((ee,oe)=>{let me=S>0?oe==A?1:S*oe:l[oe],Ce=me*$;t.currentTime=F+j.delay+Ce,j.duration=Ce,this._validateStyleAst(ee,t),ee.offset=me,i.styles.push(ee)}),i}visitReference(e,t){return{type:ke.Reference,animation:Vn(this,Il(e.animation),t),options:Io(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:ke.AnimateChild,options:Io(e.options)}}visitAnimateRef(e,t){return{type:ke.AnimateRef,animation:this.visitReference(e.animation,t),options:Io(e.options)}}visitQuery(e,t){let i=t.currentQuerySelector,o=e.options||{};t.queryCount++,t.currentQuery=e;let[s,l]=WT(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Nn(t.collectedStyles,t.currentQuerySelector,new Map);let h=Vn(this,Il(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:ke.Query,selector:s,limit:o.limit||0,optional:!!o.optional,includeSelf:l,animation:h,originalSelector:e.selector,options:Io(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(mT());let i=e.timings==="full"?{duration:0,delay:0,easing:"full"}:Ju(e.timings,t.errors,!0);return{type:ke.Stagger,animation:Vn(this,Il(e.animation),t),timings:i,options:null}}};function WT(n){let e=!!n.split(/\s*,\s*/).find(t=>t==Iy);return e&&(n=n.replace(KT,"")),n=n.replace(/@\*/g,Xu).replace(/@\w+/g,t=>Xu+"-"+t.slice(1)).replace(/:animating/g,gp),[n,e]}function ZT(n){return n?J({},n):null}var wp=class{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function QT(n){if(typeof n=="string")return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){let i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){let t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function YT(n,e){if(n.hasOwnProperty("duration"))return n;if(typeof n=="number"){let s=Ju(n,e).duration;return up(s,0,"")}let t=n;if(t.split(/\s+/).some(s=>s.charAt(0)=="{"&&s.charAt(1)=="{")){let s=up(0,0,"");return s.dynamic=!0,s.strValue=t,s}let o=Ju(t,e);return up(o.duration,o.delay,o.easing)}function Io(n){return n?(n=J({},n),n.params&&(n.params=ZT(n.params))):n={},n}function up(n,e,t){return{duration:n,delay:e,easing:t}}function Vp(n,e,t,i,o,s,l=null,h=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:o,delay:s,totalTime:o+s,easing:l,subTimeline:h}}var Ml=class{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},XT=1,JT=":enter",eP=new RegExp(JT,"g"),tP=":leave",nP=new RegExp(tP,"g");function xy(n,e,t,i,o,s=new Map,l=new Map,h,d,m=[]){return new Cp().buildKeyframes(n,e,t,i,o,s,l,h,d,m)}var Cp=class{buildKeyframes(e,t,i,o,s,l,h,d,m,v=[]){m=m||new Ml;let w=new bp(e,t,m,o,s,v,[]);w.options=d;let S=d.delay?hr(d.delay):0;w.currentTimeline.delayNextStep(S),w.currentTimeline.setStyles([l],null,w.errors,d),Vn(this,i,w);let A=w.timelines.filter(F=>F.containsAnimation());if(A.length&&h.size){let F;for(let j=A.length-1;j>=0;j--){let $=A[j];if($.element===t){F=$;break}}F&&!F.allowOnlyTimelineStyles()&&F.setStyles([h],null,w.errors,d)}return A.length?A.map(F=>F.buildKeyframes()):[Vp(t,[],[],[],0,S,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let i=t.subInstructions.get(t.element);if(i){let o=t.createSubContext(e.options),s=t.currentTimeline.currentTime,l=this._visitSubInstructions(i,o,o.options);s!=l&&t.transformIntoNewTimeline(l)}t.previousNode=e}visitAnimateRef(e,t){let i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(let o of e){let s=o?.delay;if(s){let l=typeof s=="number"?s:hr(xl(s,o?.params??{},t.errors));i.delayNextStep(l)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime,l=i.duration!=null?hr(i.duration):null,h=i.delay!=null?hr(i.delay):null;return l!==0&&e.forEach(d=>{let m=t.appendInstructionToTimeline(d,l,h);s=Math.max(s,m.duration+m.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Vn(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let i=t.subContextCount,o=t,s=e.options;if(s&&(s.params||s.delay)&&(o=t.createSubContext(s),o.transformIntoNewTimeline(),s.delay!=null)){o.previousNode.type==ke.Style&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=nh);let l=hr(s.delay);o.delayNextStep(l)}e.steps.length&&(e.steps.forEach(l=>Vn(this,l,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>i&&o.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let i=[],o=t.currentTimeline.currentTime,s=e.options&&e.options.delay?hr(e.options.delay):0;e.steps.forEach(l=>{let h=t.createSubContext(e.options);s&&h.delayNextStep(s),Vn(this,l,h),o=Math.max(o,h.currentTimeline.currentTime),i.push(h.currentTimeline)}),i.forEach(l=>t.currentTimeline.mergeTimelineCollectedStyles(l)),t.transformIntoNewTimeline(o),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let i=e.strValue,o=t.params?xl(i,t.params,t.errors):i;return Ju(o,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let i=t.currentAnimateTimings=this._visitTiming(e.timings,t),o=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),o.snapshotCurrentStyles());let s=e.style;s.type==ke.Keyframes?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),o.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let i=t.currentTimeline,o=t.currentAnimateTimings;!o&&i.hasCurrentStyleProperties()&&i.forwardFrame();let s=o&&o.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let i=t.currentAnimateTimings,o=t.currentTimeline.duration,s=i.duration,h=t.createSubContext().currentTimeline;h.easing=i.easing,e.styles.forEach(d=>{let m=d.offset||0;h.forwardTime(m*s),h.setStyles(d.styles,d.easing,t.errors,t.options),h.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(h),t.transformIntoNewTimeline(o+s),t.previousNode=e}visitQuery(e,t){let i=t.currentTimeline.currentTime,o=e.options||{},s=o.delay?hr(o.delay):0;s&&(t.previousNode.type===ke.Style||i==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=nh);let l=i,h=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!o.optional,t.errors);t.currentQueryTotal=h.length;let d=null;h.forEach((m,v)=>{t.currentQueryIndex=v;let w=t.createSubContext(e.options,m);s&&w.delayNextStep(s),m===t.element&&(d=w.currentTimeline),Vn(this,e.animation,w),w.currentTimeline.applyStylesToKeyframe();let S=w.currentTimeline.currentTime;l=Math.max(l,S)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(l),d&&(t.currentTimeline.mergeTimelineCollectedStyles(d),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let i=t.parentContext,o=t.currentTimeline,s=e.timings,l=Math.abs(s.duration),h=l*(t.currentQueryTotal-1),d=l*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":d=h-d;break;case"full":d=i.currentStaggerTime;break}let v=t.currentTimeline;d&&v.delayNextStep(d);let w=v.currentTime;Vn(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=o.currentTime-w+(o.startTime-i.currentTimeline.startTime)}},nh={},bp=class n{constructor(e,t,i,o,s,l,h,d){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=o,this._leaveClassName=s,this.errors=l,this.timelines=h,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=nh,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=d||new ih(this._driver,t,0),h.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let i=e,o=this.options;i.duration!=null&&(o.duration=hr(i.duration)),i.delay!=null&&(o.delay=hr(i.delay));let s=i.params;if(s){let l=o.params;l||(l=this.options.params={}),Object.keys(s).forEach(h=>{(!t||!l.hasOwnProperty(h))&&(l[h]=xl(s[h],l,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let i=e.params={};Object.keys(t).forEach(o=>{i[o]=t[o]})}}return e}createSubContext(e=null,t,i){let o=t||this.element,s=new n(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=nh,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){let o={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new Ep(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,o,e.stretchStartingKeyframe);return this.timelines.push(s),o}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,o,s,l){let h=[];if(o&&h.push(this.element),e.length>0){e=e.replace(eP,"."+this._enterClassName),e=e.replace(nP,"."+this._leaveClassName);let d=i!=1,m=this._driver.query(this.element,e,d);i!==0&&(m=i<0?m.slice(m.length+i,m.length):m.slice(0,i)),h.push(...m)}return!s&&h.length==0&&l.push(gT(t)),h}},ih=class n{constructor(e,t,i,o){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=o,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new n(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=XT,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||xi),this._currentKeyframe.set(t,xi);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,o){t&&this._previousKeyframe.set("easing",t);let s=o&&o.params||{},l=iP(e,this._globalTimelineStyles);for(let[h,d]of l){let m=xl(d,s,i);this._pendingStyles.set(h,m),this._localTimelineStyles.has(h)||this._backFill.set(h,this._globalTimelineStyles.get(h)??xi),this._updateStyle(h,m)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{let o=this._styleSummary.get(i);(!o||t.time>o.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,i=this._keyframes.size===1&&this.duration===0,o=[];this._keyframes.forEach((h,d)=>{let m=new Map([...this._backFill,...h]);m.forEach((v,w)=>{v===Hu?e.add(w):v===xi&&t.add(w)}),i||m.set("offset",d/this.duration),o.push(m)});let s=[...e.values()],l=[...t.values()];if(i){let h=o[0],d=new Map(h);h.set("offset",0),d.set("offset",1),o=[h,d]}return Vp(this.element,o,s,l,this.duration,this.startTime,this.easing,!1)}},Ep=class extends ih{constructor(e,t,i,o,s,l,h=!1){super(e,t,l.delay),this.keyframes=i,this.preStyleProps=o,this.postStyleProps=s,this._stretchStartingKeyframe=h,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:o}=this.timings;if(this._stretchStartingKeyframe&&t){let s=[],l=i+t,h=t/l,d=new Map(e[0]);d.set("offset",0),s.push(d);let m=new Map(e[0]);m.set("offset",py(h)),s.push(m);let v=e.length-1;for(let w=1;w<=v;w++){let S=new Map(e[w]),A=S.get("offset"),F=t+A*i;S.set("offset",py(F/l)),s.push(S)}i=l,t=0,o="",e=s}return Vp(this.element,e,this.preStyleProps,this.postStyleProps,i,t,o,!0)}};function py(n,e=3){let t=Math.pow(10,e-1);return Math.round(n*t)/t}function iP(n,e){let t=new Map,i;return n.forEach(o=>{if(o==="*"){i??=e.keys();for(let s of i)t.set(s,xi)}else for(let[s,l]of o)t.set(s,l)}),t}function my(n,e,t,i,o,s,l,h,d,m,v,w,S){return{type:0,element:n,triggerName:e,isRemovalTransition:o,fromState:t,fromStyles:s,toState:i,toStyles:l,timelines:h,queriedElements:d,preStyleProps:m,postStyleProps:v,totalTime:w,errors:S}}var hp={},rh=class{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,o){return rP(this.ast.matchers,e,t,i,o)}buildStyles(e,t,i){let o=this._stateStyles.get("*");return e!==void 0&&(o=this._stateStyles.get(e?.toString())||o),o?o.buildStyles(t,i):new Map}build(e,t,i,o,s,l,h,d,m,v){let w=[],S=this.ast.options&&this.ast.options.params||hp,A=h&&h.params||hp,F=this.buildStyles(i,A,w),j=d&&d.params||hp,$=this.buildStyles(o,j,w),ee=new Set,oe=new Map,me=new Map,Ce=o==="void",pt={params:My(j,S),delay:this.ast.options?.delay},Oe=v?[]:xy(e,t,this.ast.animation,s,l,F,$,pt,m,w),M=0;return Oe.forEach(E=>{M=Math.max(E.duration+E.delay,M)}),w.length?my(t,this._triggerName,i,o,Ce,F,$,[],[],oe,me,M,w):(Oe.forEach(E=>{let T=E.element,x=Nn(oe,T,new Set);E.preStyleProps.forEach(k=>x.add(k));let R=Nn(me,T,new Set);E.postStyleProps.forEach(k=>R.add(k)),T!==t&&ee.add(T)}),my(t,this._triggerName,i,o,Ce,F,$,Oe,[...ee.values()],oe,me,M))}};function rP(n,e,t,i,o){return n.some(s=>s(e,t,i,o))}function My(n,e){let t=J({},e);return Object.entries(n).forEach(([i,o])=>{o!=null&&(t[i]=o)}),t}var Sp=class{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){let i=new Map,o=My(e,this.defaultParams);return this.styles.styles.forEach(s=>{typeof s!="string"&&s.forEach((l,h)=>{l&&(l=xl(l,o,t));let d=this.normalizer.normalizePropertyName(h,t);l=this.normalizer.normalizeStyleValue(h,d,l,t),i.set(h,l)})}),i}};function oP(n,e,t){return new Tp(n,e,t)}var Tp=class{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(o=>{let s=o.options&&o.options.params||{};this.states.set(o.name,new Sp(o.style,s,i))}),gy(this.states,"true","1"),gy(this.states,"false","0"),t.transitions.forEach(o=>{this.transitionFactories.push(new rh(e,o,this.states))}),this.fallbackTransition=sP(e,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,o){return this.transitionFactories.find(l=>l.match(e,t,i,o))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}};function sP(n,e,t){let i=[(l,h)=>!0],o={type:ke.Sequence,steps:[],options:null},s={type:ke.Transition,animation:o,matchers:i,options:null,queryCount:0,depCount:0};return new rh(n,s,e)}function gy(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}var aP=new Ml,Pp=class{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){let i=[],o=[],s=Ay(this._driver,t,i,o);if(i.length)throw CT(i);o.length&&void 0,this._animations.set(e,s)}_buildPlayer(e,t,i){let o=e.element,s=by(this._normalizer,e.keyframes,t,i);return this._driver.animate(o,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){let o=[],s=this._animations.get(e),l,h=new Map;if(s?(l=xy(this._driver,t,s,Py,mp,new Map,new Map,i,aP,o),l.forEach(v=>{let w=Nn(h,v.element,new Map);v.postStyleProps.forEach(S=>w.set(S,null))})):(o.push(bT()),l=[]),o.length)throw ET(o);h.forEach((v,w)=>{v.forEach((S,A)=>{v.set(A,this._driver.computeStyle(w,A,xi))})});let d=l.map(v=>{let w=h.get(v.element);return this._buildPlayer(v,new Map,w)}),m=Nr(d);return this._playersById.set(e,m),m.onDestroy(()=>this.destroy(e)),this.players.push(m),m}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw ST(e);return t}listen(e,t,i,o){let s=Rp(t,"","","");return Mp(this._getPlayer(e),i,s,o),()=>{}}command(e,t,i,o){if(i=="register"){this.register(e,o[0]);return}if(i=="create"){let l=o[0]||{};this.create(e,t,l);return}let s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(e);break}}},_y="ng-animate-queued",lP=".ng-animate-queued",dp="ng-animate-disabled",cP=".ng-animate-disabled",uP="ng-star-inserted",hP=".ng-star-inserted",dP=[],Ry={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},fP={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},fi="__ng_removed",Rl=class{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let i=e&&e.hasOwnProperty("value"),o=i?e.value:e;if(this.value=mP(o),i){let s=e,{value:l}=s,h=L_(s,["value"]);this.options=h}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let i=this.options.params;Object.keys(t).forEach(o=>{i[o]==null&&(i[o]=t[o])})}}},Al="void",fp=new Rl(Al),Dp=class{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ei(t,this._hostClassName)}listen(e,t,i,o){if(!this._triggers.has(t))throw TT(i,t);if(i==null||i.length==0)throw PT(t);if(!gP(i))throw DT(i,t);let s=Nn(this._elementListeners,e,[]),l={name:t,phase:i,callback:o};s.push(l);let h=Nn(this._engine.statesByElement,e,new Map);return h.has(t)||(ei(e,Ku),ei(e,Ku+"-"+t),h.set(t,fp)),()=>{this._engine.afterFlush(()=>{let d=s.indexOf(l);d>=0&&s.splice(d,1),this._triggers.has(t)||h.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw IT(e);return t}trigger(e,t,i,o=!0){let s=this._getTrigger(t),l=new kl(this.id,t,e),h=this._engine.statesByElement.get(e);h||(ei(e,Ku),ei(e,Ku+"-"+t),this._engine.statesByElement.set(e,h=new Map));let d=h.get(t),m=new Rl(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&d&&m.absorbOptions(d.options),h.set(t,m),d||(d=fp),!(m.value===Al)&&d.value===m.value){if(!yP(d.params,m.params)){let j=[],$=s.matchStyles(d.value,d.params,j),ee=s.matchStyles(m.value,m.params,j);j.length?this._engine.reportError(j):this._engine.afterFlush(()=>{Ao(e,$),Ri(e,ee)})}return}let S=Nn(this._engine.playersByElement,e,[]);S.forEach(j=>{j.namespaceId==this.id&&j.triggerName==t&&j.queued&&j.destroy()});let A=s.matchTransition(d.value,m.value,e,m.params),F=!1;if(!A){if(!o)return;A=s.fallbackTransition,F=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:A,fromState:d,toState:m,player:l,isFallbackTransition:F}),F||(ei(e,_y),l.onStart(()=>{Ns(e,_y)})),l.onDone(()=>{let j=this.players.indexOf(l);j>=0&&this.players.splice(j,1);let $=this._engine.playersByElement.get(e);if($){let ee=$.indexOf(l);ee>=0&&$.splice(ee,1)}}),this.players.push(l),S.push(l),l}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(o=>o.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let i=this._engine.driver.query(e,Xu,!0);i.forEach(o=>{if(o[fi])return;let s=this._engine.fetchNamespacesByElement(o);s.size?s.forEach(l=>l.triggerLeaveAnimation(o,t,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(e,t,i,o){let s=this._engine.statesByElement.get(e),l=new Map;if(s){let h=[];if(s.forEach((d,m)=>{if(l.set(m,d.value),this._triggers.has(m)){let v=this.trigger(e,m,Al,o);v&&h.push(v)}}),h.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,l),i&&Nr(h).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){let o=new Set;t.forEach(s=>{let l=s.name;if(o.has(l))return;o.add(l);let d=this._triggers.get(l).fallbackTransition,m=i.get(l)||fp,v=new Rl(Al),w=new kl(this.id,l,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:l,transition:d,fromState:m,toState:v,player:w,isFallbackTransition:!0})})}}removeNode(e,t){let i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let o=!1;if(i.totalAnimations){let s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)o=!0;else{let l=e;for(;l=l.parentNode;)if(i.statesByElement.get(l)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(e),o)i.markElementAsRemoved(this.id,e,!1,t);else{let s=e[fi];(!s||s===Ry)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){ei(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(i=>{let o=i.player;if(o.destroyed)return;let s=i.element,l=this._elementListeners.get(s);l&&l.forEach(h=>{if(h.name==i.triggerName){let d=Rp(s,i.triggerName,i.fromState.value,i.toState.value);d._data=e,Mp(i.player,h.phase,d,h.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):t.push(i)}),this._queue=[],t.sort((i,o)=>{let s=i.transition.ast.depCount,l=o.transition.ast.depCount;return s==0||l==0?s-l:this._engine.driver.containsElement(i.element,o.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},Ip=class{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){let i=new Dp(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){let i=this._namespaceList,o=this.namespacesByHostElement;if(i.length-1>=0){let l=!1,h=this.driver.getParentElement(t);for(;h;){let d=o.get(h);if(d){let m=i.indexOf(d);i.splice(m+1,0,e),l=!0;break}h=this.driver.getParentElement(h)}l||i.unshift(e)}else i.push(e);return o.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let o=this._namespaceLookup[e];o&&o.register(t,i)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let i=this._fetchNamespace(e);this.namespacesByHostElement.delete(i.hostElement);let o=this._namespaceList.indexOf(i);o>=0&&this._namespaceList.splice(o,1),i.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,i=this.statesByElement.get(e);if(i){for(let o of i.values())if(o.namespaceId){let s=this._fetchNamespace(o.namespaceId);s&&t.add(s)}}return t}trigger(e,t,i,o){if(Qu(t)){let s=this._fetchNamespace(e);if(s)return s.trigger(t,i,o),!0}return!1}insertNode(e,t,i,o){if(!Qu(t))return;let s=t[fi];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;let l=this.collectedLeaveElements.indexOf(t);l>=0&&this.collectedLeaveElements.splice(l,1)}if(e){let l=this._fetchNamespace(e);l&&l.insertNode(t,i)}o&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ei(e,dp)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Ns(e,dp))}removeNode(e,t,i){if(Qu(t)){let o=e?this._fetchNamespace(e):null;o?o.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i);let s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,i,o,s){this.collectedLeaveElements.push(t),t[fi]={namespaceId:e,setForRemoval:o,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,o,s){return Qu(t)?this._fetchNamespace(e).listen(t,i,o,s):()=>{}}_buildInstruction(e,t,i,o,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,o,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Xu,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,gp,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Nr(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[fi];if(t&&t.setForRemoval){if(e[fi]=Ry,t.namespaceId){this.destroyInnerAnimations(e);let i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(dp)&&this.markElementAsDisabled(e,!1),this.driver.query(e,cP,!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,o)=>this._balanceNamespaceList(i,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++){let o=this.collectedEnterElements[i];ei(o,uP)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let i=[];try{t=this._flushAnimations(i,e)}finally{for(let o=0;o<i.length;o++)i[o]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++){let o=this.collectedLeaveElements[i];this.processLeaveNode(o)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){let i=this._whenQuietFns;this._whenQuietFns=[],t.length?Nr(t).onDone(()=>{i.forEach(o=>o())}):i.forEach(o=>o())}}reportError(e){throw AT(e)}_flushAnimations(e,t){let i=new Ml,o=[],s=new Map,l=[],h=new Map,d=new Map,m=new Map,v=new Set;this.disabledNodes.forEach(H=>{v.add(H);let se=this.driver.query(H,lP,!0);for(let W=0;W<se.length;W++)v.add(se[W])});let w=this.bodyNode,S=Array.from(this.statesByElement.keys()),A=wy(S,this.collectedEnterElements),F=new Map,j=0;A.forEach((H,se)=>{let W=Py+j++;F.set(se,W),H.forEach(ce=>ei(ce,W))});let $=[],ee=new Set,oe=new Set;for(let H=0;H<this.collectedLeaveElements.length;H++){let se=this.collectedLeaveElements[H],W=se[fi];W&&W.setForRemoval&&($.push(se),ee.add(se),W.hasAnimation?this.driver.query(se,hP,!0).forEach(ce=>ee.add(ce)):oe.add(se))}let me=new Map,Ce=wy(S,Array.from(ee));Ce.forEach((H,se)=>{let W=mp+j++;me.set(se,W),H.forEach(ce=>ei(ce,W))}),e.push(()=>{A.forEach((H,se)=>{let W=F.get(se);H.forEach(ce=>Ns(ce,W))}),Ce.forEach((H,se)=>{let W=me.get(se);H.forEach(ce=>Ns(ce,W))}),$.forEach(H=>{this.processLeaveNode(H)})});let pt=[],Oe=[];for(let H=this._namespaceList.length-1;H>=0;H--)this._namespaceList[H].drainQueuedTransitions(t).forEach(W=>{let ce=W.player,Ne=W.element;if(pt.push(ce),this.collectedEnterElements.length){let mt=Ne[fi];if(mt&&mt.setForMove){if(mt.previousTriggersValues&&mt.previousTriggersValues.has(W.triggerName)){let wn=mt.previousTriggersValues.get(W.triggerName),Vt=this.statesByElement.get(W.element);if(Vt&&Vt.has(W.triggerName)){let sn=Vt.get(W.triggerName);sn.value=wn,Vt.set(W.triggerName,sn)}}ce.destroy();return}}let at=!w||!this.driver.containsElement(w,Ne),Ie=me.get(Ne),ge=F.get(Ne),de=this._buildInstruction(W,i,ge,Ie,at);if(de.errors&&de.errors.length){Oe.push(de);return}if(at){ce.onStart(()=>Ao(Ne,de.fromStyles)),ce.onDestroy(()=>Ri(Ne,de.toStyles)),o.push(ce);return}if(W.isFallbackTransition){ce.onStart(()=>Ao(Ne,de.fromStyles)),ce.onDestroy(()=>Ri(Ne,de.toStyles)),o.push(ce);return}let Ft=[];de.timelines.forEach(mt=>{mt.stretchStartingKeyframe=!0,this.disabledNodes.has(mt.element)||Ft.push(mt)}),de.timelines=Ft,i.append(Ne,de.timelines);let jn={instruction:de,player:ce,element:Ne};l.push(jn),de.queriedElements.forEach(mt=>Nn(h,mt,[]).push(ce)),de.preStyleProps.forEach((mt,wn)=>{if(mt.size){let Vt=d.get(wn);Vt||d.set(wn,Vt=new Set),mt.forEach((sn,$n)=>Vt.add($n))}}),de.postStyleProps.forEach((mt,wn)=>{let Vt=m.get(wn);Vt||m.set(wn,Vt=new Set),mt.forEach((sn,$n)=>Vt.add($n))})});if(Oe.length){let H=[];Oe.forEach(se=>{H.push(xT(se.triggerName,se.errors))}),pt.forEach(se=>se.destroy()),this.reportError(H)}let M=new Map,E=new Map;l.forEach(H=>{let se=H.element;i.has(se)&&(E.set(se,se),this._beforeAnimationBuild(H.player.namespaceId,H.instruction,M))}),o.forEach(H=>{let se=H.element;this._getPreviousPlayers(se,!1,H.namespaceId,H.triggerName,null).forEach(ce=>{Nn(M,se,[]).push(ce),ce.destroy()})});let T=$.filter(H=>Cy(H,d,m)),x=new Map;yy(x,this.driver,oe,m,xi).forEach(H=>{Cy(H,d,m)&&T.push(H)});let k=new Map;A.forEach((H,se)=>{yy(k,this.driver,new Set(H),d,Hu)}),T.forEach(H=>{let se=x.get(H),W=k.get(H);x.set(H,new Map([...se?.entries()??[],...W?.entries()??[]]))});let I=[],ut=[],pn={};l.forEach(H=>{let{element:se,player:W,instruction:ce}=H;if(i.has(se)){if(v.has(se)){W.onDestroy(()=>Ri(se,ce.toStyles)),W.disabled=!0,W.overrideTotalTime(ce.totalTime),o.push(W);return}let Ne=pn;if(E.size>1){let Ie=se,ge=[];for(;Ie=Ie.parentNode;){let de=E.get(Ie);if(de){Ne=de;break}ge.push(Ie)}ge.forEach(de=>E.set(de,Ne))}let at=this._buildAnimation(W.namespaceId,ce,M,s,k,x);if(W.setRealPlayer(at),Ne===pn)I.push(W);else{let Ie=this.playersByElement.get(Ne);Ie&&Ie.length&&(W.parentPlayer=Nr(Ie)),o.push(W)}}else Ao(se,ce.fromStyles),W.onDestroy(()=>Ri(se,ce.toStyles)),ut.push(W),v.has(se)&&o.push(W)}),ut.forEach(H=>{let se=s.get(H.element);if(se&&se.length){let W=Nr(se);H.setRealPlayer(W)}}),o.forEach(H=>{H.parentPlayer?H.syncPlayerEvents(H.parentPlayer):H.destroy()});for(let H=0;H<$.length;H++){let se=$[H],W=se[fi];if(Ns(se,mp),W&&W.hasAnimation)continue;let ce=[];if(h.size){let at=h.get(se);at&&at.length&&ce.push(...at);let Ie=this.driver.query(se,gp,!0);for(let ge=0;ge<Ie.length;ge++){let de=h.get(Ie[ge]);de&&de.length&&ce.push(...de)}}let Ne=ce.filter(at=>!at.destroyed);Ne.length?_P(this,se,Ne):this.processLeaveNode(se)}return $.length=0,I.forEach(H=>{this.players.push(H),H.onDone(()=>{H.destroy();let se=this.players.indexOf(H);this.players.splice(se,1)}),H.play()}),I}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,o,s){let l=[];if(t){let h=this.playersByQueriedElement.get(e);h&&(l=h)}else{let h=this.playersByElement.get(e);if(h){let d=!s||s==Al;h.forEach(m=>{m.queued||!d&&m.triggerName!=o||l.push(m)})}}return(i||o)&&(l=l.filter(h=>!(i&&i!=h.namespaceId||o&&o!=h.triggerName))),l}_beforeAnimationBuild(e,t,i){let o=t.triggerName,s=t.element,l=t.isRemovalTransition?void 0:e,h=t.isRemovalTransition?void 0:o;for(let d of t.timelines){let m=d.element,v=m!==s,w=Nn(i,m,[]);this._getPreviousPlayers(m,v,l,h,t.toState).forEach(A=>{let F=A.getRealPlayer();F.beforeDestroy&&F.beforeDestroy(),A.destroy(),w.push(A)})}Ao(s,t.fromStyles)}_buildAnimation(e,t,i,o,s,l){let h=t.triggerName,d=t.element,m=[],v=new Set,w=new Set,S=t.timelines.map(F=>{let j=F.element;v.add(j);let $=j[fi];if($&&$.removedBeforeQueried)return new Vr(F.duration,F.delay);let ee=j!==d,oe=vP((i.get(j)||dP).map(M=>M.getRealPlayer())).filter(M=>{let E=M;return E.element?E.element===j:!1}),me=s.get(j),Ce=l.get(j),pt=by(this._normalizer,F.keyframes,me,Ce),Oe=this._buildPlayer(F,pt,oe);if(F.subTimeline&&o&&w.add(j),ee){let M=new kl(e,h,j);M.setRealPlayer(Oe),m.push(M)}return Oe});m.forEach(F=>{Nn(this.playersByQueriedElement,F.element,[]).push(F),F.onDone(()=>pP(this.playersByQueriedElement,F.element,F))}),v.forEach(F=>ei(F,hy));let A=Nr(S);return A.onDestroy(()=>{v.forEach(F=>Ns(F,hy)),Ri(d,t.toStyles)}),w.forEach(F=>{Nn(o,F,[]).push(A)}),A}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Vr(e.duration,e.delay)}},kl=class{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Vr,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(o=>Mp(e,i,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Nn(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function pP(n,e,t){let i=n.get(e);if(i){if(i.length){let o=i.indexOf(t);i.splice(o,1)}i.length==0&&n.delete(e)}return i}function mP(n){return n??null}function Qu(n){return n&&n.nodeType===1}function gP(n){return n=="start"||n=="done"}function vy(n,e){let t=n.style.display;return n.style.display=e??"none",t}function yy(n,e,t,i,o){let s=[];t.forEach(d=>s.push(vy(d)));let l=[];i.forEach((d,m)=>{let v=new Map;d.forEach(w=>{let S=e.computeStyle(m,w,o);v.set(w,S),(!S||S.length==0)&&(m[fi]=fP,l.push(m))}),n.set(m,v)});let h=0;return t.forEach(d=>vy(d,s[h++])),l}function wy(n,e){let t=new Map;if(n.forEach(h=>t.set(h,[])),e.length==0)return t;let i=1,o=new Set(e),s=new Map;function l(h){if(!h)return i;let d=s.get(h);if(d)return d;let m=h.parentNode;return t.has(m)?d=m:o.has(m)?d=i:d=l(m),s.set(h,d),d}return e.forEach(h=>{let d=l(h);d!==i&&t.get(d).push(h)}),t}function ei(n,e){n.classList?.add(e)}function Ns(n,e){n.classList?.remove(e)}function _P(n,e,t){Nr(t).onDone(()=>n.processLeaveNode(e))}function vP(n){let e=[];return ky(n,e),e}function ky(n,e){for(let t=0;t<n.length;t++){let i=n[t];i instanceof Tl?ky(i.players,e):e.push(i)}}function yP(n,e){let t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let o=0;o<t.length;o++){let s=t[o];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}function Cy(n,e,t){let i=t.get(n);if(!i)return!1;let o=e.get(n);return o?i.forEach(s=>o.add(s)):e.set(n,i),t.delete(n),!0}var Bs=class{constructor(e,t,i){this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new Ip(e.body,t,i),this._timelineEngine=new Pp(e.body,t,i),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(e,t,i,o,s){let l=e+"-"+o,h=this._triggerCache[l];if(!h){let d=[],m=[],v=Ay(this._driver,s,d,m);if(d.length)throw yT(o,d);m.length&&void 0,h=oP(o,v,this._normalizer),this._triggerCache[l]=h}this._transitionEngine.registerTrigger(t,o,h)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,o){this._transitionEngine.insertNode(e,t,i,o)}onRemove(e,t,i){this._transitionEngine.removeNode(e,t,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,o){if(i.charAt(0)=="@"){let[s,l]=cy(i),h=o;this._timelineEngine.command(s,t,l,h)}else this._transitionEngine.trigger(e,t,i,o)}listen(e,t,i,o,s){if(i.charAt(0)=="@"){let[l,h]=cy(i);return this._timelineEngine.listen(l,t,h,s)}return this._transitionEngine.listen(e,t,i,o,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function wP(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=pp(e[0]),e.length>1&&(i=pp(e[e.length-1]))):e instanceof Map&&(t=pp(e)),t||i?new Ap(n,t,i):null}var Ap=class n{static{this.initialStylesByElement=new WeakMap}constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let o=n.initialStylesByElement.get(e);o||n.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Ri(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ri(this._element,this._initialStyles),this._endStyles&&(Ri(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Ao(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ao(this._element,this._endStyles),this._endStyles=null),Ri(this._element,this._initialStyles),this._state=3)}};function pp(n){let e=null;return n.forEach((t,i)=>{CP(i)&&(e=e||new Map,e.set(i,t))}),e}function CP(n){return n==="display"||n==="position"}var oh=class{constructor(e,t,i,o){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,o)=>{o!=="offset"&&e.set(o,this._finished?i:Fp(this.element,o))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}},sh=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return Ey(e,t)}getParentElement(e){return kp(e)}query(e,t,i){return Sy(e,t,i)}computeStyle(e,t,i){return Fp(e,t)}animate(e,t,i,o,s,l=[]){let h=o==0?"both":"forwards",d={duration:i,delay:o,fill:h};s&&(d.easing=s);let m=new Map,v=l.filter(A=>A instanceof oh);UT(i,o)&&v.forEach(A=>{A.currentSnapshot.forEach((F,j)=>m.set(j,F))});let w=NT(t).map(A=>new Map(A));w=jT(e,w,m);let S=wP(e,w);return new oh(e,w,d,S)}};var Yu="@",Oy="@.disabled",ah=class{constructor(e,t,i,o){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=o,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,o=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,o)}removeChild(e,t,i){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,o){this.delegate.setAttribute(e,t,i,o)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,o){this.delegate.setStyle(e,t,i,o)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){t.charAt(0)==Yu&&t==Oy?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},xp=class extends ah{constructor(e,t,i,o,s){super(t,i,o,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){t.charAt(0)==Yu?t.charAt(1)=="."&&t==Oy?(i=i===void 0?!0:!!i,this.disableAnimations(e,i)):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if(t.charAt(0)==Yu){let o=bP(e),s=t.slice(1),l="";return s.charAt(0)!=Yu&&([s,l]=EP(s)),this.engine.listen(this.namespaceId,o,s,l,h=>{let d=h._data||-1;this.factory.scheduleListenerCallback(d,i,h)})}return this.delegate.listen(e,t,i)}};function bP(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}function EP(n){let e=n.indexOf("."),t=n.substring(0,e),i=n.slice(e+1);return[t,i]}var lh=class{constructor(e,t,i){this.delegate=e,this.engine=t,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(o,s)=>{s?.removeChild(null,o)}}createRenderer(e,t){let i="",o=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let m=this._rendererCache,v=m.get(o);if(!v){let w=()=>m.delete(o);v=new ah(i,o,this.engine,w),m.set(o,v)}return v}let s=t.id,l=t.id+"-"+this._currentId;this._currentId++,this.engine.register(l,e);let h=m=>{Array.isArray(m)?m.forEach(h):this.engine.registerTrigger(s,l,e,m.name,m)};return t.data.animation.forEach(h),new xp(this,l,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,i){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(i));return}let o=this._animationCallbacksBuffer;o.length==0&&queueMicrotask(()=>{this._zone.run(()=>{o.forEach(s=>{let[l,h]=s;l(h)}),this._animationCallbacksBuffer=[]})}),o.push([t,i])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var TP=(()=>{class n extends Bs{constructor(t,i,o){super(t,i,o)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(i){return new(i||n)(xe(Jt),xe(xo),xe(Mo))}}static{this.\u0275prov=be({token:n,factory:n.\u0275fac})}}return n})();function PP(){return new eh}function DP(n,e,t){return new lh(n,e,t)}var Ly=[{provide:Mo,useFactory:PP},{provide:Bs,useClass:TP},{provide:ou,useFactory:DP,deps:[Tu,Bs,In]}],IP=[{provide:xo,useFactory:()=>new sh},{provide:Gd,useValue:"BrowserAnimations"},...Ly],WM=[{provide:xo,useClass:Op},{provide:Gd,useValue:"NoopAnimations"},...Ly];function Fy(){return Wd("NgEagerAnimations"),[...IP]}var Vy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ny={};var Br,Np;(function(){var n;function e(M,E){function T(){}T.prototype=E.prototype,M.D=E.prototype,M.prototype=new T,M.prototype.constructor=M,M.C=function(x,R,k){for(var I=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)I[ut-2]=arguments[ut];return E.prototype[R].apply(x,I)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(M,E,T){T||(T=0);var x=Array(16);if(typeof E=="string")for(var R=0;16>R;++R)x[R]=E.charCodeAt(T++)|E.charCodeAt(T++)<<8|E.charCodeAt(T++)<<16|E.charCodeAt(T++)<<24;else for(R=0;16>R;++R)x[R]=E[T++]|E[T++]<<8|E[T++]<<16|E[T++]<<24;E=M.g[0],T=M.g[1],R=M.g[2];var k=M.g[3],I=E+(k^T&(R^k))+x[0]+3614090360&4294967295;E=T+(I<<7&4294967295|I>>>25),I=k+(R^E&(T^R))+x[1]+3905402710&4294967295,k=E+(I<<12&4294967295|I>>>20),I=R+(T^k&(E^T))+x[2]+606105819&4294967295,R=k+(I<<17&4294967295|I>>>15),I=T+(E^R&(k^E))+x[3]+3250441966&4294967295,T=R+(I<<22&4294967295|I>>>10),I=E+(k^T&(R^k))+x[4]+4118548399&4294967295,E=T+(I<<7&4294967295|I>>>25),I=k+(R^E&(T^R))+x[5]+1200080426&4294967295,k=E+(I<<12&4294967295|I>>>20),I=R+(T^k&(E^T))+x[6]+2821735955&4294967295,R=k+(I<<17&4294967295|I>>>15),I=T+(E^R&(k^E))+x[7]+4249261313&4294967295,T=R+(I<<22&4294967295|I>>>10),I=E+(k^T&(R^k))+x[8]+1770035416&4294967295,E=T+(I<<7&4294967295|I>>>25),I=k+(R^E&(T^R))+x[9]+2336552879&4294967295,k=E+(I<<12&4294967295|I>>>20),I=R+(T^k&(E^T))+x[10]+4294925233&4294967295,R=k+(I<<17&4294967295|I>>>15),I=T+(E^R&(k^E))+x[11]+2304563134&4294967295,T=R+(I<<22&4294967295|I>>>10),I=E+(k^T&(R^k))+x[12]+1804603682&4294967295,E=T+(I<<7&4294967295|I>>>25),I=k+(R^E&(T^R))+x[13]+4254626195&4294967295,k=E+(I<<12&4294967295|I>>>20),I=R+(T^k&(E^T))+x[14]+2792965006&4294967295,R=k+(I<<17&4294967295|I>>>15),I=T+(E^R&(k^E))+x[15]+1236535329&4294967295,T=R+(I<<22&4294967295|I>>>10),I=E+(R^k&(T^R))+x[1]+4129170786&4294967295,E=T+(I<<5&4294967295|I>>>27),I=k+(T^R&(E^T))+x[6]+3225465664&4294967295,k=E+(I<<9&4294967295|I>>>23),I=R+(E^T&(k^E))+x[11]+643717713&4294967295,R=k+(I<<14&4294967295|I>>>18),I=T+(k^E&(R^k))+x[0]+3921069994&4294967295,T=R+(I<<20&4294967295|I>>>12),I=E+(R^k&(T^R))+x[5]+3593408605&4294967295,E=T+(I<<5&4294967295|I>>>27),I=k+(T^R&(E^T))+x[10]+38016083&4294967295,k=E+(I<<9&4294967295|I>>>23),I=R+(E^T&(k^E))+x[15]+3634488961&4294967295,R=k+(I<<14&4294967295|I>>>18),I=T+(k^E&(R^k))+x[4]+3889429448&4294967295,T=R+(I<<20&4294967295|I>>>12),I=E+(R^k&(T^R))+x[9]+568446438&4294967295,E=T+(I<<5&4294967295|I>>>27),I=k+(T^R&(E^T))+x[14]+3275163606&4294967295,k=E+(I<<9&4294967295|I>>>23),I=R+(E^T&(k^E))+x[3]+4107603335&4294967295,R=k+(I<<14&4294967295|I>>>18),I=T+(k^E&(R^k))+x[8]+1163531501&4294967295,T=R+(I<<20&4294967295|I>>>12),I=E+(R^k&(T^R))+x[13]+2850285829&4294967295,E=T+(I<<5&4294967295|I>>>27),I=k+(T^R&(E^T))+x[2]+4243563512&4294967295,k=E+(I<<9&4294967295|I>>>23),I=R+(E^T&(k^E))+x[7]+1735328473&4294967295,R=k+(I<<14&4294967295|I>>>18),I=T+(k^E&(R^k))+x[12]+2368359562&4294967295,T=R+(I<<20&4294967295|I>>>12),I=E+(T^R^k)+x[5]+4294588738&4294967295,E=T+(I<<4&4294967295|I>>>28),I=k+(E^T^R)+x[8]+2272392833&4294967295,k=E+(I<<11&4294967295|I>>>21),I=R+(k^E^T)+x[11]+1839030562&4294967295,R=k+(I<<16&4294967295|I>>>16),I=T+(R^k^E)+x[14]+4259657740&4294967295,T=R+(I<<23&4294967295|I>>>9),I=E+(T^R^k)+x[1]+2763975236&4294967295,E=T+(I<<4&4294967295|I>>>28),I=k+(E^T^R)+x[4]+1272893353&4294967295,k=E+(I<<11&4294967295|I>>>21),I=R+(k^E^T)+x[7]+4139469664&4294967295,R=k+(I<<16&4294967295|I>>>16),I=T+(R^k^E)+x[10]+3200236656&4294967295,T=R+(I<<23&4294967295|I>>>9),I=E+(T^R^k)+x[13]+681279174&4294967295,E=T+(I<<4&4294967295|I>>>28),I=k+(E^T^R)+x[0]+3936430074&4294967295,k=E+(I<<11&4294967295|I>>>21),I=R+(k^E^T)+x[3]+3572445317&4294967295,R=k+(I<<16&4294967295|I>>>16),I=T+(R^k^E)+x[6]+76029189&4294967295,T=R+(I<<23&4294967295|I>>>9),I=E+(T^R^k)+x[9]+3654602809&4294967295,E=T+(I<<4&4294967295|I>>>28),I=k+(E^T^R)+x[12]+3873151461&4294967295,k=E+(I<<11&4294967295|I>>>21),I=R+(k^E^T)+x[15]+530742520&4294967295,R=k+(I<<16&4294967295|I>>>16),I=T+(R^k^E)+x[2]+3299628645&4294967295,T=R+(I<<23&4294967295|I>>>9),I=E+(R^(T|~k))+x[0]+4096336452&4294967295,E=T+(I<<6&4294967295|I>>>26),I=k+(T^(E|~R))+x[7]+1126891415&4294967295,k=E+(I<<10&4294967295|I>>>22),I=R+(E^(k|~T))+x[14]+2878612391&4294967295,R=k+(I<<15&4294967295|I>>>17),I=T+(k^(R|~E))+x[5]+4237533241&4294967295,T=R+(I<<21&4294967295|I>>>11),I=E+(R^(T|~k))+x[12]+1700485571&4294967295,E=T+(I<<6&4294967295|I>>>26),I=k+(T^(E|~R))+x[3]+2399980690&4294967295,k=E+(I<<10&4294967295|I>>>22),I=R+(E^(k|~T))+x[10]+4293915773&4294967295,R=k+(I<<15&4294967295|I>>>17),I=T+(k^(R|~E))+x[1]+2240044497&4294967295,T=R+(I<<21&4294967295|I>>>11),I=E+(R^(T|~k))+x[8]+1873313359&4294967295,E=T+(I<<6&4294967295|I>>>26),I=k+(T^(E|~R))+x[15]+4264355552&4294967295,k=E+(I<<10&4294967295|I>>>22),I=R+(E^(k|~T))+x[6]+2734768916&4294967295,R=k+(I<<15&4294967295|I>>>17),I=T+(k^(R|~E))+x[13]+1309151649&4294967295,T=R+(I<<21&4294967295|I>>>11),I=E+(R^(T|~k))+x[4]+4149444226&4294967295,E=T+(I<<6&4294967295|I>>>26),I=k+(T^(E|~R))+x[11]+3174756917&4294967295,k=E+(I<<10&4294967295|I>>>22),I=R+(E^(k|~T))+x[2]+718787259&4294967295,R=k+(I<<15&4294967295|I>>>17),I=T+(k^(R|~E))+x[9]+3951481745&4294967295,M.g[0]=M.g[0]+E&4294967295,M.g[1]=M.g[1]+(R+(I<<21&4294967295|I>>>11))&4294967295,M.g[2]=M.g[2]+R&4294967295,M.g[3]=M.g[3]+k&4294967295}i.prototype.u=function(M,E){E===void 0&&(E=M.length);for(var T=E-this.blockSize,x=this.B,R=this.h,k=0;k<E;){if(R==0)for(;k<=T;)o(this,M,k),k+=this.blockSize;if(typeof M=="string"){for(;k<E;)if(x[R++]=M.charCodeAt(k++),R==this.blockSize){o(this,x),R=0;break}}else for(;k<E;)if(x[R++]=M[k++],R==this.blockSize){o(this,x),R=0;break}}this.h=R,this.o+=E},i.prototype.v=function(){var M=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);M[0]=128;for(var E=1;E<M.length-8;++E)M[E]=0;var T=8*this.o;for(E=M.length-8;E<M.length;++E)M[E]=T&255,T/=256;for(this.u(M),M=Array(16),E=T=0;4>E;++E)for(var x=0;32>x;x+=8)M[T++]=this.g[E]>>>x&255;return M};function s(M,E){var T=h;return Object.prototype.hasOwnProperty.call(T,M)?T[M]:T[M]=E(M)}function l(M,E){this.h=E;for(var T=[],x=!0,R=M.length-1;0<=R;R--){var k=M[R]|0;x&&k==E||(T[R]=k,x=!1)}this.g=T}var h={};function d(M){return-128<=M&&128>M?s(M,function(E){return new l([E|0],0>E?-1:0)}):new l([M|0],0>M?-1:0)}function m(M){if(isNaN(M)||!isFinite(M))return w;if(0>M)return $(m(-M));for(var E=[],T=1,x=0;M>=T;x++)E[x]=M/T|0,T*=4294967296;return new l(E,0)}function v(M,E){if(M.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(M.charAt(0)=="-")return $(v(M.substring(1),E));if(0<=M.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=m(Math.pow(E,8)),x=w,R=0;R<M.length;R+=8){var k=Math.min(8,M.length-R),I=parseInt(M.substring(R,R+k),E);8>k?(k=m(Math.pow(E,k)),x=x.j(k).add(m(I))):(x=x.j(T),x=x.add(m(I)))}return x}var w=d(0),S=d(1),A=d(16777216);n=l.prototype,n.m=function(){if(j(this))return-$(this).m();for(var M=0,E=1,T=0;T<this.g.length;T++){var x=this.i(T);M+=(0<=x?x:4294967296+x)*E,E*=4294967296}return M},n.toString=function(M){if(M=M||10,2>M||36<M)throw Error("radix out of range: "+M);if(F(this))return"0";if(j(this))return"-"+$(this).toString(M);for(var E=m(Math.pow(M,6)),T=this,x="";;){var R=Ce(T,E).g;T=ee(T,R.j(E));var k=((0<T.g.length?T.g[0]:T.h)>>>0).toString(M);if(T=R,F(T))return k+x;for(;6>k.length;)k="0"+k;x=k+x}},n.i=function(M){return 0>M?0:M<this.g.length?this.g[M]:this.h};function F(M){if(M.h!=0)return!1;for(var E=0;E<M.g.length;E++)if(M.g[E]!=0)return!1;return!0}function j(M){return M.h==-1}n.l=function(M){return M=ee(this,M),j(M)?-1:F(M)?0:1};function $(M){for(var E=M.g.length,T=[],x=0;x<E;x++)T[x]=~M.g[x];return new l(T,~M.h).add(S)}n.abs=function(){return j(this)?$(this):this},n.add=function(M){for(var E=Math.max(this.g.length,M.g.length),T=[],x=0,R=0;R<=E;R++){var k=x+(this.i(R)&65535)+(M.i(R)&65535),I=(k>>>16)+(this.i(R)>>>16)+(M.i(R)>>>16);x=I>>>16,k&=65535,I&=65535,T[R]=I<<16|k}return new l(T,T[T.length-1]&-2147483648?-1:0)};function ee(M,E){return M.add($(E))}n.j=function(M){if(F(this)||F(M))return w;if(j(this))return j(M)?$(this).j($(M)):$($(this).j(M));if(j(M))return $(this.j($(M)));if(0>this.l(A)&&0>M.l(A))return m(this.m()*M.m());for(var E=this.g.length+M.g.length,T=[],x=0;x<2*E;x++)T[x]=0;for(x=0;x<this.g.length;x++)for(var R=0;R<M.g.length;R++){var k=this.i(x)>>>16,I=this.i(x)&65535,ut=M.i(R)>>>16,pn=M.i(R)&65535;T[2*x+2*R]+=I*pn,oe(T,2*x+2*R),T[2*x+2*R+1]+=k*pn,oe(T,2*x+2*R+1),T[2*x+2*R+1]+=I*ut,oe(T,2*x+2*R+1),T[2*x+2*R+2]+=k*ut,oe(T,2*x+2*R+2)}for(x=0;x<E;x++)T[x]=T[2*x+1]<<16|T[2*x];for(x=E;x<2*E;x++)T[x]=0;return new l(T,0)};function oe(M,E){for(;(M[E]&65535)!=M[E];)M[E+1]+=M[E]>>>16,M[E]&=65535,E++}function me(M,E){this.g=M,this.h=E}function Ce(M,E){if(F(E))throw Error("division by zero");if(F(M))return new me(w,w);if(j(M))return E=Ce($(M),E),new me($(E.g),$(E.h));if(j(E))return E=Ce(M,$(E)),new me($(E.g),E.h);if(30<M.g.length){if(j(M)||j(E))throw Error("slowDivide_ only works with positive integers.");for(var T=S,x=E;0>=x.l(M);)T=pt(T),x=pt(x);var R=Oe(T,1),k=Oe(x,1);for(x=Oe(x,2),T=Oe(T,2);!F(x);){var I=k.add(x);0>=I.l(M)&&(R=R.add(T),k=I),x=Oe(x,1),T=Oe(T,1)}return E=ee(M,R.j(E)),new me(R,E)}for(R=w;0<=M.l(E);){for(T=Math.max(1,Math.floor(M.m()/E.m())),x=Math.ceil(Math.log(T)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),k=m(T),I=k.j(E);j(I)||0<I.l(M);)T-=x,k=m(T),I=k.j(E);F(k)&&(k=S),R=R.add(k),M=ee(M,I)}return new me(R,M)}n.A=function(M){return Ce(this,M).h},n.and=function(M){for(var E=Math.max(this.g.length,M.g.length),T=[],x=0;x<E;x++)T[x]=this.i(x)&M.i(x);return new l(T,this.h&M.h)},n.or=function(M){for(var E=Math.max(this.g.length,M.g.length),T=[],x=0;x<E;x++)T[x]=this.i(x)|M.i(x);return new l(T,this.h|M.h)},n.xor=function(M){for(var E=Math.max(this.g.length,M.g.length),T=[],x=0;x<E;x++)T[x]=this.i(x)^M.i(x);return new l(T,this.h^M.h)};function pt(M){for(var E=M.g.length+1,T=[],x=0;x<E;x++)T[x]=M.i(x)<<1|M.i(x-1)>>>31;return new l(T,M.h)}function Oe(M,E){var T=E>>5;E%=32;for(var x=M.g.length-T,R=[],k=0;k<x;k++)R[k]=0<E?M.i(k+T)>>>E|M.i(k+T+1)<<32-E:M.i(k+T);return new l(R,M.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Np=Ny.Md5=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=v,Br=Ny.Integer=l}).apply(typeof Vy<"u"?Vy:typeof self<"u"?self:typeof window<"u"?window:{});var ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dr={};var Bp,AP,zs,zp,Ol,uh,Up,jp,$p;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,p,_){return c==Array.prototype||c==Object.prototype||(c[p]=_.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ch=="object"&&ch];for(var p=0;p<c.length;++p){var _=c[p];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function o(c,p){if(p)e:{var _=i;c=c.split(".");for(var C=0;C<c.length-1;C++){var O=c[C];if(!(O in _))break e;_=_[O]}c=c[c.length-1],C=_[c],p=p(C),p!=C&&p!=null&&e(_,c,{configurable:!0,writable:!0,value:p})}}function s(c,p){c instanceof String&&(c+="");var _=0,C=!1,O={next:function(){if(!C&&_<c.length){var z=_++;return{value:p(z,c[z]),done:!1}}return C=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}o("Array.prototype.values",function(c){return c||function(){return s(this,function(p,_){return _})}});var l=l||{},h=this||self;function d(c){var p=typeof c;return p=p!="object"?p:c?Array.isArray(c)?"array":p:"null",p=="array"||p=="object"&&typeof c.length=="number"}function m(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function v(c,p,_){return c.call.apply(c.bind,arguments)}function w(c,p,_){if(!c)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,C),c.apply(p,O)}}return function(){return c.apply(p,arguments)}}function S(c,p,_){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:w,S.apply(null,arguments)}function A(c,p){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function F(c,p){function _(){}_.prototype=p.prototype,c.aa=p.prototype,c.prototype=new _,c.prototype.constructor=c,c.Qb=function(C,O,z){for(var Y=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)Y[Le-2]=arguments[Le];return p.prototype[O].apply(C,Y)}}function j(c){let p=c.length;if(0<p){let _=Array(p);for(let C=0;C<p;C++)_[C]=c[C];return _}return[]}function $(c,p){for(let _=1;_<arguments.length;_++){let C=arguments[_];if(d(C)){let O=c.length||0,z=C.length||0;c.length=O+z;for(let Y=0;Y<z;Y++)c[O+Y]=C[Y]}else c.push(C)}}class ee{constructor(p,_){this.i=p,this.j=_,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function oe(c){return/^[\s\xa0]*$/.test(c)}function me(){var c=h.navigator;return c&&(c=c.userAgent)?c:""}function Ce(c){return Ce[" "](c),c}Ce[" "]=function(){};var pt=me().indexOf("Gecko")!=-1&&!(me().toLowerCase().indexOf("webkit")!=-1&&me().indexOf("Edge")==-1)&&!(me().indexOf("Trident")!=-1||me().indexOf("MSIE")!=-1)&&me().indexOf("Edge")==-1;function Oe(c,p,_){for(let C in c)p.call(_,c[C],C,c)}function M(c,p){for(let _ in c)p.call(void 0,c[_],_,c)}function E(c){let p={};for(let _ in c)p[_]=c[_];return p}let T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(c,p){let _,C;for(let O=1;O<arguments.length;O++){C=arguments[O];for(_ in C)c[_]=C[_];for(let z=0;z<T.length;z++)_=T[z],Object.prototype.hasOwnProperty.call(C,_)&&(c[_]=C[_])}}function R(c){var p=1;c=c.split(":");let _=[];for(;0<p&&c.length;)_.push(c.shift()),p--;return c.length&&_.push(c.join(":")),_}function k(c){h.setTimeout(()=>{throw c},0)}function I(){var c=ce;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class ut{constructor(){this.h=this.g=null}add(p,_){let C=pn.get();C.set(p,_),this.h?this.h.next=C:this.g=C,this.h=C}}var pn=new ee(()=>new H,c=>c.reset());class H{constructor(){this.next=this.g=this.h=null}set(p,_){this.h=p,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let se,W=!1,ce=new ut,Ne=()=>{let c=h.Promise.resolve(void 0);se=()=>{c.then(at)}};var at=()=>{for(var c;c=I();){try{c.h.call(c.g)}catch(_){k(_)}var p=pn;p.j(c),100>p.h&&(p.h++,c.next=p.g,p.g=c)}W=!1};function Ie(){this.s=this.s,this.C=this.C}Ie.prototype.s=!1,Ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ge(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}ge.prototype.h=function(){this.defaultPrevented=!0};var de=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let _=()=>{};h.addEventListener("test",_,p),h.removeEventListener("test",_,p)}catch{}return c}();function Ft(c,p){if(ge.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var _=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget){if(pt){e:{try{Ce(p.nodeName);var O=!0;break e}catch{}O=!1}O||(p=null)}}else _=="mouseover"?p=c.fromElement:_=="mouseout"&&(p=c.toElement);this.relatedTarget=p,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:jn[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Ft.aa.h.call(this)}}F(Ft,ge);var jn={2:"touch",3:"pen",4:"mouse"};Ft.prototype.h=function(){Ft.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var mt="closure_listenable_"+(1e6*Math.random()|0),wn=0;function Vt(c,p,_,C,O){this.listener=c,this.proxy=null,this.src=p,this.type=_,this.capture=!!C,this.ha=O,this.key=++wn,this.da=this.fa=!1}function sn(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function $n(c){this.src=c,this.g={},this.h=0}$n.prototype.add=function(c,p,_,C,O){var z=c.toString();c=this.g[z],c||(c=this.g[z]=[],this.h++);var Y=Yo(c,p,C,O);return-1<Y?(p=c[Y],_||(p.fa=!1)):(p=new Vt(p,this.src,z,!!C,O),p.fa=_,c.push(p)),p};function fa(c,p){var _=p.type;if(_ in c.g){var C=c.g[_],O=Array.prototype.indexOf.call(C,p,void 0),z;(z=0<=O)&&Array.prototype.splice.call(C,O,1),z&&(sn(p),c.g[_].length==0&&(delete c.g[_],c.h--))}}function Yo(c,p,_,C){for(var O=0;O<c.length;++O){var z=c[O];if(!z.da&&z.listener==p&&z.capture==!!_&&z.ha==C)return O}return-1}var Xo="closure_lm_"+(1e6*Math.random()|0),Yr={};function Xr(c,p,_,C,O){if(C&&C.once)return Jo(c,p,_,C,O);if(Array.isArray(p)){for(var z=0;z<p.length;z++)Xr(c,p[z],_,C,O);return null}return _=ns(_),c&&c[mt]?c.K(p,_,m(C)?!!C.capture:!!C,O):wc(c,p,_,!1,C,O)}function wc(c,p,_,C,O,z){if(!p)throw Error("Invalid event type");var Y=m(O)?!!O.capture:!!O,Le=Jr(c);if(Le||(c[Xo]=Le=new $n(c)),_=Le.add(p,_,C,Y,z),_.proxy)return _;if(C=Cc(),_.proxy=C,C.src=c,C.listener=_,c.addEventListener)de||(O=Y),O===void 0&&(O=!1),c.addEventListener(p.toString(),C,O);else if(c.attachEvent)c.attachEvent(bc(p.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Cc(){function c(_){return p.call(c.src,c.listener,_)}let p=Td;return c}function Jo(c,p,_,C,O){if(Array.isArray(p)){for(var z=0;z<p.length;z++)Jo(c,p[z],_,C,O);return null}return _=ns(_),c&&c[mt]?c.L(p,_,m(C)?!!C.capture:!!C,O):wc(c,p,_,!0,C,O)}function pa(c,p,_,C,O){if(Array.isArray(p))for(var z=0;z<p.length;z++)pa(c,p[z],_,C,O);else C=m(C)?!!C.capture:!!C,_=ns(_),c&&c[mt]?(c=c.i,p=String(p).toString(),p in c.g&&(z=c.g[p],_=Yo(z,_,C,O),-1<_&&(sn(z[_]),Array.prototype.splice.call(z,_,1),z.length==0&&(delete c.g[p],c.h--)))):c&&(c=Jr(c))&&(p=c.g[p.toString()],c=-1,p&&(c=Yo(p,_,C,O)),(_=-1<c?p[c]:null)&&es(_))}function es(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[mt])fa(p.i,c);else{var _=c.type,C=c.proxy;p.removeEventListener?p.removeEventListener(_,C,c.capture):p.detachEvent?p.detachEvent(bc(_),C):p.addListener&&p.removeListener&&p.removeListener(C),(_=Jr(p))?(fa(_,c),_.h==0&&(_.src=null,p[Xo]=null)):sn(c)}}}function bc(c){return c in Yr?Yr[c]:Yr[c]="on"+c}function Td(c,p){if(c.da)c=!0;else{p=new Ft(p,this);var _=c.listener,C=c.ha||c.src;c.fa&&es(c),c=_.call(C,p)}return c}function Jr(c){return c=c[Xo],c instanceof $n?c:null}var ts="__closure_events_fn_"+(1e9*Math.random()>>>0);function ns(c){return typeof c=="function"?c:(c[ts]||(c[ts]=function(p){return c.handleEvent(p)}),c[ts])}function Nt(){Ie.call(this),this.i=new $n(this),this.M=this,this.F=null}F(Nt,Ie),Nt.prototype[mt]=!0,Nt.prototype.removeEventListener=function(c,p,_,C){pa(this,c,p,_,C)};function Bt(c,p){var _,C=c.F;if(C)for(_=[];C;C=C.F)_.push(C);if(c=c.M,C=p.type||p,typeof p=="string")p=new ge(p,c);else if(p instanceof ge)p.target=p.target||c;else{var O=p;p=new ge(C,c),x(p,O)}if(O=!0,_)for(var z=_.length-1;0<=z;z--){var Y=p.g=_[z];O=eo(Y,C,!0,p)&&O}if(Y=p.g=c,O=eo(Y,C,!0,p)&&O,O=eo(Y,C,!1,p)&&O,_)for(z=0;z<_.length;z++)Y=p.g=_[z],O=eo(Y,C,!1,p)&&O}Nt.prototype.N=function(){if(Nt.aa.N.call(this),this.i){var c=this.i,p;for(p in c.g){for(var _=c.g[p],C=0;C<_.length;C++)sn(_[C]);delete c.g[p],c.h--}}this.F=null},Nt.prototype.K=function(c,p,_,C){return this.i.add(String(c),p,!1,_,C)},Nt.prototype.L=function(c,p,_,C){return this.i.add(String(c),p,!0,_,C)};function eo(c,p,_,C){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();for(var O=!0,z=0;z<p.length;++z){var Y=p[z];if(Y&&!Y.da&&Y.capture==_){var Le=Y.listener,vt=Y.ha||Y.src;Y.fa&&fa(c.i,Y),O=Le.call(vt,C)!==!1&&O}}return O&&!C.defaultPrevented}function Ec(c,p,_){if(typeof c=="function")_&&(c=S(c,_));else if(c&&typeof c.handleEvent=="function")c=S(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:h.setTimeout(c,p||0)}function ma(c){c.g=Ec(()=>{c.g=null,c.i&&(c.i=!1,ma(c))},c.l);let p=c.h;c.h=null,c.m.apply(null,p)}class ga extends Ie{constructor(p,_){super(),this.m=p,this.l=_,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ma(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vr(c){Ie.call(this),this.h=c,this.g={}}F(vr,Ie);var Sc=[];function yr(c){Oe(c.g,function(p,_){this.g.hasOwnProperty(_)&&es(p)},c),c.g={}}vr.prototype.N=function(){vr.aa.N.call(this),yr(this)},vr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _a=h.JSON.stringify,Pd=h.JSON.parse,Tc=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function is(){}is.prototype.h=null;function va(c){return c.h||(c.h=c.i())}function Pc(){}var to={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ya(){ge.call(this,"d")}F(ya,ge);function wa(){ge.call(this,"c")}F(wa,ge);var Ui={},Dc=null;function wr(){return Dc=Dc||new Nt}Ui.La="serverreachability";function Ic(c){ge.call(this,Ui.La,c)}F(Ic,ge);function no(c){let p=wr();Bt(p,new Ic(p))}Ui.STAT_EVENT="statevent";function Ac(c,p){ge.call(this,Ui.STAT_EVENT,c),this.stat=p}F(Ac,ge);function Wt(c){let p=wr();Bt(p,new Ac(p,c))}Ui.Ma="timingevent";function Cn(c,p){ge.call(this,Ui.Ma,c),this.size=p}F(Cn,ge);function ae(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},p)}function Cr(){this.g=!0}Cr.prototype.xa=function(){this.g=!1};function xc(c,p,_,C,O,z){c.info(function(){if(c.g)if(z)for(var Y="",Le=z.split("&"),vt=0;vt<Le.length;vt++){var je=Le[vt].split("=");if(1<je.length){var dt=je[0];je=je[1];var zt=dt.split("_");Y=2<=zt.length&&zt[1]=="type"?Y+(dt+"="+je+"&"):Y+(dt+"=redacted&")}}else Y=null;else Y=z;return"XMLHTTP REQ ("+C+") [attempt "+O+"]: "+p+`
`+_+`
`+Y})}function Mc(c,p,_,C,O,z,Y){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+O+"]: "+p+`
`+_+`
`+z+" "+Y})}function ji(c,p,_,C){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Rc(c,_)+(C?" "+C:"")})}function Ca(c,p){c.info(function(){return"TIMEOUT: "+p})}Cr.prototype.info=function(){};function Rc(c,p){if(!c.g)return p;if(!p)return null;try{var _=JSON.parse(p);if(_){for(c=0;c<_.length;c++)if(Array.isArray(_[c])){var C=_[c];if(!(2>C.length)){var O=C[1];if(Array.isArray(O)&&!(1>O.length)){var z=O[0];if(z!="noop"&&z!="stop"&&z!="close")for(var Y=1;Y<O.length;Y++)O[Y]=""}}}}return _a(_)}catch{return p}}var oi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ba={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ea;function rs(){}F(rs,is),rs.prototype.g=function(){return new XMLHttpRequest},rs.prototype.i=function(){return{}},Ea=new rs;function _i(c,p,_,C){this.j=c,this.i=p,this.l=_,this.R=C||1,this.U=new vr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new kc}function kc(){this.i=null,this.g="",this.h=!1}var Sa={},Ta={};function br(c,p,_){c.L=1,c.v=Sr(Zt(p)),c.m=_,c.P=!0,Oc(c,null)}function Oc(c,p){c.F=Date.now(),os(c),c.A=Zt(c.v);var _=c.A,C=c.R;Array.isArray(C)||(C=[String(C)]),ot(_.i,"t",C),c.C=0,_=c.j.J,c.h=new kc,c.g=mo(c.j,_?p:null,!c.m),0<c.O&&(c.M=new ga(S(c.Y,c,c.g),c.O)),p=c.U,_=c.g,C=c.ca;var O="readystatechange";Array.isArray(O)||(O&&(Sc[0]=O.toString()),O=Sc);for(var z=0;z<O.length;z++){var Y=Xr(_,O[z],C||p.handleEvent,!1,p.h||p);if(!Y)break;p.g[Y.key]=Y}p=c.H?E(c.H):{},c.m?(c.u||(c.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,p)):(c.u="GET",c.g.ea(c.A,c.u,null,p)),no(),xc(c.i,c.u,c.A,c.l,c.R,c.m)}_i.prototype.ca=function(c){c=c.target;let p=this.M;p&&En(c)==3?p.j():this.Y(c)},_i.prototype.Y=function(c){try{if(c==this.g)e:{let zt=En(this.g);var p=this.g.Ba();let Tn=this.g.Z();if(!(3>zt)&&(zt!=3||this.g&&(this.h.h||this.g.oa()||Uc(this.g)))){this.J||zt!=4||p==7||(p==8||0>=Tn?no(3):no(2)),io(this);var _=this.g.Z();this.X=_;t:if(Lc(this)){var C=Uc(this.g);c="";var O=C.length,z=En(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){vi(this),si(this);var Y="";break t}this.h.i=new h.TextDecoder}for(p=0;p<O;p++)this.h.h=!0,c+=this.h.i.decode(C[p],{stream:!(z&&p==O-1)});C.length=0,this.h.g+=c,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=_==200,Mc(this.i,this.u,this.A,this.l,this.R,zt,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Le,vt=this.g;if((Le=vt.g?vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!oe(Le)){var je=Le;break t}}je=null}if(_=je)ji(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ss(this,_);else{this.o=!1,this.s=3,Wt(12),vi(this),si(this);break e}}if(this.P){_=!0;let Pn;for(;!this.J&&this.C<Y.length;)if(Pn=Dd(this,Y),Pn==Ta){zt==4&&(this.s=4,Wt(14),_=!1),ji(this.i,this.l,null,"[Incomplete Response]");break}else if(Pn==Sa){this.s=4,Wt(15),ji(this.i,this.l,Y,"[Invalid Chunk]"),_=!1;break}else ji(this.i,this.l,Pn,null),ss(this,Pn);if(Lc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||Y.length!=0||this.h.h||(this.s=1,Wt(16),_=!1),this.o=this.o&&_,!_)ji(this.i,this.l,Y,"[Invalid Chunked Response]"),vi(this),si(this);else if(0<Y.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),ds(dt),dt.M=!0,Wt(11))}}else ji(this.i,this.l,Y,null),ss(this,Y);zt==4&&vi(this),this.o&&!this.J&&(zt==4?Gc(this.j,this):(this.o=!1,os(this)))}else jc(this.g),_==400&&0<Y.indexOf("Unknown SID")?(this.s=3,Wt(12)):(this.s=0,Wt(13)),vi(this),si(this)}}}catch{}finally{}};function Lc(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Dd(c,p){var _=c.C,C=p.indexOf(`
`,_);return C==-1?Ta:(_=Number(p.substring(_,C)),isNaN(_)?Sa:(C+=1,C+_>p.length?Ta:(p=p.slice(C,C+_),c.C=C+_,p)))}_i.prototype.cancel=function(){this.J=!0,vi(this)};function os(c){c.S=Date.now()+c.I,Fc(c,c.I)}function Fc(c,p){if(c.B!=null)throw Error("WatchDog timer not null");c.B=ae(S(c.ba,c),p)}function io(c){c.B&&(h.clearTimeout(c.B),c.B=null)}_i.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(Ca(this.i,this.A),this.L!=2&&(no(),Wt(17)),vi(this),this.s=2,si(this)):Fc(this,this.S-c)};function si(c){c.j.G==0||c.J||Gc(c.j,c)}function vi(c){io(c);var p=c.M;p&&typeof p.ma=="function"&&p.ma(),c.M=null,yr(c.U),c.g&&(p=c.g,c.g=null,p.abort(),p.ma())}function ss(c,p){try{var _=c.j;if(_.G!=0&&(_.g==c||yi(_.h,c))){if(!c.K&&yi(_.h,c)&&_.G==3){try{var C=_.Da.g.parse(p)}catch{C=null}if(Array.isArray(C)&&C.length==3){var O=C;if(O[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<c.F)fs(_),cs(_);else break e;Va(_),Wt(18)}}else _.za=O[1],0<_.za-_.T&&37500>O[2]&&_.F&&_.v==0&&!_.C&&(_.C=ae(S(_.Za,_),6e3));if(1>=oo(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Hi(_,11)}else if((c.K||_.g==c)&&fs(_),!oe(p))for(O=_.Da.g.parse(p),p=0;p<O.length;p++){let je=O[p];if(_.T=je[0],je=je[1],_.G==2)if(je[0]=="c"){_.K=je[1],_.ia=je[2];let dt=je[3];dt!=null&&(_.la=dt,_.j.info("VER="+_.la));let zt=je[4];zt!=null&&(_.Aa=zt,_.j.info("SVER="+_.Aa));let Tn=je[5];Tn!=null&&typeof Tn=="number"&&0<Tn&&(C=1.5*Tn,_.L=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;let Pn=c.g;if(Pn){let Ei=Pn.g?Pn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ei){var z=C.h;z.g||Ei.indexOf("spdy")==-1&&Ei.indexOf("quic")==-1&&Ei.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(wi(z,z.h),z.h=null))}if(C.D){let gs=Pn.g?Pn.g.getResponseHeader("X-HTTP-Session-Id"):null;gs&&(C.ya=gs,Qe(C.I,C.D,gs))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-c.F,_.j.info("Handshake RTT: "+_.R+"ms")),C=_;var Y=c;if(C.qa=za(C,C.J?C.ia:null,C.W),Y.K){as(C.h,Y);var Le=Y,vt=C.L;vt&&(Le.I=vt),Le.B&&(io(Le),os(Le)),C.g=Y}else hs(C);0<_.i.length&&us(_)}else je[0]!="stop"&&je[0]!="close"||Hi(_,7);else _.G==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?Hi(_,7):po(_):je[0]!="noop"&&_.l&&_.l.ta(je),_.v=0)}}no(4)}catch{}}var ro=class{constructor(c,p){this.g=c,this.map=p}};function Ue(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ht(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function oo(c){return c.h?1:c.g?c.g.size:0}function yi(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function wi(c,p){c.g?c.g.add(p):c.h=p}function as(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}Ue.prototype.cancel=function(){if(this.i=Ae(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function Ae(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let p=c.i;for(let _ of c.g.values())p=p.concat(_.D);return p}return j(c.i)}function bt(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(d(c)){for(var p=[],_=c.length,C=0;C<_;C++)p.push(c[C]);return p}p=[],_=0;for(C in c)p[_++]=c[C];return p}function Pa(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(d(c)||typeof c=="string"){var p=[];c=c.length;for(var _=0;_<c;_++)p.push(_);return p}p=[],_=0;for(let C in c)p[_++]=C;return p}}}function so(c,p){if(c.forEach&&typeof c.forEach=="function")c.forEach(p,void 0);else if(d(c)||typeof c=="string")Array.prototype.forEach.call(c,p,void 0);else for(var _=Pa(c),C=bt(c),O=C.length,z=0;z<O;z++)p.call(void 0,C[z],_&&_[z],c)}var an=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Id(c,p){if(c){c=c.split("&");for(var _=0;_<c.length;_++){var C=c[_].indexOf("="),O=null;if(0<=C){var z=c[_].substring(0,C);O=c[_].substring(C+1)}else z=c[_];p(z,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function qn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof qn){this.h=c.h,gt(this,c.j),this.o=c.o,this.g=c.g,Gn(this,c.s),this.l=c.l;var p=c.i,_=new qi;_.i=p.i,p.g&&(_.g=new Map(p.g),_.h=p.h),Er(this,_),this.m=c.m}else c&&(p=String(c).match(an))?(this.h=!1,gt(this,p[1]||"",!0),this.o=ai(p[2]||""),this.g=ai(p[3]||"",!0),Gn(this,p[4]),this.l=ai(p[5]||"",!0),Er(this,p[6]||"",!0),this.m=ai(p[7]||"")):(this.h=!1,this.i=new qi(null,this.h))}qn.prototype.toString=function(){var c=[],p=this.j;p&&c.push($i(p,ao,!0),":");var _=this.g;return(_||p=="file")&&(c.push("//"),(p=this.o)&&c.push($i(p,ao,!0),"@"),c.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&c.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&c.push("/"),c.push($i(_,_.charAt(0)=="/"?Aa:Ia,!0))),(_=this.i.toString())&&c.push("?",_),(_=this.m)&&c.push("#",$i(_,Vc)),c.join("")};function Zt(c){return new qn(c)}function gt(c,p,_){c.j=_?ai(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Gn(c,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);c.s=p}else c.s=null}function Er(c,p,_){p instanceof qi?(c.i=p,xa(c.i,c.h)):(_||(p=$i(p,ls)),c.i=new qi(p,c.h))}function Qe(c,p,_){c.i.set(p,_)}function Sr(c){return Qe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function ai(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function $i(c,p,_){return typeof c=="string"?(c=encodeURI(c).replace(p,Da),_&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Da(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ao=/[#\/\?@]/g,Ia=/[#\?:]/g,Aa=/[#\?]/g,ls=/[#\?@]/g,Vc=/#/g;function qi(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function Ci(c){c.g||(c.g=new Map,c.h=0,c.i&&Id(c.i,function(p,_){c.add(decodeURIComponent(p.replace(/\+/g," ")),_)}))}n=qi.prototype,n.add=function(c,p){Ci(this),this.i=null,c=Gi(this,c);var _=this.g.get(c);return _||this.g.set(c,_=[]),_.push(p),this.h+=1,this};function Se(c,p){Ci(c),p=Gi(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function bn(c,p){return Ci(c),p=Gi(c,p),c.g.has(p)}n.forEach=function(c,p){Ci(this),this.g.forEach(function(_,C){_.forEach(function(O){c.call(p,O,C,this)},this)},this)},n.na=function(){Ci(this);let c=Array.from(this.g.values()),p=Array.from(this.g.keys()),_=[];for(let C=0;C<p.length;C++){let O=c[C];for(let z=0;z<O.length;z++)_.push(p[C])}return _},n.V=function(c){Ci(this);let p=[];if(typeof c=="string")bn(this,c)&&(p=p.concat(this.g.get(Gi(this,c))));else{c=Array.from(this.g.values());for(let _=0;_<c.length;_++)p=p.concat(c[_])}return p},n.set=function(c,p){return Ci(this),this.i=null,c=Gi(this,c),bn(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},n.get=function(c,p){return c?(c=this.V(c),0<c.length?String(c[0]):p):p};function ot(c,p,_){Se(c,p),0<_.length&&(c.i=null,c.g.set(Gi(c,p),j(_)),c.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],p=Array.from(this.g.keys());for(var _=0;_<p.length;_++){var C=p[_];let z=encodeURIComponent(String(C)),Y=this.V(C);for(C=0;C<Y.length;C++){var O=z;Y[C]!==""&&(O+="="+encodeURIComponent(String(Y[C]))),c.push(O)}}return this.i=c.join("&")};function Gi(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function xa(c,p){p&&!c.j&&(Ci(c),c.i=null,c.g.forEach(function(_,C){var O=C.toLowerCase();C!=O&&(Se(this,C),ot(this,O,_))},c)),c.j=p}function Ma(c,p){let _=new Cr;if(h.Image){let C=new Image;C.onload=A(Yt,_,"TestLoadImage: loaded",!0,p,C),C.onerror=A(Yt,_,"TestLoadImage: error",!1,p,C),C.onabort=A(Yt,_,"TestLoadImage: abort",!1,p,C),C.ontimeout=A(Yt,_,"TestLoadImage: timeout",!1,p,C),h.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else p(!1)}function Ra(c,p){let _=new Cr,C=new AbortController,O=setTimeout(()=>{C.abort(),Yt(_,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:C.signal}).then(z=>{clearTimeout(O),z.ok?Yt(_,"TestPingServer: ok",!0,p):Yt(_,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(O),Yt(_,"TestPingServer: error",!1,p)})}function Yt(c,p,_,C,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),C(_)}catch{}}function ka(){this.g=new Tc}function lo(c,p,_){let C=_||"";try{so(c,function(O,z){let Y=O;m(O)&&(Y=_a(O)),p.push(C+z+"="+encodeURIComponent(Y))})}catch(O){throw p.push(C+"type="+encodeURIComponent("_badmap")),O}}function Et(c){this.l=c.Ub||null,this.j=c.eb||!1}F(Et,is),Et.prototype.g=function(){return new Hn(this.l,this.j)},Et.prototype.i=function(c){return function(){return c}}({});function Hn(c,p){Nt.call(this),this.D=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}F(Hn,Nt),n=Hn.prototype,n.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=p,this.readyState=1,co(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(p.body=c),(this.D||h).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Tr(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,co(this)),this.g&&(this.readyState=3,co(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Oa(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Oa(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Tr(this):co(this),this.readyState==3&&Oa(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Tr(this))},n.Qa=function(c){this.g&&(this.response=c,Tr(this))},n.ga=function(){this.g&&Tr(this)};function Tr(c){c.readyState=4,c.l=null,c.j=null,c.v=null,co(c)}n.setRequestHeader=function(c,p){this.u.append(c,p)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],p=this.h.entries();for(var _=p.next();!_.done;)_=_.value,c.push(_[0]+": "+_[1]),_=p.next();return c.join(`\r
`)};function co(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Hn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function La(c){let p="";return Oe(c,function(_,C){p+=C,p+=":",p+=_,p+=`\r
`}),p}function uo(c,p,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=La(_),typeof c=="string"?_!=null&&encodeURIComponent(String(_)):Qe(c,p,_))}function _t(c){Nt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}F(_t,Nt);var Nc=/^https?$/i,Be=["POST","PUT"];n=_t.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,p,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ea.g(),this.v=this.o?va(this.o):va(Ea),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(z){Bc(this,z);return}if(c=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var O in C)_.set(O,C[O]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(let z of C.keys())_.set(z,C.get(z));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(z=>z.toLowerCase()=="content-type"),O=h.FormData&&c instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Be,p,void 0))||C||O||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[z,Y]of _)this.g.setRequestHeader(z,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zc(this),this.u=!0,this.g.send(c),this.u=!1}catch(z){Bc(this,z)}};function Bc(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.m=5,mn(c),ho(c)}function mn(c){c.A||(c.A=!0,Bt(c,"complete"),Bt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Bt(this,"complete"),Bt(this,"abort"),ho(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ho(this,!0)),_t.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Pr(this):this.bb())},n.bb=function(){Pr(this)};function Pr(c){if(c.h&&typeof l<"u"&&(!c.v[1]||En(c)!=4||c.Z()!=2)){if(c.u&&En(c)==4)Ec(c.Ea,0,c);else if(Bt(c,"readystatechange"),En(c)==4){c.h=!1;try{let Y=c.Z();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var _;if(!(_=p)){var C;if(C=Y===0){var O=String(c.D).match(an)[1]||null;!O&&h.self&&h.self.location&&(O=h.self.location.protocol.slice(0,-1)),C=!Nc.test(O?O.toLowerCase():"")}_=C}if(_)Bt(c,"complete"),Bt(c,"success");else{c.m=6;try{var z=2<En(c)?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.Z()+"]",mn(c)}}finally{ho(c)}}}}function ho(c,p){if(c.g){zc(c);let _=c.g,C=c.v[0]?()=>{}:null;c.g=null,c.v=null,p||Bt(c,"ready");try{_.onreadystatechange=C}catch{}}}function zc(c){c.I&&(h.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function En(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<En(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Pd(p)}};function Uc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function jc(c){let p={};c=(c.g&&2<=En(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(oe(c[C]))continue;var _=R(c[C]);let O=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();let z=p[O]||[];p[O]=z,z.push(_)}M(p,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fo(c,p,_){return _&&_.internalChannelParams&&_.internalChannelParams[c]||p}function $c(c){this.Aa=0,this.i=[],this.j=new Cr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fo("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fo("baseRetryDelayMs",5e3,c),this.cb=fo("retryDelaySeedMs",1e4,c),this.Wa=fo("forwardChannelMaxRetries",2,c),this.wa=fo("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Ue(c&&c.concurrentRequestLimit),this.Da=new ka,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$c.prototype,n.la=8,n.G=1,n.connect=function(c,p,_,C){Wt(0),this.W=c,this.H=p||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.I=za(this,null,this.W),us(this)};function po(c){if(Sn(c),c.G==3){var p=c.U++,_=Zt(c.I);if(Qe(_,"SID",c.K),Qe(_,"RID",p),Qe(_,"TYPE","terminate"),Dr(c,_),p=new _i(c,c.j,p),p.L=2,p.v=Sr(Zt(_)),_=!1,h.navigator&&h.navigator.sendBeacon)try{_=h.navigator.sendBeacon(p.v.toString(),"")}catch{}!_&&h.Image&&(new Image().src=p.v,_=!0),_||(p.g=mo(p.j,null),p.g.ea(p.v)),p.F=Date.now(),os(p)}Ba(c)}function cs(c){c.g&&(ds(c),c.g.cancel(),c.g=null)}function Sn(c){cs(c),c.u&&(h.clearTimeout(c.u),c.u=null),fs(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&h.clearTimeout(c.s),c.s=null)}function us(c){if(!ht(c.h)&&!c.s){c.s=!0;var p=c.Ga;se||Ne(),W||(se(),W=!0),ce.add(p,c),c.B=0}}function qc(c,p){return oo(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=p.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=ae(S(c.Ga,c,p),ps(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let O=new _i(this,this.j,c),z=this.o;if(this.S&&(z?(z=E(z),x(z,this.S)):z=this.S),this.m!==null||this.O||(O.H=z,z=null),this.P)e:{for(var p=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(p+=C,4096<p){p=_;break e}if(p===4096||_===this.i.length-1){p=_+1;break e}}p=1e3}else p=1e3;p=Fa(this,O,p),_=Zt(this.I),Qe(_,"RID",c),Qe(_,"CVER",22),this.D&&Qe(_,"X-HTTP-Session-Id",this.D),Dr(this,_),z&&(this.O?p="headers="+encodeURIComponent(String(La(z)))+"&"+p:this.m&&uo(_,this.m,z)),wi(this.h,O),this.Ua&&Qe(_,"TYPE","init"),this.P?(Qe(_,"$req",p),Qe(_,"SID","null"),O.T=!0,br(O,_,null)):br(O,_,p),this.G=2}}else this.G==3&&(c?li(this,c):this.i.length==0||ht(this.h)||li(this))};function li(c,p){var _;p?_=p.l:_=c.U++;let C=Zt(c.I);Qe(C,"SID",c.K),Qe(C,"RID",_),Qe(C,"AID",c.T),Dr(c,C),c.m&&c.o&&uo(C,c.m,c.o),_=new _i(c,c.j,_,c.B+1),c.m===null&&(_.H=c.o),p&&(c.i=p.D.concat(c.i)),p=Fa(c,_,1e3),_.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),wi(c.h,_),br(_,C,p)}function Dr(c,p){c.H&&Oe(c.H,function(_,C){Qe(p,C,_)}),c.l&&so({},function(_,C){Qe(p,C,_)})}function Fa(c,p,_){_=Math.min(c.i.length,_);var C=c.l?S(c.l.Na,c.l,c):null;e:{var O=c.i;let z=-1;for(;;){let Y=["count="+_];z==-1?0<_?(z=O[0].g,Y.push("ofs="+z)):z=0:Y.push("ofs="+z);let Le=!0;for(let vt=0;vt<_;vt++){let je=O[vt].g,dt=O[vt].map;if(je-=z,0>je)z=Math.max(0,O[vt].g-100),Le=!1;else try{lo(dt,Y,"req"+je+"_")}catch{C&&C(dt)}}if(Le){C=Y.join("&");break e}}}return c=c.i.splice(0,_),p.D=c,C}function hs(c){if(!c.g&&!c.u){c.Y=1;var p=c.Fa;se||Ne(),W||(se(),W=!0),ce.add(p,c),c.v=0}}function Va(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=ae(S(c.Fa,c),ps(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,Na(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=ae(S(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Wt(10),cs(this),Na(this))};function ds(c){c.A!=null&&(h.clearTimeout(c.A),c.A=null)}function Na(c){c.g=new _i(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var p=Zt(c.qa);Qe(p,"RID","rpc"),Qe(p,"SID",c.K),Qe(p,"AID",c.T),Qe(p,"CI",c.F?"0":"1"),!c.F&&c.ja&&Qe(p,"TO",c.ja),Qe(p,"TYPE","xmlhttp"),Dr(c,p),c.m&&c.o&&uo(p,c.m,c.o),c.L&&(c.g.I=c.L);var _=c.g;c=c.ia,_.L=1,_.v=Sr(Zt(p)),_.m=null,_.P=!0,Oc(_,c)}n.Za=function(){this.C!=null&&(this.C=null,cs(this),Va(this),Wt(19))};function fs(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function Gc(c,p){var _=null;if(c.g==p){fs(c),ds(c),c.g=null;var C=2}else if(yi(c.h,p))_=p.D,as(c.h,p),C=1;else return;if(c.G!=0){if(p.o)if(C==1){_=p.m?p.m.length:0,p=Date.now()-p.F;var O=c.B;C=wr(),Bt(C,new Cn(C,_)),us(c)}else hs(c);else if(O=p.s,O==3||O==0&&0<p.X||!(C==1&&qc(c,p)||C==2&&Va(c)))switch(_&&0<_.length&&(p=c.h,p.i=p.i.concat(_)),O){case 1:Hi(c,5);break;case 4:Hi(c,10);break;case 3:Hi(c,6);break;default:Hi(c,2)}}}function ps(c,p){let _=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(_*=2),_*p}function Hi(c,p){if(c.j.info("Error code "+p),p==2){var _=S(c.fb,c),C=c.Xa;let O=!C;C=new qn(C||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||gt(C,"https"),Sr(C),O?Ma(C.toString(),_):Ra(C.toString(),_)}else Wt(2);c.G=0,c.l&&c.l.sa(p),Ba(c),Sn(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Wt(2)):(this.j.info("Failed to ping google.com"),Wt(1))};function Ba(c){if(c.G=0,c.ka=[],c.l){let p=Ae(c.h);(p.length!=0||c.i.length!=0)&&($(c.ka,p),$(c.ka,c.i),c.h.i.length=0,j(c.i),c.i.length=0),c.l.ra()}}function za(c,p,_){var C=_ instanceof qn?Zt(_):new qn(_);if(C.g!="")p&&(C.g=p+"."+C.g),Gn(C,C.s);else{var O=h.location;C=O.protocol,p=p?p+"."+O.hostname:O.hostname,O=+O.port;var z=new qn(null);C&&gt(z,C),p&&(z.g=p),O&&Gn(z,O),_&&(z.l=_),C=z}return _=c.D,p=c.ya,_&&p&&Qe(C,_,p),Qe(C,"VER",c.la),Dr(c,C),C}function mo(c,p,_){if(p&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Ca&&!c.pa?new _t(new Et({eb:_})):new _t(c.pa),p.Ha(c.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bi(){}n=bi.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ms(){}ms.prototype.g=function(c,p){return new Lt(c,p)};function Lt(c,p){Nt.call(this),this.g=new $c(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(c?c["X-WebChannel-Client-Profile"]=p.va:c={"X-WebChannel-Client-Profile":p.va}),this.g.S=c,(c=p&&p.Sb)&&!oe(c)&&(this.g.m=c),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!oe(p)&&(this.g.D=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new Ki(this)}F(Lt,Nt),Lt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Lt.prototype.close=function(){po(this.g)},Lt.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var _={};_.__data__=c,c=_}else this.u&&(_={},_.__data__=_a(c),c=_);p.i.push(new ro(p.Ya++,c)),p.G==3&&us(p)},Lt.prototype.N=function(){this.g.l=null,delete this.j,po(this.g),delete this.g,Lt.aa.N.call(this)};function ln(c){ya.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(let _ in p){c=_;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}F(ln,ya);function Ua(){wa.call(this),this.status=1}F(Ua,wa);function Ki(c){this.g=c}F(Ki,bi),Ki.prototype.ua=function(){Bt(this.g,"a")},Ki.prototype.ta=function(c){Bt(this.g,new ln(c))},Ki.prototype.sa=function(c){Bt(this.g,new Ua)},Ki.prototype.ra=function(){Bt(this.g,"b")},ms.prototype.createWebChannel=ms.prototype.g,Lt.prototype.send=Lt.prototype.o,Lt.prototype.open=Lt.prototype.m,Lt.prototype.close=Lt.prototype.close,$p=dr.createWebChannelTransport=function(){return new ms},jp=dr.getStatEventTarget=function(){return wr()},Up=dr.Event=Ui,uh=dr.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},oi.NO_ERROR=0,oi.TIMEOUT=8,oi.HTTP_ERROR=6,Ol=dr.ErrorCode=oi,ba.COMPLETE="complete",zp=dr.EventType=ba,Pc.EventType=to,to.OPEN="a",to.CLOSE="b",to.ERROR="c",to.MESSAGE="d",Nt.prototype.listen=Nt.prototype.K,zs=dr.WebChannel=Pc,AP=dr.FetchXmlHttpFactory=Et,_t.prototype.listenOnce=_t.prototype.L,_t.prototype.getLastError=_t.prototype.Ka,_t.prototype.getLastErrorCode=_t.prototype.Ba,_t.prototype.getStatus=_t.prototype.Z,_t.prototype.getResponseJson=_t.prototype.Oa,_t.prototype.getResponseText=_t.prototype.oa,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Ha,Bp=dr.XhrIo=_t}).apply(typeof ch<"u"?ch:typeof self<"u"?self:typeof window<"u"?window:{});var By="@firebase/firestore";var Kt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Kt.UNAUTHENTICATED=new Kt(null),Kt.GOOGLE_CREDENTIALS=new Kt("google-credentials-uid"),Kt.FIRST_PARTY=new Kt("first-party-uid"),Kt.MOCK_USER=new Kt("mock-user");var oa="10.14.0";var Lo=new _0("@firebase/firestore");function Ll(){return Lo.logLevel}function le(n,...e){if(Lo.logLevel<=nr.DEBUG){let t=e.map(Ig);Lo.debug(`Firestore (${oa}): ${n}`,...t)}}function pr(n,...e){if(Lo.logLevel<=nr.ERROR){let t=e.map(Ig);Lo.error(`Firestore (${oa}): ${n}`,...t)}}function Ws(n,...e){if(Lo.logLevel<=nr.WARN){let t=e.map(Ig);Lo.warn(`Firestore (${oa}): ${n}`,...t)}}function Ig(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function Ee(n="Unexpected state"){let e=`FIRESTORE (${oa}) INTERNAL ASSERTION FAILED: `+n;throw pr(e),new Error(e)}function st(n,e){n||Ee()}function De(n,e){return n}var G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},te=class extends m0{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var pi=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var mh=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Wp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Kt.UNAUTHENTICATED))}shutdown(){}},Zp=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Qp=class{constructor(e){this.t=e,this.currentUser=Kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){st(this.o===void 0);let i=this.i,o=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve(),s=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pi,e.enqueueRetryable(()=>o(this.currentUser))};let l=()=>{let d=s;e.enqueueRetryable(()=>q(this,null,function*(){yield d.promise,yield o(this.currentUser)}))},h=d=>{le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>h(d)),setTimeout(()=>{if(!this.auth){let d=this.t.getImmediate({optional:!0});d?h(d):(le("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pi)}},0),l()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(st(typeof i.accessToken=="string"),new mh(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return st(e===null||typeof e=="string"),new Kt(e)}},Yp=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Kt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Xp=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new Yp(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Jp=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},em=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){st(this.o===void 0);let i=s=>{s.error!=null&&le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let l=s.token!==this.R;return this.R=s.token,le("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let o=s=>{le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>o(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?o(s):le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(st(typeof t.token=="string"),this.R=t.token,new Jp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function xP(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var gh=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let o=xP(40);for(let s=0;s<o.length;++s)i.length<20&&o[s]<t&&(i+=e.charAt(o[s]%e.length))}return i}};function Ze(n,e){return n<e?-1:n>e?1:0}function Zs(n,e,t){return n.length===e.length&&n.every((i,o)=>t(i,e[o]))}var Dt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new te(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new te(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new te(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Me=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Dt(0,0))}static max(){return new n(new Dt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var _h=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ee(),i===void 0?i=e.length-t:i>e.length-t&&Ee(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let o=0;o<i;o++){let s=e.get(o),l=t.get(o);if(s<l)return-1;if(s>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ct=class n extends _h{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new te(G.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new n(t)}static emptyPath(){return new n([])}},MP=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zn=class n extends _h{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return MP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",o=0,s=()=>{if(i.length===0)throw new te(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},l=!1;for(;o<e.length;){let h=e[o];if(h==="\\"){if(o+1===e.length)throw new te(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new te(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,o+=2}else h==="`"?(l=!l,o++):h!=="."||l?(i+=h,o++):(s(),o++)}if(s(),l)throw new te(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var ve=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ct.fromString(e))}static fromName(e){return new n(Ct.fromString(e).popFirst(5))}static empty(){return new n(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ct(e.slice()))}};var tm=class{constructor(e,t,i,o){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=o}};tm.UNKNOWN_ID=-1;function RP(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=Me.fromTimestamp(i===1e9?new Dt(t+1,0):new Dt(t,i));return new Fo(o,ve.empty(),e)}function kP(n){return new Fo(n.readTime,n.key,-1)}var Fo=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Me.min(),ve.empty(),-1)}static max(){return new n(Me.max(),ve.empty(),-1)}};function OP(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(n.documentKey,e.documentKey),t!==0?t:Ze(n.largestBatchId,e.largestBatchId))}var LP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",nm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ic(n){return q(this,null,function*(){if(n.code!==G.FAILED_PRECONDITION||n.message!==LP)throw n;le("LocalStore","Unexpectedly lost primary lease")})}var Q=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,o)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,o)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let o=0,s=0,l=!1;e.forEach(h=>{++o,h.next(()=>{++s,l&&s===o&&t()},d=>i(d))}),l=!0,s===o&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(o=>o?n.resolve(o):i());return t}static forEach(e,t){let i=[];return e.forEach((o,s)=>{i.push(t.call(this,o,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,o)=>{let s=e.length,l=new Array(s),h=0;for(let d=0;d<s;d++){let m=d;t(e[m]).next(v=>{l[m]=v,++h,h===s&&i(l)},v=>o(v))}})}static doWhile(e,t){return new n((i,o)=>{let s=()=>{e()===!0?t().next(()=>{s()},o):i()};s()})}};function FP(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function rc(n){return n.name==="IndexedDbTransactionError"}var yw=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=o=>this.ie(o),this.se=o=>i.writeSequenceNumber(o))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Zh(n){return n==null}function zl(n){return n===0&&1/n==-1/0}function VP(n){return typeof n=="number"&&Number.isInteger(n)&&!zl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var NP=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],c2=[...NP,"documentOverlays"],BP=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],zP=BP,UP=[...zP,"indexConfiguration","indexState","indexEntries"];var u2=[...UP,"globals"];function zy(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Uo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ww(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var It=class n{constructor(e,t){this.comparator=e,this.root=t||Oi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Oi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qs(this.root,e,this.comparator,!1)}getReverseIterator(){return new qs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qs(this.root,e,this.comparator,!0)}},qs=class{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&o&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Oi=class n{constructor(e,t,i,o,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=o??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,s){return new n(e??this.key,t??this.value,i??this.color,o??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this,s=i(e,o.key);return o=s<0?o.copy(null,null,null,o.left.insert(e,t,i),null):s===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return n.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ee();let e=this.left.check();if(e!==this.right.check())throw Ee();return e+(this.isRed()?0:1)}};Oi.EMPTY=null,Oi.RED=!0,Oi.BLACK=!1;Oi.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee()}get value(){throw Ee()}get color(){throw Ee()}get left(){throw Ee()}get right(){throw Ee()}copy(e,t,i,o,s){return this}insert(e,t,i){return new Oi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var nn=class n{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vh(this.data.getIterator())}getIteratorFrom(e){return new vh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let o=t.getNext().key,s=i.getNext().key;if(this.comparator(o,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},vh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ti=class n{constructor(e){this.fields=e,e.sort(zn.comparator)}static empty(){return new n([])}unionWith(e){let t=new nn(zn.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zs(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var yh=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var rn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(o){try{return atob(o)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new yh("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(o){let s="";for(let l=0;l<o.length;++l)s+=String.fromCharCode(o[l]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};rn.EMPTY_BYTE_STRING=new rn("");var jP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mr(n){if(st(!!n),typeof n=="string"){let e=0,t=jP.exec(n);if(st(!!t),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:wt(n.seconds),nanos:wt(n.nanos)}}function wt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ur(n){return typeof n=="string"?rn.fromBase64String(n):rn.fromUint8Array(n)}function Qh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ag(n){let e=n.mapValue.fields.__previous_value__;return Qh(e)?Ag(e):e}function Ul(n){let e=mr(n.mapValue.fields.__local_write_time__.timestampValue);return new Dt(e.seconds,e.nanos)}var im=class{constructor(e,t,i,o,s,l,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m}},wh=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var hh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Vo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Qh(n)?4:bw(n)?9007199254740991:Cw(n)?10:11:Ee()}function Vi(n,e){if(n===e)return!0;let t=Vo(n);if(t!==Vo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ul(n).isEqual(Ul(e));case 3:return function(o,s){if(typeof o.timestampValue=="string"&&typeof s.timestampValue=="string"&&o.timestampValue.length===s.timestampValue.length)return o.timestampValue===s.timestampValue;let l=mr(o.timestampValue),h=mr(s.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,s){return Ur(o.bytesValue).isEqual(Ur(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,s){return wt(o.geoPointValue.latitude)===wt(s.geoPointValue.latitude)&&wt(o.geoPointValue.longitude)===wt(s.geoPointValue.longitude)}(n,e);case 2:return function(o,s){if("integerValue"in o&&"integerValue"in s)return wt(o.integerValue)===wt(s.integerValue);if("doubleValue"in o&&"doubleValue"in s){let l=wt(o.doubleValue),h=wt(s.doubleValue);return l===h?zl(l)===zl(h):isNaN(l)&&isNaN(h)}return!1}(n,e);case 9:return Zs(n.arrayValue.values||[],e.arrayValue.values||[],Vi);case 10:case 11:return function(o,s){let l=o.mapValue.fields||{},h=s.mapValue.fields||{};if(zy(l)!==zy(h))return!1;for(let d in l)if(l.hasOwnProperty(d)&&(h[d]===void 0||!Vi(l[d],h[d])))return!1;return!0}(n,e);default:return Ee()}}function jl(n,e){return(n.values||[]).find(t=>Vi(t,e))!==void 0}function Qs(n,e){if(n===e)return 0;let t=Vo(n),i=Vo(e);if(t!==i)return Ze(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ze(n.booleanValue,e.booleanValue);case 2:return function(s,l){let h=wt(s.integerValue||s.doubleValue),d=wt(l.integerValue||l.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1}(n,e);case 3:return Uy(n.timestampValue,e.timestampValue);case 4:return Uy(Ul(n),Ul(e));case 5:return Ze(n.stringValue,e.stringValue);case 6:return function(s,l){let h=Ur(s),d=Ur(l);return h.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(s,l){let h=s.split("/"),d=l.split("/");for(let m=0;m<h.length&&m<d.length;m++){let v=Ze(h[m],d[m]);if(v!==0)return v}return Ze(h.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,l){let h=Ze(wt(s.latitude),wt(l.latitude));return h!==0?h:Ze(wt(s.longitude),wt(l.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return jy(n.arrayValue,e.arrayValue);case 10:return function(s,l){var h,d,m,v;let w=s.fields||{},S=l.fields||{},A=(h=w.value)===null||h===void 0?void 0:h.arrayValue,F=(d=S.value)===null||d===void 0?void 0:d.arrayValue,j=Ze(((m=A?.values)===null||m===void 0?void 0:m.length)||0,((v=F?.values)===null||v===void 0?void 0:v.length)||0);return j!==0?j:jy(A,F)}(n.mapValue,e.mapValue);case 11:return function(s,l){if(s===hh.mapValue&&l===hh.mapValue)return 0;if(s===hh.mapValue)return 1;if(l===hh.mapValue)return-1;let h=s.fields||{},d=Object.keys(h),m=l.fields||{},v=Object.keys(m);d.sort(),v.sort();for(let w=0;w<d.length&&w<v.length;++w){let S=Ze(d[w],v[w]);if(S!==0)return S;let A=Qs(h[d[w]],m[v[w]]);if(A!==0)return A}return Ze(d.length,v.length)}(n.mapValue,e.mapValue);default:throw Ee()}}function Uy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ze(n,e);let t=mr(n),i=mr(e),o=Ze(t.seconds,i.seconds);return o!==0?o:Ze(t.nanos,i.nanos)}function jy(n,e){let t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){let s=Qs(t[o],i[o]);if(s)return s}return Ze(t.length,i.length)}function Ys(n){return rm(n)}function rm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=mr(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ur(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ve.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",o=!0;for(let s of t.values||[])o?o=!1:i+=",",i+=rm(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),o="{",s=!0;for(let l of i)s?s=!1:o+=",",o+=`${l}:${rm(t.fields[l])}`;return o+"}"}(n.mapValue):Ee()}function Ch(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function om(n){return!!n&&"integerValue"in n}function xg(n){return!!n&&"arrayValue"in n}function $y(n){return!!n&&"nullValue"in n}function qy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function fh(n){return!!n&&"mapValue"in n}function Cw(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Vl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Uo(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Vl(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function bw(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Bn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!fh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vl(t)}setAll(e){let t=zn.emptyPath(),i={},o=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){let d=this.getFieldsMap(t);this.applyChanges(d,i,o),i={},o=[],t=h.popLast()}l?i[h.lastSegment()]=Vl(l):o.push(h.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,o)}delete(e){let t=this.field(e.popLast());fh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];fh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Uo(t,(o,s)=>e[o]=s);for(let o of i)delete e[o]}clone(){return new n(Vl(this.value))}};function Ew(n){let e=[];return Uo(n.fields,(t,i)=>{let o=new zn([t]);if(fh(i)){let s=Ew(i.mapValue).fields;if(s.length===0)e.push(o);else for(let l of s)e.push(o.child(l))}else e.push(o)}),new ti(e)}var mi=class n{constructor(e,t,i,o,s,l,h){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=s,this.data=l,this.documentState=h}static newInvalidDocument(e){return new n(e,0,Me.min(),Me.min(),Me.min(),Bn.empty(),0)}static newFoundDocument(e,t,i,o){return new n(e,1,t,Me.min(),i,o,0)}static newNoDocument(e,t){return new n(e,2,t,Me.min(),Me.min(),Bn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Me.min(),Me.min(),Bn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var jr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Gy(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){let s=e[o],l=n.position[o];if(s.field.isKeyField()?i=ve.comparator(ve.fromName(l.referenceValue),t.key):i=Qs(l,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function Hy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Vi(n.position[t],e.position[t]))return!1;return!0}var No=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $P(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var bh=class{},Ot=class n extends bh{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new am(e,t,i):t==="array-contains"?new um(e,i):t==="in"?new hm(e,i):t==="not-in"?new dm(e,i):t==="array-contains-any"?new fm(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new lm(e,i):new cm(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Qs(t,this.value)):t!==null&&Vo(this.value)===Vo(t)&&this.matchesComparison(Qs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},gi=class n extends bh{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Sw(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Sw(n){return n.op==="and"}function Tw(n){return qP(n)&&Sw(n)}function qP(n){for(let e of n.filters)if(e instanceof gi)return!1;return!0}function sm(n){if(n instanceof Ot)return n.field.canonicalString()+n.op.toString()+Ys(n.value);if(Tw(n))return n.filters.map(e=>sm(e)).join(",");{let e=n.filters.map(t=>sm(t)).join(",");return`${n.op}(${e})`}}function Pw(n,e){return n instanceof Ot?function(i,o){return o instanceof Ot&&i.op===o.op&&i.field.isEqual(o.field)&&Vi(i.value,o.value)}(n,e):n instanceof gi?function(i,o){return o instanceof gi&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((s,l,h)=>s&&Pw(l,o.filters[h]),!0):!1}(n,e):void Ee()}function Dw(n){return n instanceof Ot?function(t){return`${t.field.canonicalString()} ${t.op} ${Ys(t.value)}`}(n):n instanceof gi?function(t){return t.op.toString()+" {"+t.getFilters().map(Dw).join(" ,")+"}"}(n):"Filter"}var am=class extends Ot{constructor(e,t,i){super(e,t,i),this.key=ve.fromName(i.referenceValue)}matches(e){let t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}},lm=class extends Ot{constructor(e,t){super(e,"in",t),this.keys=Iw("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},cm=class extends Ot{constructor(e,t){super(e,"not-in",t),this.keys=Iw("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Iw(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>ve.fromName(i.referenceValue))}var um=class extends Ot{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return xg(t)&&jl(t.arrayValue,this.value)}},hm=class extends Ot{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&jl(this.value.arrayValue,t)}},dm=class extends Ot{constructor(e,t){super(e,"not-in",t)}matches(e){if(jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!jl(this.value.arrayValue,t)}},fm=class extends Ot{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!xg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>jl(this.value.arrayValue,i))}};var pm=class{constructor(e,t=null,i=[],o=[],s=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=s,this.startAt=l,this.endAt=h,this.ue=null}};function Ky(n,e=null,t=[],i=[],o=null,s=null,l=null){return new pm(n,e,t,i,o,s,l)}function Mg(n){let e=De(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>sm(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Zh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Ys(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Ys(i)).join(",")),e.ue=t}return e.ue}function Rg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!$P(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Pw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Hy(n.startAt,e.startAt)&&Hy(n.endAt,e.endAt)}function mm(n){return ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var gr=class{constructor(e,t=null,i=[],o=[],s=null,l="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=s,this.limitType=l,this.startAt=h,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function GP(n,e,t,i,o,s,l,h){return new gr(n,e,t,i,o,s,l,h)}function Yh(n){return new gr(n)}function Wy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function kg(n){return n.collectionGroup!==null}function Gs(n){let e=De(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new nn(zn.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new No(s,i))}),t.has(zn.keyField().canonicalString())||e.ce.push(new No(zn.keyField(),i))}return e.ce}function Li(n){let e=De(n);return e.le||(e.le=HP(e,Gs(n))),e.le}function HP(n,e){if(n.limitType==="F")return Ky(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{let s=o.dir==="desc"?"asc":"desc";return new No(o.field,s)});let t=n.endAt?new jr(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new jr(n.startAt.position,n.startAt.inclusive):null;return Ky(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function gm(n,e){let t=n.filters.concat([e]);return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Eh(n,e,t){return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xh(n,e){return Rg(Li(n),Li(e))&&n.limitType===e.limitType}function Aw(n){return`${Mg(Li(n))}|lt:${n.limitType}`}function Us(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>Dw(o)).join(", ")}]`),Zh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>Ys(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>Ys(o)).join(",")),`Target(${i})`}(Li(n))}; limitType=${n.limitType})`}function Jh(n,e){return e.isFoundDocument()&&function(i,o){let s=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ve.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,o){for(let s of Gs(i))if(!s.field.isKeyField()&&o.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,o){for(let s of i.filters)if(!s.matches(o))return!1;return!0}(n,e)&&function(i,o){return!(i.startAt&&!function(l,h,d){let m=Gy(l,h,d);return l.inclusive?m<=0:m<0}(i.startAt,Gs(i),o)||i.endAt&&!function(l,h,d){let m=Gy(l,h,d);return l.inclusive?m>=0:m>0}(i.endAt,Gs(i),o))}(n,e)}function KP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function xw(n){return(e,t)=>{let i=!1;for(let o of Gs(n)){let s=WP(o,e,t);if(s!==0)return s;i=i||o.field.isKeyField()}return 0}}function WP(n,e,t){let i=n.field.isKeyField()?ve.comparator(e.key,t.key):function(s,l,h){let d=l.data.field(s),m=h.data.field(s);return d!==null&&m!==null?Qs(d,m):Ee()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ee()}}var $r=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[o,s]of i)if(this.equalsFn(o,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<o.length;s++)if(this.equalsFn(o[s][0],e))return void(o[s]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Uo(this.inner,(t,i)=>{for(let[o,s]of i)e(o,s)})}isEmpty(){return ww(this.inner)}size(){return this.innerSize}};var ZP=new It(ve.comparator);function _r(){return ZP}var Mw=new It(ve.comparator);function Fl(...n){let e=Mw;for(let t of n)e=e.insert(t.key,t);return e}function Rw(n){let e=Mw;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ro(){return Nl()}function kw(){return Nl()}function Nl(){return new $r(n=>n.toString(),(n,e)=>n.isEqual(e))}var QP=new It(ve.comparator),YP=new nn(ve.comparator);function ze(...n){let e=YP;for(let t of n)e=e.add(t);return e}var XP=new nn(Ze);function JP(){return XP}function Og(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zl(e)?"-0":e}}function Ow(n){return{integerValue:""+n}}function Lw(n,e){return VP(e)?Ow(e):Og(n,e)}var Xs=class{constructor(){this._=void 0}};function eD(n,e,t){return n instanceof Js?function(o,s){let l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return s&&Qh(s)&&(s=Ag(s)),s&&(l.fields.__previous_value__=s),{mapValue:l}}(t,e):n instanceof qr?Vw(n,e):n instanceof Gr?Nw(n,e):function(o,s){let l=Fw(o,s),h=Zy(l)+Zy(o.Pe);return om(l)&&om(o.Pe)?Ow(h):Og(o.serializer,h)}(n,e)}function tD(n,e,t){return n instanceof qr?Vw(n,e):n instanceof Gr?Nw(n,e):t}function Fw(n,e){return n instanceof Bo?function(i){return om(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var Js=class extends Xs{},qr=class extends Xs{constructor(e){super(),this.elements=e}};function Vw(n,e){let t=Bw(e);for(let i of n.elements)t.some(o=>Vi(o,i))||t.push(i);return{arrayValue:{values:t}}}var Gr=class extends Xs{constructor(e){super(),this.elements=e}};function Nw(n,e){let t=Bw(e);for(let i of n.elements)t=t.filter(o=>!Vi(o,i));return{arrayValue:{values:t}}}var Bo=class extends Xs{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Zy(n){return wt(n.integerValue||n.doubleValue)}function Bw(n){return xg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var $l=class{constructor(e,t){this.field=e,this.transform=t}};function nD(n,e){return n.field.isEqual(e.field)&&function(i,o){return i instanceof qr&&o instanceof qr||i instanceof Gr&&o instanceof Gr?Zs(i.elements,o.elements,Vi):i instanceof Bo&&o instanceof Bo?Vi(i.Pe,o.Pe):i instanceof Js&&o instanceof Js}(n.transform,e.transform)}var _m=class{constructor(e,t){this.version=e,this.transformResults=t}},fr=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ph(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ea=class{};function zw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ql(n.key,fr.none()):new zo(n.key,n.data,fr.none());{let t=n.data,i=Bn.empty(),o=new nn(zn.comparator);for(let s of e.fields)if(!o.has(s)){let l=t.field(s);l===null&&s.length>1&&(s=s.popLast(),l=t.field(s)),l===null?i.delete(s):i.set(s,l),o=o.add(s)}return new Ni(n.key,i,new ti(o.toArray()),fr.none())}}function iD(n,e,t){n instanceof zo?function(o,s,l){let h=o.value.clone(),d=Yy(o.fieldTransforms,s,l.transformResults);h.setAll(d),s.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(n,e,t):n instanceof Ni?function(o,s,l){if(!ph(o.precondition,s))return void s.convertToUnknownDocument(l.version);let h=Yy(o.fieldTransforms,s,l.transformResults),d=s.data;d.setAll(Uw(o)),d.setAll(h),s.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(n,e,t):function(o,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function Bl(n,e,t,i){return n instanceof zo?function(s,l,h,d){if(!ph(s.precondition,l))return h;let m=s.value.clone(),v=Xy(s.fieldTransforms,d,l);return m.setAll(v),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(n,e,t,i):n instanceof Ni?function(s,l,h,d){if(!ph(s.precondition,l))return h;let m=Xy(s.fieldTransforms,d,l),v=l.data;return v.setAll(Uw(s)),v.setAll(m),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),h===null?null:h.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(w=>w.field))}(n,e,t,i):function(s,l,h){return ph(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(n,e,t)}function rD(n,e){let t=null;for(let i of n.fieldTransforms){let o=e.data.field(i.field),s=Fw(i.transform,o||null);s!=null&&(t===null&&(t=Bn.empty()),t.set(i.field,s))}return t||null}function Qy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Zs(i,o,(s,l)=>nD(s,l))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var zo=class extends ea{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}},Ni=class extends ea{constructor(e,t,i,o,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Uw(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function Yy(n,e,t){let i=new Map;st(n.length===t.length);for(let o=0;o<t.length;o++){let s=n[o],l=s.transform,h=e.data.field(s.field);i.set(s.field,tD(l,h,t[o]))}return i}function Xy(n,e,t){let i=new Map;for(let o of n){let s=o.transform,l=t.data.field(o.field);i.set(o.field,eD(s,l,e))}return i}var ql=class extends ea{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},vm=class extends ea{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ym=class{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){let s=this.mutations[o];s.key.isEqual(e.key)&&iD(s,e,i[o])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Bl(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Bl(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=kw();return this.mutations.forEach(o=>{let s=e.get(o.key),l=s.overlayedDocument,h=this.applyToLocalView(l,s.mutatedFields);h=t.has(o.key)?null:h;let d=zw(l,h);d!==null&&i.set(o.key,d),l.isValidDocument()||l.convertToNoDocument(Me.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ze())}isEqual(e){return this.batchId===e.batchId&&Zs(this.mutations,e.mutations,(t,i)=>Qy(t,i))&&Zs(this.baseMutations,e.baseMutations,(t,i)=>Qy(t,i))}},wm=class n{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){st(e.mutations.length===i.length);let o=function(){return QP}(),s=e.mutations;for(let l=0;l<s.length;l++)o=o.insert(s[l].key,i[l].version);return new n(e,t,i,o)}};var Cm=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var bm=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Rt,$e;function oD(n){switch(n){default:return Ee();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0}}function jw(n){if(n===void 0)return pr("GRPC error has no .code"),G.UNKNOWN;switch(n){case Rt.OK:return G.OK;case Rt.CANCELLED:return G.CANCELLED;case Rt.UNKNOWN:return G.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return G.INTERNAL;case Rt.UNAVAILABLE:return G.UNAVAILABLE;case Rt.UNAUTHENTICATED:return G.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case Rt.NOT_FOUND:return G.NOT_FOUND;case Rt.ALREADY_EXISTS:return G.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return G.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case Rt.ABORTED:return G.ABORTED;case Rt.OUT_OF_RANGE:return G.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return G.UNIMPLEMENTED;case Rt.DATA_LOSS:return G.DATA_LOSS;default:return Ee()}}($e=Rt||(Rt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";var Jy=null;function sD(){return new TextEncoder}var aD=new Br([4294967295,4294967295],0);function ew(n){let e=sD().encode(n),t=new Np;return t.update(e),new Uint8Array(t.digest())}function tw(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Br([t,i],0),new Br([o,s],0)]}var Em=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ko(`Invalid padding: ${t}`);if(i<0)throw new ko(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ko(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ko(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Br.fromNumber(this.Ie)}Ee(e,t,i){let o=e.add(t.multiply(Br.fromNumber(i)));return o.compare(aD)===1&&(o=new Br([o.getBits(0),o.getBits(1)],0)),o.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=ew(e),[i,o]=tw(t);for(let s=0;s<this.hashCount;s++){let l=this.Ee(i,o,s);if(!this.de(l))return!1}return!0}static create(e,t,i){let o=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new n(s,o,t);return i.forEach(h=>l.insert(h)),l}insert(e){if(this.Ie===0)return;let t=ew(e),[i,o]=tw(t);for(let s=0;s<this.hashCount;s++){let l=this.Ee(i,o,s);this.Ae(l)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},ko=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Sh=class n{constructor(e,t,i,o,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let o=new Map;return o.set(e,Gl.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Me.min(),o,new It(Ze),_r(),ze())}},Gl=class n{constructor(e,t,i,o,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,ze(),ze(),ze())}};var Hs=class{constructor(e,t,i,o){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=o}},Th=class{constructor(e,t){this.targetId=e,this.me=t}},Ph=class{constructor(e,t,i=rn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}},Dh=class{constructor(){this.fe=0,this.ge=iw(),this.pe=rn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ze(),t=ze(),i=ze();return this.ge.forEach((o,s)=>{switch(s){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Ee()}}),new Gl(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=iw()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,st(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Sm=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=_r(),this.qe=nw(),this.Qe=new It(Ze)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:Ee()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,o)=>{this.ze(o)&&t(o)})}He(e){let t=e.targetId,i=e.me.count,o=this.Je(t);if(o){let s=o.target;if(mm(s))if(i===0){let l=new ve(s.path);this.Ue(t,l,mi.newNoDocument(l,Me.min()))}else st(i===1);else{let l=this.Ye(t);if(l!==i){let h=this.Ze(e),d=h?this.Xe(h,e,l):1;if(d!==0){this.je(t);let m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,m)}Jy?.et(function(v,w,S,A,F){var j,$,ee,oe,me,Ce;let pt={localCacheCount:v,existenceFilterCount:w.count,databaseId:S.database,projectId:S.projectId},Oe=w.unchangedNames;return Oe&&(pt.bloomFilter={applied:F===0,hashCount:(j=Oe?.hashCount)!==null&&j!==void 0?j:0,bitmapLength:(oe=(ee=($=Oe?.bits)===null||$===void 0?void 0:$.bitmap)===null||ee===void 0?void 0:ee.length)!==null&&oe!==void 0?oe:0,padding:(Ce=(me=Oe?.bits)===null||me===void 0?void 0:me.padding)!==null&&Ce!==void 0?Ce:0,mightContain:M=>{var E;return(E=A?.mightContain(M))!==null&&E!==void 0&&E}}),pt}(l,e.me,this.Le.tt(),h,d))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:o=0},hashCount:s=0}=t,l,h;try{l=Ur(i).toUint8Array()}catch(d){if(d instanceof yh)return Ws("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new Em(l,o,s)}catch(d){return Ws(d instanceof ko?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ie===0?null:h}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),o=0;return i.forEach(s=>{let l=this.Le.tt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(h)||(this.Ue(t,s,null),o++)}),o}rt(e){let t=new Map;this.Be.forEach((s,l)=>{let h=this.Je(l);if(h){if(s.current&&mm(h.target)){let d=new ve(h.target.path);this.ke.get(d)!==null||this.it(l,d)||this.Ue(l,d,mi.newNoDocument(d,e))}s.be&&(t.set(l,s.ve()),s.Ce())}});let i=ze();this.qe.forEach((s,l)=>{let h=!0;l.forEachWhile(d=>{let m=this.Je(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(s))}),this.ke.forEach((s,l)=>l.setReadTime(e));let o=new Sh(e,t,this.Qe,this.ke,i);return this.ke=_r(),this.qe=nw(),this.Qe=new It(Ze),o}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let o=this.Ge(e);this.it(e,t)?o.Fe(t,1):o.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Dh,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new nn(Ze),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||le("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Dh),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function nw(){return new It(ve.comparator)}function iw(){return new It(ve.comparator)}var lD={asc:"ASCENDING",desc:"DESCENDING"},cD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uD={and:"AND",or:"OR"},Tm=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Pm(n,e){return n.useProto3Json||Zh(e)?e:{value:e}}function Ih(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $w(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hD(n,e){return Ih(n,e.toTimestamp())}function Fi(n){return st(!!n),Me.fromTimestamp(function(t){let i=mr(t);return new Dt(i.seconds,i.nanos)}(n))}function Lg(n,e){return Dm(n,e).canonicalString()}function Dm(n,e){let t=function(o){return new Ct(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function qw(n){let e=Ct.fromString(n);return st(Zw(e)),e}function Im(n,e){return Lg(n.databaseId,e.path)}function qp(n,e){let t=qw(e);if(t.get(1)!==n.databaseId.projectId)throw new te(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new te(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ve(Hw(t))}function Gw(n,e){return Lg(n.databaseId,e)}function dD(n){let e=qw(n);return e.length===4?Ct.emptyPath():Hw(e)}function Am(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Hw(n){return st(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function rw(n,e,t){return{name:Im(n,e),fields:t.value.mapValue.fields}}function fD(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],s=function(m,v){return m.useProto3Json?(st(v===void 0||typeof v=="string"),rn.fromBase64String(v||"")):(st(v===void 0||v instanceof Buffer||v instanceof Uint8Array),rn.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){let v=m.code===void 0?G.UNKNOWN:jw(m.code);return new te(v,m.message||"")}(l);t=new Ph(i,o,s,h||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let o=qp(n,i.document.name),s=Fi(i.document.updateTime),l=i.document.createTime?Fi(i.document.createTime):Me.min(),h=new Bn({mapValue:{fields:i.document.fields}}),d=mi.newFoundDocument(o,s,l,h),m=i.targetIds||[],v=i.removedTargetIds||[];t=new Hs(m,v,d.key,d)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let o=qp(n,i.document),s=i.readTime?Fi(i.readTime):Me.min(),l=mi.newNoDocument(o,s),h=i.removedTargetIds||[];t=new Hs([],h,l.key,l)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let o=qp(n,i.document),s=i.removedTargetIds||[];t=new Hs([],s,o,null)}else{if(!("filter"in e))return Ee();{e.filter;let i=e.filter;i.targetId;let{count:o=0,unchangedNames:s}=i,l=new bm(o,s),h=i.targetId;t=new Th(h,l)}}return t}function pD(n,e){let t;if(e instanceof zo)t={update:rw(n,e.key,e.value)};else if(e instanceof ql)t={delete:Im(n,e.key)};else if(e instanceof Ni)t={update:rw(n,e.key,e.data),updateMask:ED(e.fieldMask)};else{if(!(e instanceof vm))return Ee();t={verify:Im(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,l){let h=l.transform;if(h instanceof Js)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof qr)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Gr)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Bo)return{fieldPath:l.field.canonicalString(),increment:h.Pe};throw Ee()}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,s){return s.updateTime!==void 0?{updateTime:hD(o,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ee()}(n,e.precondition)),t}function mD(n,e){return n&&n.length>0?(st(e!==void 0),n.map(t=>function(o,s){let l=o.updateTime?Fi(o.updateTime):Fi(s);return l.isEqual(Me.min())&&(l=Fi(s)),new _m(l,o.transformResults||[])}(t,e))):[]}function gD(n,e){return{documents:[Gw(n,e.path)]}}function _D(n,e){let t={structuredQuery:{}},i=e.path,o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Gw(n,o);let s=function(m){if(m.length!==0)return Ww(gi.create(m,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let l=function(m){if(m.length!==0)return m.map(v=>function(S){return{field:js(S.field),direction:wD(S.dir)}}(v))}(e.orderBy);l&&(t.structuredQuery.orderBy=l);let h=Pm(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{_t:t,parent:o}}function vD(n){let e=dD(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,o=null;if(i>0){st(i===1);let v=t.from[0];v.allDescendants?o=v.collectionId:e=e.child(v.collectionId)}let s=[];t.where&&(s=function(w){let S=Kw(w);return S instanceof gi&&Tw(S)?S.getFilters():[S]}(t.where));let l=[];t.orderBy&&(l=function(w){return w.map(S=>function(F){return new No($s(F.field),function($){switch($){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(F.direction))}(S))}(t.orderBy));let h=null;t.limit&&(h=function(w){let S;return S=typeof w=="object"?w.value:w,Zh(S)?null:S}(t.limit));let d=null;t.startAt&&(d=function(w){let S=!!w.before,A=w.values||[];return new jr(A,S)}(t.startAt));let m=null;return t.endAt&&(m=function(w){let S=!w.before,A=w.values||[];return new jr(A,S)}(t.endAt)),GP(e,o,l,s,h,"F",d,m)}function yD(n,e){let t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Kw(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=$s(t.unaryFilter.field);return Ot.create(i,"==",{doubleValue:NaN});case"IS_NULL":let o=$s(t.unaryFilter.field);return Ot.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=$s(t.unaryFilter.field);return Ot.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let l=$s(t.unaryFilter.field);return Ot.create(l,"!=",{nullValue:"NULL_VALUE"});default:return Ee()}}(n):n.fieldFilter!==void 0?function(t){return Ot.create($s(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ee()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return gi.create(t.compositeFilter.filters.map(i=>Kw(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ee()}}(t.compositeFilter.op))}(n):Ee()}function wD(n){return lD[n]}function CD(n){return cD[n]}function bD(n){return uD[n]}function js(n){return{fieldPath:n.canonicalString()}}function $s(n){return zn.fromServerFormat(n.fieldPath)}function Ww(n){return n instanceof Ot?function(t){if(t.op==="=="){if(qy(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NAN"}};if($y(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(qy(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NOT_NAN"}};if($y(t.value))return{unaryFilter:{field:js(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:js(t.field),op:CD(t.op),value:t.value}}}(n):n instanceof gi?function(t){let i=t.getFilters().map(o=>Ww(o));return i.length===1?i[0]:{compositeFilter:{op:bD(t.op),filters:i}}}(n):Ee()}function ED(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Zw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Hl=class n{constructor(e,t,i,o,s=Me.min(),l=Me.min(),h=rn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var xm=class{constructor(e){this.ct=e}};function SD(n){let e=vD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Eh(e,e.limit,"L"):e}var Ah=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(wt(e.integerValue));else if("doubleValue"in e){let i=wt(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),zl(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=mr(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ur(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?bw(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Cw(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ee()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let o of Object.keys(i))this.Vt(o,t),this.Tt(i[o],t)}wt(e,t){var i,o;let s=e.fields||{};this.dt(t,53);let l="value",h=((o=(i=s[l].arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.length)||0;this.dt(t,15),t.At(wt(h)),this.Vt(l,t),this.Tt(s[l],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let o of i)this.Tt(o,t)}yt(e,t){this.dt(t,37),ve.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ah.vt=new Ah;var Mm=class{constructor(){this.un=new Rm}addToCollectionParentIndex(e,t){return this.un.add(t),Q.resolve()}getCollectionParents(e,t){return Q.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Q.resolve()}deleteFieldIndex(e,t){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,t){return Q.resolve()}getDocumentsMatchingTarget(e,t){return Q.resolve(null)}getIndexType(e,t){return Q.resolve(0)}getFieldIndexes(e,t){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,t){return Q.resolve(Fo.min())}getMinOffsetFromCollectionGroup(e,t){return Q.resolve(Fo.min())}updateCollectionGroup(e,t,i){return Q.resolve()}updateIndexEntries(e,t){return Q.resolve()}},Rm=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new nn(Ct.comparator),s=!o.has(i);return this.index[t]=o.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new nn(Ct.comparator)).toArray()}};var d2=new Uint8Array(0);var ki=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};ki.DEFAULT_COLLECTION_PERCENTILE=10,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ki.DEFAULT=new ki(41943040,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ki.DISABLED=new ki(-1,0,0);var Kl=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var km=class{constructor(){this.changes=new $r(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?Q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Om=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Lm=class{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&Bl(i.mutation,o,ti.empty(),Dt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ze()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ze()){let o=Ro();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(s=>{let l=Fl();return s.forEach((h,d)=>{l=l.insert(h,d.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){let i=Ro();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ze()))}populateOverlays(e,t,i){let o=[];return i.forEach(s=>{t.has(s)||o.push(s)}),this.documentOverlayCache.getOverlays(e,o).next(s=>{s.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,i,o){let s=_r(),l=Nl(),h=function(){return Nl()}();return t.forEach((d,m)=>{let v=i.get(m.key);o.has(m.key)&&(v===void 0||v.mutation instanceof Ni)?s=s.insert(m.key,m):v!==void 0?(l.set(m.key,v.mutation.getFieldMask()),Bl(v.mutation,m,v.mutation.getFieldMask(),Dt.now())):l.set(m.key,ti.empty())}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((m,v)=>l.set(m,v)),t.forEach((m,v)=>{var w;return h.set(m,new Om(v,(w=l.get(m))!==null&&w!==void 0?w:null))}),h))}recalculateAndSaveOverlays(e,t){let i=Nl(),o=new It((l,h)=>l-h),s=ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(let h of l)h.keys().forEach(d=>{let m=t.get(d);if(m===null)return;let v=i.get(d)||ti.empty();v=h.applyToLocalView(m,v),i.set(d,v);let w=(o.get(h.batchId)||ze()).add(d);o=o.insert(h.batchId,w)})}).next(()=>{let l=[],h=o.getReverseIterator();for(;h.hasNext();){let d=h.getNext(),m=d.key,v=d.value,w=kw();v.forEach(S=>{if(!s.has(S)){let A=zw(t.get(S),i.get(S));A!==null&&w.set(S,A),s=s.add(S)}}),l.push(this.documentOverlayCache.saveOverlays(e,m,w))}return Q.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(l){return ve.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):kg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(s=>{let l=o-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-s.size):Q.resolve(Ro()),h=-1,d=s;return l.next(m=>Q.forEach(m,(v,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),s.get(v)?Q.resolve():this.remoteDocumentCache.getEntry(e,v).next(S=>{d=d.insert(v,S)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,d,m,ze())).next(v=>({batchId:h,changes:Rw(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next(i=>{let o=Fl();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){let s=t.collectionGroup,l=Fl();return this.indexManager.getCollectionParents(e,s).next(h=>Q.forEach(h,d=>{let m=function(w,S){return new gr(S,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(t,d.child(s));return this.getDocumentsMatchingCollectionQuery(e,m,i,o).next(v=>{v.forEach((w,S)=>{l=l.insert(w,S)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,i,o){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,o))).next(l=>{s.forEach((d,m)=>{let v=m.getKey();l.get(v)===null&&(l=l.insert(v,mi.newInvalidDocument(v)))});let h=Fl();return l.forEach((d,m)=>{let v=s.get(d);v!==void 0&&Bl(v.mutation,m,ti.empty(),Dt.now()),Jh(t,m)&&(h=h.insert(d,m))}),h})}};var Fm=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Q.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Fi(o.createTime)}}(t)),Q.resolve()}getNamedQuery(e,t){return Q.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(o){return{name:o.name,query:SD(o.bundledQuery),readTime:Fi(o.readTime)}}(t)),Q.resolve()}};var Vm=class{constructor(){this.overlays=new It(ve.comparator),this.Ir=new Map}getOverlay(e,t){return Q.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Ro();return Q.forEach(t,o=>this.getOverlay(e,o).next(s=>{s!==null&&i.set(o,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,s)=>{this.ht(e,t,s)}),Q.resolve()}removeOverlaysForBatchId(e,t,i){let o=this.Ir.get(i);return o!==void 0&&(o.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),Q.resolve()}getOverlaysForCollection(e,t,i){let o=Ro(),s=t.length+1,l=new ve(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){let d=h.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&d.largestBatchId>i&&o.set(d.getKey(),d)}return Q.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let s=new It((m,v)=>m-v),l=this.overlays.getIterator();for(;l.hasNext();){let m=l.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let v=s.get(m.largestBatchId);v===null&&(v=Ro(),s=s.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}let h=Ro(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,v)=>h.set(m,v)),!(h.size()>=o)););return Q.resolve(h)}ht(e,t,i){let o=this.overlays.get(i.key);if(o!==null){let l=this.Ir.get(o.largestBatchId).delete(i.key);this.Ir.set(o.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new Cm(t,i));let s=this.Ir.get(t);s===void 0&&(s=ze(),this.Ir.set(t,s)),this.Ir.set(t,s.add(i.key))}};var Nm=class{constructor(){this.sessionToken=rn.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Q.resolve()}};var Wl=class{constructor(){this.Tr=new nn(kt.Er),this.dr=new nn(kt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new kt(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new kt(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new ve(new Ct([])),i=new kt(t,e),o=new kt(t,e+1),s=[];return this.dr.forEachInRange([i,o],l=>{this.Vr(l),s.push(l.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new ve(new Ct([])),i=new kt(t,e),o=new kt(t,e+1),s=ze();return this.dr.forEachInRange([i,o],l=>{s=s.add(l.key)}),s}containsKey(e){let t=new kt(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},kt=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ve.comparator(e.key,t.key)||Ze(e.wr,t.wr)}static Ar(e,t){return Ze(e.wr,t.wr)||ve.comparator(e.key,t.key)}};var Bm=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new nn(kt.Er)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let l=new ym(s,t,i,o);this.mutationQueue.push(l);for(let h of o)this.br=this.br.add(new kt(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Q.resolve(l)}lookupMutationBatch(e,t){return Q.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,o=this.vr(i),s=o<0?0:o;return Q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new kt(t,0),o=new kt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,o],l=>{let h=this.Dr(l.wr);s.push(h)}),Q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new nn(Ze);return t.forEach(o=>{let s=new kt(o,0),l=new kt(o,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,l],h=>{i=i.add(h.wr)})}),Q.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,o=i.length+1,s=i;ve.isDocumentKey(s)||(s=s.child(""));let l=new kt(new ve(s),0),h=new nn(Ze);return this.br.forEachWhile(d=>{let m=d.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(h=h.add(d.wr)),!0)},l),Q.resolve(this.Cr(h))}Cr(e){let t=[];return e.forEach(i=>{let o=this.Dr(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){st(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return Q.forEach(t.mutations,o=>{let s=new kt(o.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new kt(t,0),o=this.br.firstAfterOrEqual(i);return Q.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var zm=class{constructor(e){this.Mr=e,this.docs=function(){return new It(ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,o=this.docs.get(i),s=o?o.size:0,l=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return Q.resolve(i?i.document.mutableCopy():mi.newInvalidDocument(t))}getEntries(e,t){let i=_r();return t.forEach(o=>{let s=this.docs.get(o);i=i.insert(o,s?s.document.mutableCopy():mi.newInvalidDocument(o))}),Q.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let s=_r(),l=t.path,h=new ve(l.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){let{key:m,value:{document:v}}=d.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||OP(kP(v),i)<=0||(o.has(v.key)||Jh(t,v))&&(s=s.insert(v.key,v.mutableCopy()))}return Q.resolve(s)}getAllFromCollectionGroup(e,t,i,o){Ee()}Or(e,t){return Q.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Um(this)}getSize(e){return Q.resolve(this.size)}},Um=class extends km{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.cr.addEntry(e,o)):this.cr.removeEntry(i)}),Q.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var jm=class{constructor(e){this.persistence=e,this.Nr=new $r(t=>Mg(t),Rg),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Wl,this.targetCount=0,this.kr=Kl.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,o)=>t(o)),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),Q.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Kl(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Q.resolve()}updateTargetData(e,t){return this.Kn(t),Q.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,t,i){let o=0,s=[];return this.Nr.forEach((l,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.Nr.delete(l),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),o++)}),Q.waitFor(s).next(()=>o)}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return Q.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),Q.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let o=this.persistence.referenceDelegate,s=[];return o&&t.forEach(l=>{s.push(o.markPotentiallyOrphaned(e,l))}),Q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Q.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return Q.resolve(i)}containsKey(e,t){return Q.resolve(this.Br.containsKey(t))}};var $m=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new yw(0),this.Kr=!1,this.Kr=!0,this.$r=new Nm,this.referenceDelegate=e(this),this.Ur=new jm(this),this.indexManager=new Mm,this.remoteDocumentCache=function(o){return new zm(o)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new xm(t),this.Gr=new Fm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Vm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new Bm(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){le("MemoryPersistence","Starting transaction:",e);let o=new qm(this.Qr.next());return this.referenceDelegate.zr(),i(o).next(s=>this.referenceDelegate.jr(o).next(()=>s)).toPromise().then(s=>(o.raiseOnCommittedEvent(),s))}Hr(e,t){return Q.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},qm=class extends nm{constructor(e){super(),this.currentSequenceNumber=e}},Gm=class n{constructor(e){this.persistence=e,this.Jr=new Wl,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw Ee()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),Q.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),Q.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Q.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(o=>this.Xr.add(o.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.Xr,i=>{let o=ve.fromPath(i);return this.ei(e,o).next(s=>{s||t.removeEntry(o,Me.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return Q.or([()=>Q.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Hm=class n{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=o}static Wi(e,t){let i=ze(),o=ze();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:o=o.add(s.doc.key)}return new n(e,t.fromCache,i,o)}};var Km=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Wm=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return p0()?8:FP(f0())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,o){let s={result:null};return this.Yi(e,t).next(l=>{s.result=l}).next(()=>{if(!s.result)return this.Zi(e,t,o,i).next(l=>{s.result=l})}).next(()=>{if(s.result)return;let l=new Km;return this.Xi(e,t,l).next(h=>{if(s.result=h,this.zi)return this.es(e,t,l,h.size)})}).next(()=>s.result)}es(e,t,i,o){return i.documentReadCount<this.ji?(Ll()<=nr.DEBUG&&le("QueryEngine","SDK will not create cache indexes for query:",Us(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Q.resolve()):(Ll()<=nr.DEBUG&&le("QueryEngine","Query:",Us(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.Hi*o?(Ll()<=nr.DEBUG&&le("QueryEngine","The SDK decides to create cache indexes for query:",Us(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Li(t))):Q.resolve())}Yi(e,t){if(Wy(t))return Q.resolve(null);let i=Li(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Eh(t,null,"F"),i=Li(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let l=ze(...s);return this.Ji.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,i).next(d=>{let m=this.ts(t,h);return this.ns(t,m,l,d.readTime)?this.Yi(e,Eh(t,null,"F")):this.rs(e,m,t,d)}))})))}Zi(e,t,i,o){return Wy(t)||o.isEqual(Me.min())?Q.resolve(null):this.Ji.getDocuments(e,i).next(s=>{let l=this.ts(t,s);return this.ns(t,l,i,o)?Q.resolve(null):(Ll()<=nr.DEBUG&&le("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Us(t)),this.rs(e,l,t,RP(o,-1)).next(h=>h))})}ts(e,t){let i=new nn(xw(e));return t.forEach((o,s)=>{Jh(e,s)&&(i=i.add(s))}),i}ns(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(o)>0)}Xi(e,t,i){return Ll()<=nr.DEBUG&&le("QueryEngine","Using full collection scan to execute query:",Us(t)),this.Ji.getDocumentsMatchingQuery(e,t,Fo.min(),i)}rs(e,t,i,o){return this.Ji.getDocumentsMatchingQuery(e,i,o).next(s=>(t.forEach(l=>{s=s.insert(l.key,l)}),s))}};var Zm=class{constructor(e,t,i,o){this.persistence=e,this.ss=t,this.serializer=o,this.os=new It(Ze),this._s=new $r(s=>Mg(s),Rg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lm(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function TD(n,e,t,i){return new Zm(n,e,t,i)}function Qw(n,e){return q(this,null,function*(){let t=De(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(s=>(o=s,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let l=[],h=[],d=ze();for(let m of o){l.push(m.batchId);for(let v of m.mutations)d=d.add(v.key)}for(let m of s){h.push(m.batchId);for(let v of m.mutations)d=d.add(v.key)}return t.localDocuments.getDocuments(i,d).next(m=>({hs:m,removedBatchIds:l,addedBatchIds:h}))})})})}function PD(n,e){let t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let o=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(h,d,m,v){let w=m.batch,S=w.keys(),A=Q.resolve();return S.forEach(F=>{A=A.next(()=>v.getEntry(d,F)).next(j=>{let $=m.docVersions.get(F);st($!==null),j.version.compareTo($)<0&&(w.applyToRemoteDocument(j,m),j.isValidDocument()&&(j.setReadTime(m.commitVersion),v.addEntry(j)))})}),A.next(()=>h.mutationQueue.removeMutationBatch(d,w))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let d=ze();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(d=d.add(h.batch.mutations[m].key));return d}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function Yw(n){let e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function DD(n,e){let t=De(n),i=e.snapshotVersion,o=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let l=t.cs.newChangeBuffer({trackRemovals:!0});o=t.os;let h=[];e.targetChanges.forEach((v,w)=>{let S=o.get(w);if(!S)return;h.push(t.Ur.removeMatchingKeys(s,v.removedDocuments,w).next(()=>t.Ur.addMatchingKeys(s,v.addedDocuments,w)));let A=S.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(w)!==null?A=A.withResumeToken(rn.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):v.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(v.resumeToken,i)),o=o.insert(w,A),function(j,$,ee){return j.resumeToken.approximateByteSize()===0||$.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:ee.addedDocuments.size+ee.modifiedDocuments.size+ee.removedDocuments.size>0}(S,A,v)&&h.push(t.Ur.updateTargetData(s,A))});let d=_r(),m=ze();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(s,v))}),h.push(ID(s,l,e.documentUpdates).next(v=>{d=v.Ps,m=v.Is})),!i.isEqual(Me.min())){let v=t.Ur.getLastRemoteSnapshotVersion(s).next(w=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));h.push(v)}return Q.waitFor(h).next(()=>l.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,m)).next(()=>d)}).then(s=>(t.os=o,s))}function ID(n,e,t){let i=ze(),o=ze();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let l=_r();return t.forEach((h,d)=>{let m=s.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(h)),d.isNoDocument()&&d.version.isEqual(Me.min())?(e.removeEntry(h,d.readTime),l=l.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),l=l.insert(h,d)):le("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)}),{Ps:l,Is:o}})}function AD(n,e){let t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function xD(n,e){let t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Ur.getTargetData(i,e).next(s=>s?(o=s,Q.resolve(o)):t.Ur.allocateTargetId(i).next(l=>(o=new Hl(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,o).next(()=>o))))}).then(i=>{let o=t.os.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function Qm(n,e,t){return q(this,null,function*(){let i=De(n),o=i.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,l=>i.persistence.referenceDelegate.removeTarget(l,o)))}catch(l){if(!rc(l))throw l;le("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}i.os=i.os.remove(e),i._s.delete(o.target)})}function ow(n,e,t){let i=De(n),o=Me.min(),s=ze();return i.persistence.runTransaction("Execute query","readwrite",l=>function(d,m,v){let w=De(d),S=w._s.get(v);return S!==void 0?Q.resolve(w.os.get(S)):w.Ur.getTargetData(m,v)}(i,l,Li(e)).next(h=>{if(h)return o=h.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(l,h.targetId).next(d=>{s=d})}).next(()=>i.ss.getDocumentsMatchingQuery(l,e,t?o:Me.min(),t?s:ze())).next(h=>(MD(i,KP(e),h),{documents:h,Ts:s})))}function MD(n,e,t){let i=n.us.get(e)||Me.min();t.forEach((o,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(e,i)}var xh=class{constructor(){this.activeTargetIds=JP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Ym=class{constructor(){this.so=new xh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new xh,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Xm=class{_o(e){}shutdown(){}};var Mh=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){le("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){le("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var dh=null;function Gp(){return dh===null?dh=function(){return 268435456+Math.round(2147483648*Math.random())}():dh++,"0x"+dh.toString(16)}var RD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Jm=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var tn="WebChannelConnection",eg=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${o}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${o}`:`project_id=${o}&database_id=${s}`}get Fo(){return!1}Mo(t,i,o,s,l){let h=Gp(),d=this.xo(t,i.toUriEncodedString());le("RestConnection",`Sending RPC '${t}' ${h}:`,d,o);let m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,s,l),this.No(t,d,m,o).then(v=>(le("RestConnection",`Received RPC '${t}' ${h}: `,v),v),v=>{throw Ws("RestConnection",`RPC '${t}' ${h} failed with error: `,v,"url: ",d,"request:",o),v})}Lo(t,i,o,s,l,h){return this.Mo(t,i,o,s,l)}Oo(t,i,o){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+oa}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,l)=>t[l]=s),o&&o.headers.forEach((s,l)=>t[l]=s)}xo(t,i){let o=RD[t];return`${this.Do}/v1/${i}:${o}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,o){let s=Gp();return new Promise((l,h)=>{let d=new Bp;d.setWithCredentials(!0),d.listenOnce(zp.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ol.NO_ERROR:let v=d.getResponseJson();le(tn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(v)),l(v);break;case Ol.TIMEOUT:le(tn,`RPC '${e}' ${s} timed out`),h(new te(G.DEADLINE_EXCEEDED,"Request time out"));break;case Ol.HTTP_ERROR:let w=d.getStatus();if(le(tn,`RPC '${e}' ${s} failed with status:`,w,"response text:",d.getResponseText()),w>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let A=S?.error;if(A&&A.status&&A.message){let F=function($){let ee=$.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(ee)>=0?ee:G.UNKNOWN}(A.status);h(new te(F,A.message))}else h(new te(G.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new te(G.UNAVAILABLE,"Connection failed."));break;default:Ee()}}finally{le(tn,`RPC '${e}' ${s} completed.`)}});let m=JSON.stringify(o);le(tn,`RPC '${e}' ${s} sending request:`,o),d.send(t,"POST",m,i,15)})}Bo(e,t,i){let o=Gp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=$p(),h=jp(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;let v=s.join("");le(tn,`Creating RPC '${e}' stream ${o}: ${v}`,d);let w=l.createWebChannel(v,d),S=!1,A=!1,F=new Jm({Io:$=>{A?le(tn,`Not sending because RPC '${e}' stream ${o} is closed:`,$):(S||(le(tn,`Opening RPC '${e}' stream ${o} transport.`),w.open(),S=!0),le(tn,`RPC '${e}' stream ${o} sending:`,$),w.send($))},To:()=>w.close()}),j=($,ee,oe)=>{$.listen(ee,me=>{try{oe(me)}catch(Ce){setTimeout(()=>{throw Ce},0)}})};return j(w,zs.EventType.OPEN,()=>{A||(le(tn,`RPC '${e}' stream ${o} transport opened.`),F.yo())}),j(w,zs.EventType.CLOSE,()=>{A||(A=!0,le(tn,`RPC '${e}' stream ${o} transport closed`),F.So())}),j(w,zs.EventType.ERROR,$=>{A||(A=!0,Ws(tn,`RPC '${e}' stream ${o} transport errored:`,$),F.So(new te(G.UNAVAILABLE,"The operation could not be completed")))}),j(w,zs.EventType.MESSAGE,$=>{var ee;if(!A){let oe=$.data[0];st(!!oe);let me=oe,Ce=me.error||((ee=me[0])===null||ee===void 0?void 0:ee.error);if(Ce){le(tn,`RPC '${e}' stream ${o} received error:`,Ce);let pt=Ce.status,Oe=function(T){let x=Rt[T];if(x!==void 0)return jw(x)}(pt),M=Ce.message;Oe===void 0&&(Oe=G.INTERNAL,M="Unknown error status: "+pt+" with message "+Ce.message),A=!0,F.So(new te(Oe,M)),w.close()}else le(tn,`RPC '${e}' stream ${o} received:`,oe),F.bo(oe)}}),j(h,Up.STAT_EVENT,$=>{$.stat===uh.PROXY?le(tn,`RPC '${e}' stream ${o} detected buffering proxy`):$.stat===uh.NOPROXY&&le(tn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{F.wo()},0),F}};function Hp(){return typeof document<"u"?document:null}function ed(n){return new Tm(n,!0)}var Rh=class{constructor(e,t,i=1e3,o=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=o,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),o=Math.max(0,t-i);o>0&&le("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,o,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var kh=class{constructor(e,t,i,o,s,l,h,d){this.ui=e,this.Ho=i,this.Jo=o,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Rh(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return q(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return q(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return q(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===G.RESOURCE_EXHAUSTED?(pr(t.toString()),pr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.Yo===t&&this.P_(i,o)},i=>{e(()=>{let o=new te(G.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(o)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(o=>{i(()=>this.I_(o))}),this.stream.onMessage(o=>{i(()=>++this.e_==1?this.E_(o):this.onNext(o))})}i_(){this.state=5,this.t_.Go(()=>q(this,null,function*(){this.state=0,this.start()}))}I_(e){return le("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(le("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},tg=class extends kh{constructor(e,t,i,o,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,l),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=fD(this.serializer,e),i=function(s){if(!("targetChange"in s))return Me.min();let l=s.targetChange;return l.targetIds&&l.targetIds.length?Me.min():l.readTime?Fi(l.readTime):Me.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=Am(this.serializer),t.addTarget=function(s,l){let h,d=l.target;if(h=mm(d)?{documents:gD(s,d)}:{query:_D(s,d)._t},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=$w(s,l.resumeToken);let m=Pm(s,l.expectedCount);m!==null&&(h.expectedCount=m)}else if(l.snapshotVersion.compareTo(Me.min())>0){h.readTime=Ih(s,l.snapshotVersion.toTimestamp());let m=Pm(s,l.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,e);let i=yD(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=Am(this.serializer),t.removeTarget=e,this.a_(t)}},ng=class extends kh{constructor(e,t,i,o,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,l),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return st(!!e.streamToken),this.lastStreamToken=e.streamToken,st(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){st(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=mD(e.writeResults,e.commitTime),i=Fi(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=Am(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>pD(this.serializer,i))};this.a_(t)}};var ig=class extends class{}{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.y_=!1}w_(){if(this.y_)throw new te(G.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Mo(e,Dm(t,i),o,s,l)).catch(s=>{throw s.name==="FirebaseError"?(s.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new te(G.UNKNOWN,s.toString())})}Lo(e,t,i,o,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Lo(e,Dm(t,i),o,l,h,s)).catch(l=>{throw l.name==="FirebaseError"?(l.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new te(G.UNKNOWN,l.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},rg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(pr(t),this.D_=!1):le("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var og=class{constructor(e,t,i,o,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(l=>{i.enqueueAndForget(()=>q(this,null,function*(){jo(this)&&(le("RemoteStore","Restarting streams for network reachability change."),yield function(d){return q(this,null,function*(){let m=De(d);m.L_.add(4),yield oc(m),m.q_.set("Unknown"),m.L_.delete(4),yield td(m)})}(this))}))}),this.q_=new rg(i,o)}};function td(n){return q(this,null,function*(){if(jo(n))for(let e of n.B_)yield e(!0)})}function oc(n){return q(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Xw(n,e){let t=De(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Bg(t)?Ng(t):sa(t).r_()&&Vg(t,e))}function Fg(n,e){let t=De(n),i=sa(t);t.N_.delete(e),i.r_()&&Jw(t,e),t.N_.size===0&&(i.r_()?i.o_():jo(t)&&t.q_.set("Unknown"))}function Vg(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sa(n).A_(e)}function Jw(n,e){n.Q_.xe(e),sa(n).R_(e)}function Ng(n){n.Q_=new Sm({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),sa(n).start(),n.q_.v_()}function Bg(n){return jo(n)&&!sa(n).n_()&&n.N_.size>0}function jo(n){return De(n).L_.size===0}function e1(n){n.Q_=void 0}function kD(n){return q(this,null,function*(){n.q_.set("Online")})}function OD(n){return q(this,null,function*(){n.N_.forEach((e,t)=>{Vg(n,e)})})}function LD(n,e){return q(this,null,function*(){e1(n),Bg(n)?(n.q_.M_(e),Ng(n)):n.q_.set("Unknown")})}function FD(n,e,t){return q(this,null,function*(){if(n.q_.set("Online"),e instanceof Ph&&e.state===2&&e.cause)try{yield function(o,s){return q(this,null,function*(){let l=s.cause;for(let h of s.targetIds)o.N_.has(h)&&(yield o.remoteSyncer.rejectListen(h,l),o.N_.delete(h),o.Q_.removeTarget(h))})}(n,e)}catch(i){le("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Oh(n,i)}else if(e instanceof Hs?n.Q_.Ke(e):e instanceof Th?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Me.min()))try{let i=yield Yw(n.localStore);t.compareTo(i)>=0&&(yield function(s,l){let h=s.Q_.rt(l);return h.targetChanges.forEach((d,m)=>{if(d.resumeToken.approximateByteSize()>0){let v=s.N_.get(m);v&&s.N_.set(m,v.withResumeToken(d.resumeToken,l))}}),h.targetMismatches.forEach((d,m)=>{let v=s.N_.get(d);if(!v)return;s.N_.set(d,v.withResumeToken(rn.EMPTY_BYTE_STRING,v.snapshotVersion)),Jw(s,d);let w=new Hl(v.target,d,m,v.sequenceNumber);Vg(s,w)}),s.remoteSyncer.applyRemoteEvent(h)}(n,t))}catch(i){le("RemoteStore","Failed to raise snapshot:",i),yield Oh(n,i)}})}function Oh(n,e,t){return q(this,null,function*(){if(!rc(e))throw e;n.L_.add(1),yield oc(n),n.q_.set("Offline"),t||(t=()=>Yw(n.localStore)),n.asyncQueue.enqueueRetryable(()=>q(this,null,function*(){le("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield td(n)}))})}function t1(n,e){return e().catch(t=>Oh(n,t,e))}function nd(n){return q(this,null,function*(){let e=De(n),t=Hr(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;VD(e);)try{let o=yield AD(e.localStore,i);if(o===null){e.O_.length===0&&t.o_();break}i=o.batchId,ND(e,o)}catch(o){yield Oh(e,o)}n1(e)&&i1(e)})}function VD(n){return jo(n)&&n.O_.length<10}function ND(n,e){n.O_.push(e);let t=Hr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function n1(n){return jo(n)&&!Hr(n).n_()&&n.O_.length>0}function i1(n){Hr(n).start()}function BD(n){return q(this,null,function*(){Hr(n).p_()})}function zD(n){return q(this,null,function*(){let e=Hr(n);for(let t of n.O_)e.m_(t.mutations)})}function UD(n,e,t){return q(this,null,function*(){let i=n.O_.shift(),o=wm.from(i,e,t);yield t1(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),yield nd(n)})}function jD(n,e){return q(this,null,function*(){e&&Hr(n).V_&&(yield function(i,o){return q(this,null,function*(){if(function(l){return oD(l)&&l!==G.ABORTED}(o.code)){let s=i.O_.shift();Hr(i).s_(),yield t1(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,o)),yield nd(i)}})}(n,e)),n1(n)&&i1(n)})}function sw(n,e){return q(this,null,function*(){let t=De(n);t.asyncQueue.verifyOperationInProgress(),le("RemoteStore","RemoteStore received new credentials");let i=jo(t);t.L_.add(3),yield oc(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield td(t)})}function $D(n,e){return q(this,null,function*(){let t=De(n);e?(t.L_.delete(2),yield td(t)):e||(t.L_.add(2),yield oc(t),t.q_.set("Unknown"))})}function sa(n){return n.K_||(n.K_=function(t,i,o){let s=De(t);return s.w_(),new tg(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)}(n.datastore,n.asyncQueue,{Eo:kD.bind(null,n),Ro:OD.bind(null,n),mo:LD.bind(null,n),d_:FD.bind(null,n)}),n.B_.push(e=>q(this,null,function*(){e?(n.K_.s_(),Bg(n)?Ng(n):n.q_.set("Unknown")):(yield n.K_.stop(),e1(n))}))),n.K_}function Hr(n){return n.U_||(n.U_=function(t,i,o){let s=De(t);return s.w_(),new ng(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:BD.bind(null,n),mo:jD.bind(null,n),f_:zD.bind(null,n),g_:UD.bind(null,n)}),n.B_.push(e=>q(this,null,function*(){e?(n.U_.s_(),yield nd(n)):(yield n.U_.stop(),n.O_.length>0&&(le("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var sg=class n{constructor(e,t,i,o,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=s,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,s){let l=Date.now()+i,h=new n(e,t,l,o,s);return h.start(i),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function zg(n,e){if(pr("AsyncQueue",`${e}: ${n}`),rc(n))return new te(G.UNAVAILABLE,`${e}: ${n}`);throw n}var Lh=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||ve.comparator(t.key,i.key):(t,i)=>ve.comparator(t.key,i.key),this.keyedMap=Fl(),this.sortedSet=new It(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let o=t.getNext().key,s=i.getNext().key;if(!o.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Fh=class{constructor(){this.W_=new It(ve.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ee():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},ta=class n{constructor(e,t,i,o,s,l,h,d,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,o,s){let l=[];return t.forEach(h=>{l.push({type:0,doc:h})}),new n(e,t,Lh.emptySet(t),l,i,o,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}};var ag=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},lg=class{constructor(){this.queries=aw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let o=De(t),s=o.queries;o.queries=aw(),s.forEach((l,h)=>{for(let d of h.j_)d.onError(i)})})(this,new te(G.ABORTED,"Firestore shutting down"))}};function aw(){return new $r(n=>Aw(n),Xh)}function Ug(n,e){return q(this,null,function*(){let t=De(n),i=3,o=e.query,s=t.queries.get(o);s?!s.H_()&&e.J_()&&(i=2):(s=new ag,i=e.J_()?0:1);try{switch(i){case 0:s.z_=yield t.onListen(o,!0);break;case 1:s.z_=yield t.onListen(o,!1);break;case 2:yield t.onFirstRemoteStoreListen(o)}}catch(l){let h=zg(l,`Initialization of query '${Us(e.query)}' failed`);return void e.onError(h)}t.queries.set(o,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&$g(t)})}function jg(n,e){return q(this,null,function*(){let t=De(n),i=e.query,o=3,s=t.queries.get(i);if(s){let l=s.j_.indexOf(e);l>=0&&(s.j_.splice(l,1),s.j_.length===0?o=e.J_()?0:1:!s.H_()&&e.J_()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function qD(n,e){let t=De(n),i=!1;for(let o of e){let s=o.query,l=t.queries.get(s);if(l){for(let h of l.j_)h.X_(o)&&(i=!0);l.z_=o}}i&&$g(t)}function GD(n,e,t){let i=De(n),o=i.queries.get(e);if(o)for(let s of o.j_)s.onError(t);i.queries.delete(e)}function $g(n){n.Y_.forEach(e=>{e.next()})}var cg,lw;(lw=cg||(cg={})).ea="default",lw.Cache="cache";var Zl=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let o of e.docChanges)o.type!==3&&i.push(o);e=new ta(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ta.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cg.Cache}};var Vh=class{constructor(e){this.key=e}},Nh=class{constructor(e){this.key=e}},ug=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ze(),this.mutatedKeys=ze(),this.Aa=xw(e),this.Ra=new Lh(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new Fh,o=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,l=o,h=!1,d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((v,w)=>{let S=o.get(v),A=Jh(this.query,w)?w:null,F=!!S&&this.mutatedKeys.has(S.key),j=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations),$=!1;S&&A?S.data.isEqual(A.data)?F!==j&&(i.track({type:3,doc:A}),$=!0):this.ga(S,A)||(i.track({type:2,doc:A}),$=!0,(d&&this.Aa(A,d)>0||m&&this.Aa(A,m)<0)&&(h=!0)):!S&&A?(i.track({type:0,doc:A}),$=!0):S&&!A&&(i.track({type:1,doc:S}),$=!0,(d||m)&&(h=!0)),$&&(A?(l=l.add(A),s=j?s.add(v):s.delete(v)):(l=l.delete(v),s=s.delete(v)))}),this.query.limit!==null)for(;l.size>this.query.limit;){let v=this.query.limitType==="F"?l.last():l.first();l=l.delete(v.key),s=s.delete(v.key),i.track({type:1,doc:v})}return{Ra:l,fa:i,ns:h,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let l=e.fa.G_();l.sort((v,w)=>function(A,F){let j=$=>{switch($){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee()}};return j(A)-j(F)}(v.type,w.type)||this.Aa(v.doc,w.doc)),this.pa(i),o=o!=null&&o;let h=t&&!o?this.ya():[],d=this.da.size===0&&this.current&&!o?1:0,m=d!==this.Ea;return this.Ea=d,l.length!==0||m?{snapshot:new ta(this.query,e.Ra,s,l,e.mutatedKeys,d===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Fh,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ze(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new Nh(i))}),this.da.forEach(i=>{e.has(i)||t.push(new Vh(i))}),t}ba(e){this.Ta=e.Ts,this.da=ze();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ta.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},hg=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},dg=class{constructor(e){this.key=e,this.va=!1}},fg=class{constructor(e,t,i,o,s,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Ca={},this.Fa=new $r(h=>Aw(h),Xh),this.Ma=new Map,this.xa=new Set,this.Oa=new It(ve.comparator),this.Na=new Map,this.La=new Wl,this.Ba={},this.ka=new Map,this.qa=Kl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function HD(n,e,t=!0){return q(this,null,function*(){let i=c1(n),o,s=i.Fa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),o=s.view.Da()):o=yield r1(i,e,t,!0),o})}function KD(n,e){return q(this,null,function*(){let t=c1(n);yield r1(t,e,!0,!1)})}function r1(n,e,t,i){return q(this,null,function*(){let o=yield xD(n.localStore,Li(e)),s=o.targetId,l=n.sharedClientState.addLocalQueryTarget(s,t),h;return i&&(h=yield WD(n,e,s,l==="current",o.resumeToken)),n.isPrimaryClient&&t&&Xw(n.remoteStore,o),h})}function WD(n,e,t,i,o){return q(this,null,function*(){n.Ka=(w,S,A)=>function(j,$,ee,oe){return q(this,null,function*(){let me=$.view.ma(ee);me.ns&&(me=yield ow(j.localStore,$.query,!1).then(({documents:M})=>$.view.ma(M,me)));let Ce=oe&&oe.targetChanges.get($.targetId),pt=oe&&oe.targetMismatches.get($.targetId)!=null,Oe=$.view.applyChanges(me,j.isPrimaryClient,Ce,pt);return uw(j,$.targetId,Oe.wa),Oe.snapshot})}(n,w,S,A);let s=yield ow(n.localStore,e,!0),l=new ug(e,s.Ts),h=l.ma(s.documents),d=Gl.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),m=l.applyChanges(h,n.isPrimaryClient,d);uw(n,t,m.wa);let v=new hg(e,t,l);return n.Fa.set(e,v),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),m.snapshot})}function ZD(n,e,t){return q(this,null,function*(){let i=De(n),o=i.Fa.get(e),s=i.Ma.get(o.targetId);if(s.length>1)return i.Ma.set(o.targetId,s.filter(l=>!Xh(l,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||(yield Qm(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Fg(i.remoteStore,o.targetId),pg(i,o.targetId)}).catch(ic))):(pg(i,o.targetId),yield Qm(i.localStore,o.targetId,!0))})}function QD(n,e){return q(this,null,function*(){let t=De(n),i=t.Fa.get(e),o=t.Ma.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Fg(t.remoteStore,i.targetId))})}function YD(n,e,t){return q(this,null,function*(){let i=rI(n);try{let o=yield function(l,h){let d=De(l),m=Dt.now(),v=h.reduce((A,F)=>A.add(F.key),ze()),w,S;return d.persistence.runTransaction("Locally write mutations","readwrite",A=>{let F=_r(),j=ze();return d.cs.getEntries(A,v).next($=>{F=$,F.forEach((ee,oe)=>{oe.isValidDocument()||(j=j.add(ee))})}).next(()=>d.localDocuments.getOverlayedDocuments(A,F)).next($=>{w=$;let ee=[];for(let oe of h){let me=rD(oe,w.get(oe.key).overlayedDocument);me!=null&&ee.push(new Ni(oe.key,me,Ew(me.value.mapValue),fr.exists(!0)))}return d.mutationQueue.addMutationBatch(A,m,ee,h)}).next($=>{S=$;let ee=$.applyToLocalDocumentSet(w,j);return d.documentOverlayCache.saveOverlays(A,$.batchId,ee)})}).then(()=>({batchId:S.batchId,changes:Rw(w)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(l,h,d){let m=l.Ba[l.currentUser.toKey()];m||(m=new It(Ze)),m=m.insert(h,d),l.Ba[l.currentUser.toKey()]=m}(i,o.batchId,t),yield sc(i,o.changes),yield nd(i.remoteStore)}catch(o){let s=zg(o,"Failed to persist write");t.reject(s)}})}function o1(n,e){return q(this,null,function*(){let t=De(n);try{let i=yield DD(t.localStore,e);e.targetChanges.forEach((o,s)=>{let l=t.Na.get(s);l&&(st(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?l.va=!0:o.modifiedDocuments.size>0?st(l.va):o.removedDocuments.size>0&&(st(l.va),l.va=!1))}),yield sc(t,i,e)}catch(i){yield ic(i)}})}function cw(n,e,t){let i=De(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let o=[];i.Fa.forEach((s,l)=>{let h=l.view.Z_(e);h.snapshot&&o.push(h.snapshot)}),function(l,h){let d=De(l);d.onlineState=h;let m=!1;d.queries.forEach((v,w)=>{for(let S of w.j_)S.Z_(h)&&(m=!0)}),m&&$g(d)}(i.eventManager,e),o.length&&i.Ca.d_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function XD(n,e,t){return q(this,null,function*(){let i=De(n);i.sharedClientState.updateQueryState(e,"rejected",t);let o=i.Na.get(e),s=o&&o.key;if(s){let l=new It(ve.comparator);l=l.insert(s,mi.newNoDocument(s,Me.min()));let h=ze().add(s),d=new Sh(Me.min(),new Map,new It(Ze),l,h);yield o1(i,d),i.Oa=i.Oa.remove(s),i.Na.delete(e),qg(i)}else yield Qm(i.localStore,e,!1).then(()=>pg(i,e,t)).catch(ic)})}function JD(n,e){return q(this,null,function*(){let t=De(n),i=e.batch.batchId;try{let o=yield PD(t.localStore,e);a1(t,i,null),s1(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield sc(t,o)}catch(o){yield ic(o)}})}function eI(n,e,t){return q(this,null,function*(){let i=De(n);try{let o=yield function(l,h){let d=De(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return d.mutationQueue.lookupMutationBatch(m,h).next(w=>(st(w!==null),v=w.keys(),d.mutationQueue.removeMutationBatch(m,w))).next(()=>d.mutationQueue.performConsistencyCheck(m)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(m,v,h)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>d.localDocuments.getDocuments(m,v))})}(i.localStore,e);a1(i,e,t),s1(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield sc(i,o)}catch(o){yield ic(o)}})}function s1(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function a1(n,e,t){let i=De(n),o=i.Ba[i.currentUser.toKey()];if(o){let s=o.get(e);s&&(t?s.reject(t):s.resolve(),o=o.remove(e)),i.Ba[i.currentUser.toKey()]=o}}function pg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||l1(n,i)})}function l1(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Fg(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),qg(n))}function uw(n,e,t){for(let i of t)i instanceof Vh?(n.La.addReference(i.key,e),tI(n,i)):i instanceof Nh?(le("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||l1(n,i.key)):Ee()}function tI(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(le("SyncEngine","New document in limbo: "+t),n.xa.add(i),qg(n))}function qg(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new ve(Ct.fromString(e)),i=n.qa.next();n.Na.set(i,new dg(t)),n.Oa=n.Oa.insert(t,i),Xw(n.remoteStore,new Hl(Li(Yh(t.path)),i,"TargetPurposeLimboResolution",yw.oe))}}function sc(n,e,t){return q(this,null,function*(){let i=De(n),o=[],s=[],l=[];i.Fa.isEmpty()||(i.Fa.forEach((h,d)=>{l.push(i.Ka(d,e,t).then(m=>{var v;if((m||t)&&i.isPrimaryClient){let w=m?!m.fromCache:(v=t?.targetChanges.get(d.targetId))===null||v===void 0?void 0:v.current;i.sharedClientState.updateQueryState(d.targetId,w?"current":"not-current")}if(m){o.push(m);let w=Hm.Wi(d.targetId,m);s.push(w)}}))}),yield Promise.all(l),i.Ca.d_(o),yield function(d,m){return q(this,null,function*(){let v=De(d);try{yield v.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>Q.forEach(m,S=>Q.forEach(S.$i,A=>v.persistence.referenceDelegate.addReference(w,S.targetId,A)).next(()=>Q.forEach(S.Ui,A=>v.persistence.referenceDelegate.removeReference(w,S.targetId,A)))))}catch(w){if(!rc(w))throw w;le("LocalStore","Failed to update sequence numbers: "+w)}for(let w of m){let S=w.targetId;if(!w.fromCache){let A=v.os.get(S),F=A.snapshotVersion,j=A.withLastLimboFreeSnapshotVersion(F);v.os=v.os.insert(S,j)}}})}(i.localStore,s))})}function nI(n,e){return q(this,null,function*(){let t=De(n);if(!t.currentUser.isEqual(e)){le("SyncEngine","User change. New user:",e.toKey());let i=yield Qw(t.localStore,e);t.currentUser=e,function(s,l){s.ka.forEach(h=>{h.forEach(d=>{d.reject(new te(G.CANCELLED,l))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield sc(t,i.hs)}})}function iI(n,e){let t=De(n),i=t.Na.get(e);if(i&&i.va)return ze().add(i.key);{let o=ze(),s=t.Ma.get(e);if(!s)return o;for(let l of s){let h=t.Fa.get(l);o=o.unionWith(h.view.Va)}return o}}function c1(n){let e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=o1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XD.bind(null,e),e.Ca.d_=qD.bind(null,e.eventManager),e.Ca.$a=GD.bind(null,e.eventManager),e}function rI(n){let e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eI.bind(null,e),e}var hw=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return q(this,null,function*(){this.serializer=ed(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return TD(this.persistence,new Wm,t.initialUser,this.serializer)}Ga(t){return new $m(Gm.Zr,this.serializer)}Wa(t){return new Ym}terminate(){return q(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var oI=(()=>{class n{initialize(t,i){return q(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=o=>cw(this.syncEngine,o,1),this.remoteStore.remoteSyncer.handleCredentialChange=nI.bind(null,this.syncEngine),yield $D(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new lg}()}createDatastore(t){let i=ed(t.databaseInfo.databaseId),o=function(l){return new eg(l)}(t.databaseInfo);return function(l,h,d,m){return new ig(l,h,d,m)}(t.authCredentials,t.appCheckCredentials,o,i)}createRemoteStore(t){return function(o,s,l,h,d){return new og(o,s,l,h,d)}(this.localStore,this.datastore,t.asyncQueue,i=>cw(this.syncEngine,i,0),function(){return Mh.D()?new Mh:new Xm}())}createSyncEngine(t,i){return function(s,l,h,d,m,v,w){let S=new fg(s,l,h,d,m,v);return w&&(S.Qa=!0),S}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return q(this,null,function*(){var t,i;yield function(s){return q(this,null,function*(){let l=De(s);le("RemoteStore","RemoteStore shutting down."),l.L_.add(5),yield oc(l),l.k_.shutdown(),l.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var Ql=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):pr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var mg=class{constructor(e,t,i,o,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=Kt.UNAUTHENTICATED,this.clientId=gh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,l=>q(this,null,function*(){le("FirestoreClient","Received user=",l.uid),yield this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,l=>(le("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>q(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=zg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Kp(n,e){return q(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),le("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(o=>q(this,null,function*(){i.isEqual(o)||(yield Qw(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function dw(n,e){return q(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield sI(n);le("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>sw(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>sw(e.remoteStore,o)),n._onlineComponents=e})}function sI(n){return q(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){le("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Kp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(o){return o.name==="FirebaseError"?o.code===G.FAILED_PRECONDITION||o.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Ws("Error using user provided cache. Falling back to memory cache: "+t),yield Kp(n,new hw)}}else le("FirestoreClient","Using default OfflineComponentProvider"),yield Kp(n,new hw);return n._offlineComponents})}function u1(n){return q(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(le("FirestoreClient","Using user provided OnlineComponentProvider"),yield dw(n,n._uninitializedComponentsProvider._online)):(le("FirestoreClient","Using default OnlineComponentProvider"),yield dw(n,new oI))),n._onlineComponents})}function aI(n){return u1(n).then(e=>e.syncEngine)}function Bh(n){return q(this,null,function*(){let e=yield u1(n),t=e.eventManager;return t.onListen=HD.bind(null,e.syncEngine),t.onUnlisten=ZD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=QD.bind(null,e.syncEngine),t})}function lI(n,e,t={}){let i=new pi;return n.asyncQueue.enqueueAndForget(()=>q(this,null,function*(){return function(s,l,h,d,m){let v=new Ql({next:S=>{v.Za(),l.enqueueAndForget(()=>jg(s,w));let A=S.docs.has(h);!A&&S.fromCache?m.reject(new te(G.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&S.fromCache&&d&&d.source==="server"?m.reject(new te(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(S)},error:S=>m.reject(S)}),w=new Zl(Yh(h.path),v,{includeMetadataChanges:!0,_a:!0});return Ug(s,w)}(yield Bh(n),n.asyncQueue,e,t,i)})),i.promise}function cI(n,e,t={}){let i=new pi;return n.asyncQueue.enqueueAndForget(()=>q(this,null,function*(){return function(s,l,h,d,m){let v=new Ql({next:S=>{v.Za(),l.enqueueAndForget(()=>jg(s,w)),S.fromCache&&d.source==="server"?m.reject(new te(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(S)},error:S=>m.reject(S)}),w=new Zl(h,v,{includeMetadataChanges:!0,_a:!0});return Ug(s,w)}(yield Bh(n),n.asyncQueue,e,t,i)})),i.promise}function h1(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var fw=new Map;function d1(n,e,t){if(!t)throw new te(G.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uI(n,e,t,i){if(e===!0&&i===!0)throw new te(G.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pw(n){if(!ve.isDocumentKey(n))throw new te(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mw(n){if(ve.isDocumentKey(n))throw new te(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function id(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ee()}function ni(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new te(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=id(n);throw new te(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function hI(n,e){if(e<=0)throw new te(G.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var zh=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new te(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=h1((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new te(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new te(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new te(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},na=class{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zh({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zh(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Wp;switch(i.type){case"firstParty":return new Xp(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new te(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return q(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=fw.get(t);i&&(le("ComponentProvider","Removing Datastore"),fw.delete(t),i.terminate())}(this),Promise.resolve()}};function f1(n,e,t,i={}){var o;let s=(n=ni(n,na))._getSettings(),l=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==l&&Ws("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:l,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Kt.MOCK_USER;else{h=d0(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);let m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new te(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Kt(m)}n._authCredentials=new Zp(new mh(h,d))}}var Bi=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},dn=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},zr=class n extends Bi{constructor(e,t,i){super(e,t,Yh(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new dn(this.firestore,null,new ve(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function p1(n,e,...t){if(n=Qn(n),d1("collection","path",e),n instanceof na){let i=Ct.fromString(e,...t);return mw(i),new zr(n,null,i)}{if(!(n instanceof dn||n instanceof zr))throw new te(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Ct.fromString(e,...t));return mw(i),new zr(n.firestore,null,i)}}function Gg(n,e,...t){if(n=Qn(n),arguments.length===1&&(e=gh.newId()),d1("doc","path",e),n instanceof na){let i=Ct.fromString(e,...t);return pw(i),new dn(n,null,new ve(i))}{if(!(n instanceof dn||n instanceof zr))throw new te(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Ct.fromString(e,...t));return pw(i),new dn(n.firestore,n instanceof zr?n.converter:null,new ve(i))}}var Uh=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Rh(this,"async_queue_retry"),this.Vu=()=>{let i=Hp();i&&le("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=Hp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Hp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new pi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return q(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!rc(e))throw e;le("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let o=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(i);throw pr("INTERNAL UNHANDLED ERROR: ",o),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let o=sg.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(o),o}fu(){this.Eu&&Ee()}verifyOperationInProgress(){}wu(){return q(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function gw(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let o=t;for(let s of i)if(s in o&&typeof o[s]=="function")return!0;return!1}(n,["next","error","complete"])}var zi=class extends na{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new Uh,this._persistenceKey=o?.name||"[DEFAULT]"}_terminate(){return q(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Uh(e),this._firestoreClient=void 0,yield e}})}};function m1(n,e){let t=typeof n=="object"?n:C0(),i=typeof n=="string"?n:e||"(default)",o=y0(t,"firestore").getImmediate({identifier:i});if(!o._initialized){let s=h0("firestore");s&&f1(o,...s)}return o}function rd(n){if(n._terminated)throw new te(G.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||dI(n),n._firestoreClient}function dI(n){var e,t,i;let o=n._freezeSettings(),s=function(h,d,m,v){return new im(h,d,m,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,h1(v.experimentalLongPollingOptions),v.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new mg(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(h){let d=h?._online.build();return{_offline:h?._offline.build(d),_online:d}}(n._componentsProvider))}var Yl=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(rn.fromBase64String(e))}catch(t){throw new te(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ia=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new te(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Kr=class{constructor(e){this._methodName=e}};var Xl=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new te(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new te(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}};var Jl=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==o[s])return!1;return!0}(this._values,e._values)}};var fI=/^__.*__$/,gg=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ni(e,this.data,this.fieldMask,t,this.fieldTransforms):new zo(e,this.data,t,this.fieldTransforms)}},jh=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ni(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function g1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee()}}var $h=class n{constructor(e,t,i,o,s,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.Fu({path:i,xu:!1});return o.Ou(e),o}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.Fu({path:i,xu:!1});return o.vu(),o}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Gh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(g1(this.Cu)&&fI.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},_g=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ed(e)}Qu(e,t,i,o=!1){return new $h({Cu:e,methodName:t,qu:i,path:zn.emptyPath(),xu:!1,ku:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function od(n){let e=n._freezeSettings(),t=ed(n._databaseId);return new _g(n._databaseId,!!e.ignoreUndefinedProperties,t)}function pI(n,e,t,i,o,s={}){let l=n.Qu(s.merge||s.mergeFields?2:0,e,t,o);Hg("Data must be an object, but it was:",l,i);let h=y1(i,l),d,m;if(s.merge)d=new ti(l.fieldMask),m=l.fieldTransforms;else if(s.mergeFields){let v=[];for(let w of s.mergeFields){let S=Cg(e,w,t);if(!l.contains(S))throw new te(G.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);C1(v,S)||v.push(S)}d=new ti(v),m=l.fieldTransforms.filter(w=>d.covers(w.field))}else d=null,m=l.fieldTransforms;return new gg(new Bn(h),d,m)}var qh=class n extends Kr{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function _1(n,e,t){return new $h({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var vg=class n extends Kr{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=_1(this,e,!0),i=this.Ku.map(s=>$o(s,t)),o=new qr(i);return new $l(e.path,o)}isEqual(e){return e instanceof n&&tf(this.Ku,e.Ku)}},yg=class n extends Kr{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=_1(this,e,!0),i=this.Ku.map(s=>$o(s,t)),o=new Gr(i);return new $l(e.path,o)}isEqual(e){return e instanceof n&&tf(this.Ku,e.Ku)}},wg=class n extends Kr{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new Bo(e.serializer,Lw(e.serializer,this.$u));return new $l(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function mI(n,e,t,i){let o=n.Qu(1,e,t);Hg("Data must be an object, but it was:",o,i);let s=[],l=Bn.empty();Uo(i,(d,m)=>{let v=Kg(e,d,t);m=Qn(m);let w=o.Nu(v);if(m instanceof qh)s.push(v);else{let S=$o(m,w);S!=null&&(s.push(v),l.set(v,S))}});let h=new ti(s);return new jh(l,h,o.fieldTransforms)}function gI(n,e,t,i,o,s){let l=n.Qu(1,e,t),h=[Cg(e,i,t)],d=[o];if(s.length%2!=0)throw new te(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<s.length;S+=2)h.push(Cg(e,s[S])),d.push(s[S+1]);let m=[],v=Bn.empty();for(let S=h.length-1;S>=0;--S)if(!C1(m,h[S])){let A=h[S],F=d[S];F=Qn(F);let j=l.Nu(A);if(F instanceof qh)m.push(A);else{let $=$o(F,j);$!=null&&(m.push(A),v.set(A,$))}}let w=new ti(m);return new jh(v,w,l.fieldTransforms)}function v1(n,e,t,i=!1){return $o(t,n.Qu(i?4:3,e))}function $o(n,e){if(w1(n=Qn(n)))return Hg("Unsupported field value:",e,n),y1(n,e);if(n instanceof Kr)return function(i,o){if(!g1(o.Cu))throw o.Bu(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Bu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(o);s&&o.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,o){let s=[],l=0;for(let h of i){let d=$o(h,o.Lu(l));d==null&&(d={nullValue:"NULL_VALUE"}),s.push(d),l++}return{arrayValue:{values:s}}}(n,e)}return function(i,o){if((i=Qn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Lw(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=Dt.fromDate(i);return{timestampValue:Ih(o.serializer,s)}}if(i instanceof Dt){let s=new Dt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ih(o.serializer,s)}}if(i instanceof Xl)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Yl)return{bytesValue:$w(o.serializer,i._byteString)};if(i instanceof dn){let s=o.databaseId,l=i.firestore._databaseId;if(!l.isEqual(s))throw o.Bu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Lg(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Jl)return function(l,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:l.toArray().map(d=>{if(typeof d!="number")throw h.Bu("VectorValues must only contain numeric values.");return Og(h.serializer,d)})}}}}}}(i,o);throw o.Bu(`Unsupported field value: ${id(i)}`)}(n,e)}function y1(n,e){let t={};return ww(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Uo(n,(i,o)=>{let s=$o(o,e.Mu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function w1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Dt||n instanceof Xl||n instanceof Yl||n instanceof dn||n instanceof Kr||n instanceof Jl)}function Hg(n,e,t){if(!w1(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){let i=id(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function Cg(n,e,t){if((e=Qn(e))instanceof ia)return e._internalPath;if(typeof e=="string")return Kg(n,e);throw Gh("Field path arguments must be of type string or ",n,!1,void 0,t)}var _I=new RegExp("[~\\*/\\[\\]]");function Kg(n,e,t){if(e.search(_I)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ia(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gh(n,e,t,i,o){let s=i&&!i.isEmpty(),l=o!==void 0,h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(s||l)&&(d+=" (found",s&&(d+=` in field ${i}`),l&&(d+=` in document ${o}`),d+=")"),new te(G.INVALID_ARGUMENT,h+n+d)}function C1(n,e){return n.some(t=>t.isEqual(e))}var ec=class{constructor(e,t,i,o,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new bg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(sd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},bg=class extends ec{data(){return super.data()}};function sd(n,e){return typeof e=="string"?Kg(n,e):e instanceof ia?e._internalPath:e._delegate._internalPath}function b1(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new te(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var tc=class{},ra=class extends tc{};function E1(n,e,...t){let i=[];e instanceof tc&&i.push(e),i=i.concat(t),function(s){let l=s.filter(d=>d instanceof Eg).length,h=s.filter(d=>d instanceof Hh).length;if(l>1||l>0&&h>0)throw new te(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(let o of i)n=o._apply(n);return n}var Hh=class n extends ra{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return I1(e._query,t),new Bi(e.firestore,e.converter,gm(e._query,t))}_parse(e){let t=od(e.firestore);return function(s,l,h,d,m,v,w){let S;if(m.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new te(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){vw(w,v);let A=[];for(let F of w)A.push(_w(d,s,F));S={arrayValue:{values:A}}}else S=_w(d,s,w)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||vw(w,v),S=v1(h,l,w,v==="in"||v==="not-in");return Ot.create(m,v,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function S1(n,e,t){let i=e,o=sd("where",n);return Hh._create(o,i,t)}var Eg=class n extends tc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:gi.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(o,s){let l=o,h=s.getFlattenedFilters();for(let d of h)I1(l,d),l=gm(l,d)}(e._query,t),new Bi(e.firestore,e.converter,gm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Sg=class n extends ra{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(o,s,l){if(o.startAt!==null)throw new te(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new te(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new No(s,l)}(e._query,this._field,this._direction);return new Bi(e.firestore,e.converter,function(o,s){let l=o.explicitOrderBy.concat([s]);return new gr(o.path,o.collectionGroup,l,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}};function T1(n,e="asc"){let t=e,i=sd("orderBy",n);return Sg._create(i,t)}var Tg=class n extends ra{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new Bi(e.firestore,e.converter,Eh(e._query,this._limit,this._limitType))}};function P1(n){return hI("limit",n),Tg._create("limit",n,"F")}var Pg=class n extends ra{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=vI(e,this.type,this._docOrFields,this._inclusive);return new Bi(e.firestore,e.converter,function(o,s){return new gr(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,s,o.endAt)}(e._query,t))}};function D1(...n){return Pg._create("startAfter",n,!1)}function vI(n,e,t,i){if(t[0]=Qn(t[0]),t[0]instanceof ec)return function(s,l,h,d,m){if(!d)throw new te(G.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);let v=[];for(let w of Gs(s))if(w.field.isKeyField())v.push(Ch(l,d.key));else{let S=d.data.field(w.field);if(Qh(S))throw new te(G.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(S===null){let A=w.field.canonicalString();throw new te(G.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}v.push(S)}return new jr(v,m)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{let o=od(n.firestore);return function(l,h,d,m,v,w){let S=l.explicitOrderBy;if(v.length>S.length)throw new te(G.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let A=[];for(let F=0;F<v.length;F++){let j=v[F];if(S[F].field.isKeyField()){if(typeof j!="string")throw new te(G.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof j}`);if(!kg(l)&&j.indexOf("/")!==-1)throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${j}' contains a slash.`);let $=l.path.child(Ct.fromString(j));if(!ve.isDocumentKey($))throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${$}' is not because it contains an odd number of segments.`);let ee=new ve($);A.push(Ch(h,ee))}else{let $=v1(d,m,j);A.push($)}}return new jr(A,w)}(n._query,n.firestore._databaseId,o,e,t,i)}}function _w(n,e,t){if(typeof(t=Qn(t))=="string"){if(t==="")throw new te(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kg(e)&&t.indexOf("/")!==-1)throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Ct.fromString(t));if(!ve.isDocumentKey(i))throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ch(n,new ve(i))}if(t instanceof dn)return Ch(n,t._key);throw new te(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${id(t)}.`)}function vw(n,e){if(!Array.isArray(n)||n.length===0)throw new te(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function I1(n,e){let t=function(o,s){for(let l of o)for(let h of l.getFlattenedFilters())if(s.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new te(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Dg=class{convertValue(e,t="none"){switch(Vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ur(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Uo(e,(o,s)=>{i[o]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,o;let s=(o=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(l=>wt(l.doubleValue));return new Jl(s)}convertGeoPoint(e){return new Xl(wt(e.latitude),wt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Ag(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Ul(e));default:return null}}convertTimestamp(e){let t=mr(e);return new Dt(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Ct.fromString(e);st(Zw(i));let o=new wh(i.get(1),i.get(3)),s=new ve(i.popFirst(5));return o.isEqual(t)||pr(`Document ${s} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function yI(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var Oo=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Kh=class extends ec{constructor(e,t,i,o,s,l){super(e,t,i,o,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ks(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(sd("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Ks=class extends Kh{data(e={}){return super.data(e)}},Wh=class{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Oo(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Ks(this._firestore,this._userDataWriter,i.key,i,new Oo(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new te(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,s){if(o._snapshot.oldDocs.isEmpty()){let l=0;return o._snapshot.docChanges.map(h=>{let d=new Ks(o._firestore,o._userDataWriter,h.doc.key,h.doc,new Oo(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(h=>s||h.type!==3).map(h=>{let d=new Ks(o._firestore,o._userDataWriter,h.doc.key,h.doc,new Oo(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter),m=-1,v=-1;return h.type!==0&&(m=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),v=l.indexOf(h.doc.key)),{type:wI(h.type),doc:d,oldIndex:m,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function wI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee()}}function A1(n){n=ni(n,dn);let e=ni(n.firestore,zi);return lI(rd(e),n._key).then(t=>L1(e,n,t))}var nc=class extends Dg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yl(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,t)}};function x1(n){n=ni(n,Bi);let e=ni(n.firestore,zi),t=rd(e),i=new nc(e);return b1(n._query),cI(t,n._query).then(o=>new Wh(e,i,n,o))}function M1(n,e,t,...i){n=ni(n,dn);let o=ni(n.firestore,zi),s=od(o),l;return l=typeof(e=Qn(e))=="string"||e instanceof ia?gI(s,"updateDoc",n._key,e,t,i):mI(s,"updateDoc",n._key,e),Wg(o,[l.toMutation(n._key,fr.exists(!0))])}function R1(n){return Wg(ni(n.firestore,zi),[new ql(n._key,fr.none())])}function k1(n,e){let t=ni(n.firestore,zi),i=Gg(n),o=yI(n.converter,e);return Wg(t,[pI(od(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,fr.exists(!1))]).then(()=>i)}function O1(n,...e){var t,i,o;n=Qn(n);let s={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||gw(e[l])||(s=e[l],l++);let h={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(gw(e[l])){let w=e[l];e[l]=(t=w.next)===null||t===void 0?void 0:t.bind(w),e[l+1]=(i=w.error)===null||i===void 0?void 0:i.bind(w),e[l+2]=(o=w.complete)===null||o===void 0?void 0:o.bind(w)}let d,m,v;if(n instanceof dn)m=ni(n.firestore,zi),v=Yh(n._key.path),d={next:w=>{e[l]&&e[l](L1(m,n,w))},error:e[l+1],complete:e[l+2]};else{let w=ni(n,Bi);m=ni(w.firestore,zi),v=w._query;let S=new nc(m);d={next:A=>{e[l]&&e[l](new Wh(m,S,w,A))},error:e[l+1],complete:e[l+2]},b1(n._query)}return function(S,A,F,j){let $=new Ql(j),ee=new Zl(A,$,F);return S.asyncQueue.enqueueAndForget(()=>q(this,null,function*(){return Ug(yield Bh(S),ee)})),()=>{$.Za(),S.asyncQueue.enqueueAndForget(()=>q(this,null,function*(){return jg(yield Bh(S),ee)}))}}(rd(m),v,h,d)}function Wg(n,e){return function(i,o){let s=new pi;return i.asyncQueue.enqueueAndForget(()=>q(this,null,function*(){return YD(yield aI(i),o,s)})),s.promise}(rd(n),e)}function L1(n,e,t){let i=t.docs.get(e._key),o=new nc(n);return new Kh(n,o,e._key,i,new Oo(t.hasPendingWrites,t.fromCache),e.converter)}function F1(...n){return new vg("arrayUnion",n)}function V1(...n){return new yg("arrayRemove",n)}function N1(n){return new wg("increment",n)}(function(e,t=!0){(function(o){oa=o})(w0),v0(new g0("firestore",(i,{instanceIdentifier:o,options:s})=>{let l=i.getProvider("app").getImmediate(),h=new zi(new Qp(i.getProvider("auth-internal")),new em(i.getProvider("app-check-internal")),function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new te(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wh(m.options.projectId,v)}(l,o),l);return s=Object.assign({useFetchStreams:t},s),h._setSettings(s),h},"PUBLIC").setMultipleInstances(!0)),Ja(By,"4.7.3",e),Ja(By,"4.7.3","esm2017")})();var qo=class{constructor(e){return e}},B1="firestore",Zg=class{constructor(){return S0(B1)}};var Qg=new tt("angularfire2.firestore-instances");function CI(n,e){let t=E0(B1,n,e);return t&&new qo(t)}function bI(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new qo(i)}}var EI={provide:Zg,deps:[[new Mr,Qg]]},SI={provide:qo,useFactory:CI,deps:[[new Mr,Qg],D0]};function z1(n,...e){return Ja("angularfire",b0.full,"fst"),Ka([SI,EI,{provide:Qg,useFactory:bI(n),multi:!0,deps:[In,vo,P0,I0,[new Mr,M0],[new Mr,T0],...e]}])}var U1=Gt(k1,!0);var Yg=Gt(V1,!0),Xg=Gt(F1,!0);var ac=Gt(p1,!0);var j1=Gt(R1,!0);var Go=Gt(Gg,!0);var $1=Gt(A1,!0);var Jg=Gt(x1,!0);var q1=Gt(m1,!0);var ad=Gt(N1,!0);var e_=Gt(P1,!0);var G1=Gt(O1,!0);var ld=Gt(T1,!0);var lc=Gt(E1,!0);var H1=Gt(D1,!0);var Ho=Gt(M1,!0);var K1=Gt(S1,!0);var W1={production:!1,firebase:{apiKey:"AIzaSyA9H-CYGk2kEsfzKyFMA6cdPQRRQMf750M",authDomain:"bengaluru-swada-1ecca.firebaseapp.com",projectId:"bengaluru-swada-1ecca",storageBucket:"bengaluru-swada-1ecca.firebasestorage.app",messagingSenderId:"831575973864",appId:"1:831575973864:web:8ba5a2fa1e28b9e16bce5d",measurementId:"G-DEZTYKDN53"},cloudflare:{accountId:"49f1c9c0ed449773191d4a4ee7041a2e",streamApiToken:"9wIo0-ar2GwKCeKXzFaX5uV2PLGjnO9HHoVUs6AL",customerCode:"YOUR_CUSTOMER_CODE"}};var Ko=class{hasShownSplash=!1;markSplashShown(){this.hasShownSplash=!0}shouldShowSplash(){return!this.hasShownSplash}reset(){this.hasShownSplash=!1}},Wo=()=>{let n=ue(Ke);return ue(Ko).shouldShowSplash()?(console.log("[SplashGuard] Redirecting to splash screen"),n.createUrlTree(["/"])):!0};var cd=class n{constructor(e,t,i){this.router=e;this.auth=t;this.appInit=i}minSplashDuration=3e3;splashStartTime=0;authUnsubscribe;ngOnInit(){this.splashStartTime=Date.now(),console.log("[Splash] Splash screen started at:",new Date().toISOString()),this.authUnsubscribe=O0(this.auth,e=>{let t=Date.now()-this.splashStartTime,i=Math.max(0,this.minSplashDuration-t);console.log(`[Splash] Auth checked. Elapsed: ${t}ms, Waiting additional: ${i}ms`),setTimeout(()=>{this.appInit.markSplashShown(),e?(console.log("[Splash] User is logged in:",e.uid),this.router.navigate(["/main-app"],{replaceUrl:!0})):(console.log("[Splash] User is not logged in, navigating to phone-input"),this.router.navigate(["/phone-input"],{replaceUrl:!0}))},i)})}ngOnDestroy(){this.authUnsubscribe&&this.authUnsubscribe()}static \u0275fac=function(t){return new(t||n)(ne(Ke),ne(Tt),ne(Ko))};static \u0275cmp=nt({type:n,selectors:[["app-splash"]],standalone:!0,features:[it],decls:2,vars:0,consts:[[1,"splash-container"],["src","logo.jpg","alt","Bengaluru Swada Logo",1,"splash-logo"]],template:function(t,i){t&1&&(b(0,"div",0),X(1,"img",1),P())},dependencies:[ct],styles:[".splash-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background-color:#fff}.splash-logo[_ngcontent-%COMP%]{max-width:80%;max-height:50vh;object-fit:contain;animation:_ngcontent-%COMP%_fadeIn 1.5s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}"]})};var nC=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||n)(ne(Co),ne(yo))}}static{this.\u0275dir=Qt({type:n})}}return n})(),iC=(()=>{class n extends nC{static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275dir=Qt({type:n,features:[er]})}}return n})(),a_=new tt("");var DI={provide:a_,useExisting:_o(()=>on),multi:!0};function II(){let n=ar()?ar().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var AI=new tt(""),on=(()=>{class n extends nC{constructor(t,i,o){super(t,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!II())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||n)(ne(Co),ne(yo),ne(AI,8))}}static{this.\u0275dir=Qt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&ie("input",function(l){return o._handleInput(l.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(l){return o._compositionEnd(l.target.value)})},features:[bo([DI]),er]})}}return n})();function t_(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function xI(n){return n!=null&&typeof n.length=="number"}var pd=new tt(""),MI=new tt("");function RI(n){return e=>{if(t_(e.value)||t_(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function kI(n){return e=>xI(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function OI(n){if(!n)return n_;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(t_(i.value))return null;let o=i.value;return e.test(o)?null:{pattern:{requiredPattern:t,actualValue:o}}}}function n_(n){return null}function rC(n){return n!=null}function oC(n){return Xa(n)?un(n):n}function sC(n){let e={};return n.forEach(t=>{e=t!=null?J(J({},e),t):e}),Object.keys(e).length===0?null:e}function aC(n,e){return e.map(t=>t(n))}function LI(n){return!n.validate}function lC(n){return n.map(e=>LI(e)?e:t=>e.validate(t))}function FI(n){if(!n)return null;let e=n.filter(rC);return e.length==0?null:function(t){return sC(aC(t,e))}}function cC(n){return n!=null?FI(lC(n)):null}function VI(n){if(!n)return null;let e=n.filter(rC);return e.length==0?null:function(t){let i=aC(t,e).map(oC);return j_(i).pipe(We(sC))}}function uC(n){return n!=null?VI(lC(n)):null}function Z1(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function NI(n){return n._rawValidators}function BI(n){return n._rawAsyncValidators}function i_(n){return n?Array.isArray(n)?n:[n]:[]}function hd(n,e){return Array.isArray(n)?n.includes(e):n===e}function Q1(n,e){let t=i_(e);return i_(n).forEach(o=>{hd(t,o)||t.push(o)}),t}function Y1(n,e){return i_(e).filter(t=>!hd(n,t))}var dd=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=cC(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=uC(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},r_=class extends dd{get formDirective(){return null}get path(){return null}},fc=class extends dd{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},o_=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},zI={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},GR=qe(J({},zI),{"[class.ng-submitted]":"isSubmitted"}),vn=(()=>{class n extends o_{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(ne(fc,2))}}static{this.\u0275dir=Qt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&Ge("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[er]})}}return n})();var cc="VALID",ud="INVALID",aa="PENDING",uc="DISABLED",ca=class{},fd=class extends ca{constructor(e,t){super(),this.value=e,this.source=t}},hc=class extends ca{constructor(e,t){super(),this.pristine=e,this.source=t}},dc=class extends ca{constructor(e,t){super(),this.touched=e,this.source=t}},la=class extends ca{constructor(e,t){super(),this.status=e,this.source=t}};function UI(n){return(md(n)?n.validators:n)||null}function jI(n){return Array.isArray(n)?cC(n):n||null}function $I(n,e){return(md(e)?e.asyncValidators:n)||null}function qI(n){return Array.isArray(n)?uC(n):n||null}function md(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var s_=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=cu(()=>this.statusReactive()),this.statusReactive=su(void 0),this._pristine=cu(()=>this.pristineReactive()),this.pristineReactive=su(!0),this._touched=cu(()=>this.touchedReactive()),this.touchedReactive=su(!1),this._events=new Ti,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return kr(this.statusReactive)}set status(e){kr(()=>this.statusReactive.set(e))}get valid(){return this.status===cc}get invalid(){return this.status===ud}get pending(){return this.status==aa}get disabled(){return this.status===uc}get enabled(){return this.status!==uc}get pristine(){return kr(this.pristineReactive)}set pristine(e){kr(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return kr(this.touchedReactive)}set touched(e){kr(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Q1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Q1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Y1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Y1(e,this._rawAsyncValidators))}hasValidator(e){return hd(this._rawValidators,e)}hasAsyncValidator(e){return hd(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(qe(J({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new dc(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new dc(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(qe(J({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new hc(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new hc(!0,i))}markAsPending(e={}){this.status=aa;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new la(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(qe(J({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=uc,this.errors=null,this._forEachChild(o=>{o.disable(qe(J({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new fd(this.value,i)),this._events.next(new la(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(qe(J({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=cc,this._forEachChild(i=>{i.enable(qe(J({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(qe(J({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===cc||this.status===aa)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new fd(this.value,t)),this._events.next(new la(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(qe(J({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?uc:cc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=aa,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let i=oC(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,o)=>i&&i._find(o),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new la(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new yt,this.statusChanges=new yt}_calculateStatus(){return this._allControlsDisabled()?uc:this.errors?ud:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(aa)?aa:this._anyControlsHaveStatus(ud)?ud:cc}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),o=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),o&&this._events.next(new hc(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new dc(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){md(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=jI(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=qI(this._rawAsyncValidators)}};var hC=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>l_}),l_="always";function GI(n,e){return[...e.path,n]}function HI(n,e,t=l_){WI(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),ZI(n,e),YI(n,e),QI(n,e),KI(n,e)}function X1(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function KI(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function WI(n,e){let t=NI(n);e.validator!==null?n.setValidators(Z1(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=BI(n);e.asyncValidator!==null?n.setAsyncValidators(Z1(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let o=()=>n.updateValueAndValidity();X1(e._rawValidators,o),X1(e._rawAsyncValidators,o)}function ZI(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&dC(n,e)})}function QI(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&dC(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function dC(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function YI(n,e){let t=(i,o)=>{e.valueAccessor.writeValue(i),o&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function XI(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function JI(n){return Object.getPrototypeOf(n.constructor)===iC}function eA(n,e){if(!e)return null;Array.isArray(e);let t,i,o;return e.forEach(s=>{s.constructor===on?t=s:JI(s)?i=s:o=s}),o||i||t||null}function J1(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function eC(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var tA=class extends s_{constructor(e=null,t,i){super(UI(t),$I(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),md(t)&&(t.nonNullable||t.initialValueIsDefault)&&(eC(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){J1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){J1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){eC(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var nA={provide:fc,useExisting:_o(()=>fn)},tC=Promise.resolve(),fn=(()=>{class n extends fc{constructor(t,i,o,s,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this.control=new tA,this._registered=!1,this.name="",this.update=new yt,this._parent=t,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=eA(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),XI(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){HI(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){tC.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,o=i!==0&&Eo(i);tC.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?GI(t,this._parent):[t]}static{this.\u0275fac=function(i){return new(i||n)(ne(r_,9),ne(pd,10),ne(MI,10),ne(a_,10),ne(Rn,8),ne(hC,8))}}static{this.\u0275dir=Qt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[bo([nA]),er,ui]})}}return n})();var iA={provide:a_,useExisting:_o(()=>c_),multi:!0},c_=(()=>{class n extends iC{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,o){i&1&&ie("input",function(l){return o.onChange(l.target.value)})("blur",function(){return o.onTouched()})},features:[bo([iA]),er]})}}return n})();function rA(n){return typeof n=="number"?n:parseInt(n,10)}function oA(n){return typeof n=="number"?n:parseFloat(n)}var u_=(()=>{class n{constructor(){this._validator=n_}ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):n_,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=Qt({type:n,features:[ui]})}}return n})();var sA={provide:pd,useExisting:_o(()=>h_),multi:!0},h_=(()=>{class n extends u_{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=t=>oA(t),this.createValidator=t=>RI(t)}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,o){i&2&&tr("min",o._enabled?o.min:null)},inputs:{min:"min"},features:[bo([sA]),er]})}}return n})();var aA={provide:pd,useExisting:_o(()=>pc),multi:!0},pc=(()=>{class n extends u_{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=t=>rA(t),this.createValidator=t=>kI(t)}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,o){i&2&&tr("maxlength",o._enabled?o.maxlength:null)},inputs:{maxlength:"maxlength"},features:[bo([aA]),er]})}}return n})(),lA={provide:pd,useExisting:_o(()=>d_),multi:!0},d_=(()=>{class n extends u_{constructor(){super(...arguments),this.inputName="pattern",this.normalizeInput=t=>t,this.createValidator=t=>OI(t)}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Ji(n)))(o||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(i,o){i&2&&tr("pattern",o._enabled?o.pattern:null)},inputs:{pattern:"pattern"},features:[bo([lA]),er]})}}return n})();var cA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Xi({type:n})}static{this.\u0275inj=Yi({})}}return n})();var yn=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:hC,useValue:t.callSetDisabledState??l_}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Xi({type:n})}static{this.\u0275inj=Yi({imports:[cA]})}}return n})();var ua=class n{constructor(e){this.auth=e}confirmationResult=null;phoneNumber="";sendOtp(e,t){return q(this,null,function*(){try{let i=yield L0(this.auth,e,t);return this.setConfirmationResult(i),this.setPhoneNumber(e),i}catch(i){throw i}})}setConfirmationResult(e){this.confirmationResult=e}getConfirmationResult(){return this.confirmationResult}setPhoneNumber(e){this.phoneNumber=e}getPhoneNumber(){return this.phoneNumber}static \u0275fac=function(t){return new(t||n)(xe(Tt))};static \u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})};function uA(n,e){if(n&1&&(b(0,"div",14)(1,"span"),U(2),P()()),n&2){let t=he();N(2),He("\u26A0\uFE0F ",t.error,"")}}function hA(n,e){n&1&&(b(0,"span"),U(1,"Continue"),P())}function dA(n,e){n&1&&(b(0,"span",15),U(1,"Sending OTP..."),P())}var gd=class n{constructor(e,t,i){this.router=e;this.auth=t;this.phoneAuthService=i}mobile="";valid=!1;loading=!1;error="";recaptchaVerifier;confirmationResult;ngOnInit(){setTimeout(()=>{this.recaptchaVerifier=new uu(this.auth,"recaptcha-container",{size:"invisible",callback:()=>console.log("reCAPTCHA success"),"expired-callback":()=>this.error="ReCAPTCHA expired. Try again."}),this.recaptchaVerifier.render()})}onInput(){this.valid=/^\d{10}$/.test(this.mobile),this.error=""}continue(){return q(this,null,function*(){if(!(!this.valid||this.loading)){this.loading=!0,this.error="";try{let e="+91"+this.mobile;this.confirmationResult=yield this.phoneAuthService.sendOtp(e,this.recaptchaVerifier),this.router.navigate(["/otp"])}catch(e){console.error(e),e.code==="auth/invalid-phone-number"?this.error="Invalid phone number.":e.code==="auth/too-many-requests"?this.error="Too many attempts. Try again later.":e.code==="auth/quota-exceeded"?this.error="SMS quota exceeded.":e.code==="auth/billing-not-enabled"?this.error="Firebase billing is not enabled. Please enable it in the Firebase Console.":this.error=`Failed to send OTP: ${e.message} (${e.code})`,this.loading=!1}}})}static \u0275fac=function(t){return new(t||n)(ne(Ke),ne(Tt),ne(ua))};static \u0275cmp=nt({type:n,selectors:[["app-phone-input"]],standalone:!0,features:[it],decls:18,vars:8,consts:[[1,"phone-input-page"],[1,"mobile-input-section"],[1,"mobile-form"],[1,"welcome-text"],[1,"subtitle","light-grey"],[1,"input-container"],[1,"country-code"],["type","tel","id","mobileNumber","placeholder","Enter your mobile number","maxlength","10","pattern","[0-9]{10}",3,"ngModelChange","input","ngModel","disabled"],["class","error-message",4,"ngIf"],[1,"continue-btn",3,"click","disabled"],[4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"privacy-text","light-grey"],["id","recaptcha-container"],[1,"error-message"],[1,"loading-spinner"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),U(4,"Welcome to Bengaluru Swada!"),P(),b(5,"p",4),U(6," Enter your mobile number to discover amazing street food near you "),P(),b(7,"div",5)(8,"div",6),U(9,"+91"),P(),b(10,"input",7),qt("ngModelChange",function(s){return $t(i.mobile,s)||(i.mobile=s),s}),ie("input",function(){return i.onInput()}),P()(),Pe(11,uA,3,1,"div",8),b(12,"button",9),ie("click",function(){return i.continue()}),Pe(13,hA,2,0,"span",10)(14,dA,2,0,"span",11),P(),b(15,"p",12),U(16," We'll send you an OTP to verify your number. Your privacy is important to us. "),P(),X(17,"div",13),P()()()),t&2&&(N(10),jt("ngModel",i.mobile),Z("disabled",i.loading),N(),Z("ngIf",i.error),N(),Ge("active",i.valid&&!i.loading),Z("disabled",!i.valid||i.loading),N(),Z("ngIf",!i.loading),N(),Z("ngIf",i.loading))},dependencies:[ct,Pt,yn,on,vn,pc,d_,fn],styles:[".mobile-input-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:2rem 1rem}.welcome-text[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:1rem}.mobile-form[_ngcontent-%COMP%]{width:100%;max-width:400px;text-align:center}.subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:2rem;line-height:1.5}.input-container[_ngcontent-%COMP%]{display:flex;background:#f8f9fa;border:2px solid #e9ecef;border-radius:12px;overflow:hidden;margin:2rem 0}.country-code[_ngcontent-%COMP%]{padding:1rem;border-right:1px solid #e9ecef;font-weight:600}#mobileNumber[_ngcontent-%COMP%]{flex:1;padding:1rem;border:none;outline:none;font-size:1.1rem;background:transparent}#mobileNumber[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{background:#fee;border:1px solid #fcc;border-radius:8px;padding:.75rem 1rem;margin-bottom:1rem;color:#c33;font-size:.9rem;text-align:left}#recaptcha-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:1.5rem 0;min-height:78px}.continue-btn[_ngcontent-%COMP%]{width:100%;padding:1rem;font-weight:600;border-radius:12px;border:none;background:#dee2e6;color:#6c757d;margin-bottom:20px;cursor:pointer;transition:all .2s;font-size:1rem}.continue-btn.active[_ngcontent-%COMP%]{background:#ff6b35;color:#fff;box-shadow:0 4px 15px #ff6b354d;transform:translateY(-1px)}.continue-btn[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.6}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.privacy-text[_ngcontent-%COMP%]{font-size:.9rem;line-height:1.4}.light-grey[_ngcontent-%COMP%]{color:#6c757d}"]})};var fA=()=>[0,1,2,3,4,5];function pA(n,e){if(n&1){let t=Ye();b(0,"input",15),qt("ngModelChange",function(o){let s=fe(t).index,l=he();return $t(l.otp[s],o)||(l.otp[s]=o),pe(o)}),ie("input",function(){let o=fe(t).index,s=he();return pe(s.onOtpInput(o))}),P()}if(n&2){let t=e.index,i=he();Ge("error-border",i.hasError),jt("ngModel",i.otp[t])}}function mA(n,e){if(n&1&&(b(0,"p",16),U(1,"Resend in "),b(2,"span",17),U(3),P()()),n&2){let t=he();N(3),He("",t.countdown,"s")}}function gA(n,e){if(n&1){let t=Ye();b(0,"p",18),ie("click",function(){fe(t);let o=he();return pe(o.resend())}),U(1,"Resend OTP"),P()}}function _A(n,e){n&1&&(b(0,"div",19)(1,"div",20)(2,"div",21),X(3,"div",22),P(),b(4,"h2"),U(5,"Verified!"),P(),b(6,"p"),U(7,"Redirecting..."),P()()())}var _d=class n{constructor(e,t,i,o){this.router=e;this.cdr=t;this.phoneAuthService=i;this.auth=o;this.phone=this.phoneAuthService.getPhoneNumber(),this.confirmationResult=this.phoneAuthService.getConfirmationResult(),this.confirmationResult||this.router.navigate(["/phone-input"])}phone="";back=new yt;verified=new yt;otp=["","","","","",""];countdown=30;timerHandle;complete=!1;loading=!1;error="";confirmationResult=null;hasError=!1;isVerified=!1;recaptchaVerifier;ngOnInit(){this.startTimer(),setTimeout(()=>{this.recaptchaVerifier||(this.recaptchaVerifier=new uu(this.auth,"recaptcha-container-otp",{size:"invisible",callback:()=>{}}))})}startTimer(){clearInterval(this.timerHandle),this.countdown=30,this.timerHandle=setInterval(()=>{this.countdown>0?this.countdown--:clearInterval(this.timerHandle),this.cdr.detectChanges()},1e3)}onOtpInput(e){if(this.complete=this.otp.join("").length===6&&/^\d{6}$/.test(this.otp.join("")),this.error="",this.hasError=!1,this.otp[e]&&e<5){let t=document.querySelectorAll(".otp-input")[e+1];t&&t.focus()}}verify(){return q(this,null,function*(){if(!(!this.complete||this.loading||!this.confirmationResult)){this.loading=!0,this.error="",this.hasError=!1;try{let e=this.otp.join(""),t=yield this.confirmationResult.confirm(e);console.log("User signed in successfully:",t.user),this.isVerified=!0,this.loading=!1,setTimeout(()=>{this.router.navigate(["/location-permission"],{replaceUrl:!0})},2e3)}catch(e){console.error("Error verifying OTP:",e),e.code==="auth/invalid-verification-code"?this.error="Invalid OTP. Please check and try again.":e.code==="auth/code-expired"?this.error="OTP has expired. Please request a new one.":this.error="Verification failed. Please try again.",this.loading=!1,this.hasError=!0,this.otp=["","","","","",""],this.complete=!1}}})}resend(){return q(this,null,function*(){if(!this.loading){this.loading=!0,this.error="";try{console.log("Current stored phone:",this.phone);let e=this.phone;e.startsWith("+")||(e="+91"+e),console.log("Sending OTP to:",e);let t=yield this.phoneAuthService.sendOtp(e,this.recaptchaVerifier);this.confirmationResult=t,this.phoneAuthService.setConfirmationResult(t),this.startTimer(),this.otp=["","","","","",""],this.complete=!1,this.loading=!1}catch(e){console.error("Resend error:",e),this.error="Failed to resend OTP. Try again later.",this.loading=!1}}})}change(){this.router.navigate(["/phone-input"])}static \u0275fac=function(t){return new(t||n)(ne(Ke),ne(Rn),ne(ua),ne(Tt))};static \u0275cmp=nt({type:n,selectors:[["app-otp"]],outputs:{back:"back",verified:"verified"},standalone:!0,features:[it],decls:22,vars:8,consts:[[1,"otp-container"],[1,"otp-section"],[1,"otp-form"],[1,"otp-title"],[1,"otp-subtitle"],[1,"phone-number"],["class","otp-input","type","text","inputmode","numeric","maxlength","1",3,"error-border","ngModel","ngModelChange","input",4,"ngFor","ngForOf"],[1,"verify-btn",3,"click","disabled"],[1,"resend-container"],[1,"resend-text"],["class","timer",4,"ngIf"],["class","resend-link",3,"click",4,"ngIf"],[3,"click"],["id","recaptcha-container-otp"],["class","success-overlay",4,"ngIf"],["type","text","inputmode","numeric","maxlength","1",1,"otp-input",3,"ngModelChange","input","ngModel"],[1,"timer"],[1,"countdown"],[1,"resend-link",3,"click"],[1,"success-overlay"],[1,"success-content"],[1,"checkmark-circle"],[1,"checkmark","draw"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),U(4,"Verify Your Number"),P(),b(5,"p",4),U(6,"We've sent a 6-digit OTP to "),b(7,"span",5),U(8),P()(),b(9,"div",0),Pe(10,pA,1,3,"input",6),P(),b(11,"button",7),ie("click",function(){return i.verify()}),U(12),P(),b(13,"div",8)(14,"p",9),U(15,"Didn't receive OTP?"),P(),Pe(16,mA,4,1,"p",10)(17,gA,2,0,"p",11),P(),b(18,"div",12),ie("click",function(){return i.change()}),U(19,"\u2190 Change Number"),P(),X(20,"div",13),P()(),Pe(21,_A,8,0,"div",14),P()),t&2&&(N(8),Xe(i.phone),N(2),Z("ngForOf",s0(7,fA)),N(),Z("disabled",!i.complete||i.loading),N(),He(" ",i.loading?"Verifying OTP...":"Verify OTP"," "),N(4),Z("ngIf",i.countdown>0),N(),Z("ngIf",i.countdown===0),N(4),Z("ngIf",i.isVerified))},dependencies:[yn,on,vn,pc,fn,ct,en,Pt],styles:['.otp-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:2rem 1rem;background:#fff;font-family:Poppins,sans-serif}.otp-form[_ngcontent-%COMP%]{width:100%;max-width:400px;text-align:center}.otp-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#2c3e50;margin-bottom:.5rem}.otp-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#7f8c8d;margin-bottom:2.5rem}.phone-number[_ngcontent-%COMP%]{color:#ff6b35;font-weight:600}.otp-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem;margin-bottom:2rem;width:100%}@media (min-width: 400px){.otp-container[_ngcontent-%COMP%]{gap:1rem}}.otp-input[_ngcontent-%COMP%]{width:100%;max-width:45px;aspect-ratio:1;height:auto;border:1px solid #dee2e6;border-radius:12px;text-align:center;font-size:1.2rem;background:#fff;color:#495057;transition:all .2s;box-shadow:0 2px 5px #00000005;padding:0}@media (min-width: 400px){.otp-input[_ngcontent-%COMP%]{max-width:60px;font-size:1.5rem}}.otp-input[_ngcontent-%COMP%]:focus{border-color:#ff6b35;outline:none;box-shadow:0 0 0 3px #ff6b351a}.error-border[_ngcontent-%COMP%]{border-color:red!important;box-shadow:0 0 0 3px #ff00001a!important}.verify-btn[_ngcontent-%COMP%]{width:100%;padding:1rem;border-radius:12px;border:none;background:#dfe4ea;color:#495057;font-size:1rem;font-weight:600;cursor:not-allowed;margin-bottom:2rem;transition:all .2s}.verify-btn[_ngcontent-%COMP%]:not([disabled]){background:#ff6b35;color:#fff;cursor:pointer;box-shadow:0 4px 10px #ff6b354d}.resend-container[_ngcontent-%COMP%]{margin-bottom:2rem;color:#7f8c8d;font-size:.9rem}.resend-text[_ngcontent-%COMP%]{margin-bottom:.3rem;cursor:pointer;font-size:.9rem;transition:color .2s}.resend-text[_ngcontent-%COMP%]:hover{color:#495057}.timer[_ngcontent-%COMP%]{color:#7f8c8d}.timer[_ngcontent-%COMP%]   .countdown[_ngcontent-%COMP%]{color:#ff6b35;font-weight:600}.resend-link[_ngcontent-%COMP%]{color:#ff6b35;font-weight:600;cursor:pointer;text-decoration:underline}.success-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#fffffff2;display:flex;justify-content:center;align-items:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.success-content[_ngcontent-%COMP%]{text-align:center}.success-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin:1rem 0 .5rem;font-size:2rem}.success-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d}.checkmark-circle[_ngcontent-%COMP%]{width:80px;height:80px;position:relative;display:inline-block;vertical-align:top;border-radius:50%;background-color:#2ecc71;animation:_ngcontent-%COMP%_scaleIn .3s cubic-bezier(.175,.885,.32,1.275) forwards}.checkmark[_ngcontent-%COMP%]:after{content:"";display:block;width:20px;height:40px;border:solid #fff;border-width:0 4px 4px 0;position:absolute;top:16px;left:28px;transform:rotate(45deg);opacity:0;animation:_ngcontent-%COMP%_checkmark .3s ease-out .3s forwards}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_checkmark{0%{opacity:0;height:0}to{opacity:1;height:40px}}']})};var ii=class n{userLocation=null;constructor(){}getUserLocation(){return q(this,null,function*(){return this.userLocation?this.userLocation:new Promise((e,t)=>{if("geolocation"in navigator)navigator.geolocation.getCurrentPosition(i=>{this.userLocation={latitude:i.coords.latitude,longitude:i.coords.longitude},e(this.userLocation)},i=>{console.error("Error getting location:",i);let o={latitude:12.9352,longitude:77.6245};this.userLocation=o,e(o)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5});else{let i={latitude:12.9352,longitude:77.6245};this.userLocation=i,e(i)}})})}setUserLocation(e,t){this.userLocation={latitude:e,longitude:t}}calculateDistance(e,t,i,o){let l=this.toRadians(i-e),h=this.toRadians(o-t),d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(this.toRadians(e))*Math.cos(this.toRadians(i))*Math.sin(h/2)*Math.sin(h/2);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))}formatDistance(e){return e<1?`${Math.round(e*1e3)} m`:`${e.toFixed(1)} km`}getDistanceFromUser(e,t){return q(this,null,function*(){let i=yield this.getUserLocation(),o=this.calculateDistance(i.latitude,i.longitude,e,t);return this.formatDistance(o)})}toRadians(e){return e*(Math.PI/180)}clearLocation(){this.userLocation=null}findNearestArea(e,t){let i=[{name:"Adugodi",pincode:"560030",lat:12.9716,lng:77.5946},{name:"Agaram",pincode:"560007",lat:12.8431,lng:77.4863},{name:"Air Force Stn. Yelahanka",pincode:"560063",lat:13.1048,lng:77.5763},{name:"Banashankari",pincode:"560050",lat:12.925453,lng:77.546761},{name:"Banashankari 2nd Stage",pincode:"560070",lat:12.9249,lng:77.5662},{name:"Banashankari 3rd Stage",pincode:"560085",lat:12.9216,lng:77.5543},{name:"Banashankari 6th Stage",pincode:"560062",lat:12.8963,lng:77.5353},{name:"Banaswadi",pincode:"560043",lat:13.0159,lng:77.6516},{name:"Basavanapura",pincode:"560036",lat:12.9835,lng:77.6773},{name:"Basaveshwaranagar",pincode:"560079",lat:12.9975,lng:77.5334},{name:"Bellandur",pincode:"560103",lat:12.9304,lng:77.6784},{name:"Bidadi",pincode:"562109",lat:12.8274,lng:77.3971},{name:"Bilekahalli",pincode:"560076",lat:12.8989,lng:77.6103},{name:"Binnamangala",pincode:"560038",lat:12.9837,lng:77.6388},{name:"Bommanahalli",pincode:"560068",lat:12.9082,lng:77.6245},{name:"Bommasandra",pincode:"560099",lat:12.8009,lng:77.699},{name:"Brookefield",pincode:"560037",lat:12.9698,lng:77.7184},{name:"BTM 2nd Stage",pincode:"560076",lat:12.9167,lng:77.6108},{name:"Budigere",pincode:"562129",lat:13.035,lng:77.7478},{name:"Byatarayanapura",pincode:"560026",lat:13.056,lng:77.5926},{name:"C V Raman Nagar",pincode:"560093",lat:12.9767,lng:77.6597},{name:"Chamarajpet",pincode:"560018",lat:12.9582,lng:77.5709},{name:"Channasandra",pincode:"560067",lat:12.9629,lng:77.758},{name:"Chikbasavanapura",pincode:"560067",lat:12.9948,lng:77.7327},{name:"Chickpet",pincode:"560053",lat:12.9662,lng:77.5767},{name:"Chikkalasandra",pincode:"560061",lat:12.9132,lng:77.5454},{name:"Choodasandra",pincode:"560099",lat:12.8848,lng:77.6785},{name:"Cox Town",pincode:"560005",lat:12.9996,lng:77.6229},{name:"D J Halli",pincode:"560005",lat:13.0083,lng:77.6228},{name:"Doddabidarakallu",pincode:"560073",lat:13.0426,lng:77.5019},{name:"Doorvaninagar",pincode:"560016",lat:13.0252,lng:77.6688},{name:"Ejipura",pincode:"560047",lat:12.9437,lng:77.6274},{name:"Electronic City",pincode:"560100",lat:12.8394,lng:77.677},{name:"Frazer Town",pincode:"560005",lat:12.999,lng:77.6226},{name:"Gandhi Nagar",pincode:"560009",lat:12.9772,lng:77.573},{name:"Gavipuram Extn",pincode:"560019",lat:12.9552,lng:77.5668},{name:"Geddalahalli",pincode:"560077",lat:13.0309,lng:77.6389},{name:"Gottigere",pincode:"560083",lat:12.8725,lng:77.5944},{name:"Halasur",pincode:"560042",lat:12.9833,lng:77.6194},{name:"Hebbal",pincode:"560024",lat:13.0355,lng:77.606},{name:"Heggere",pincode:"560073",lat:13.0172,lng:77.5004},{name:"HMT Layout",pincode:"560031",lat:13.039,lng:77.547},{name:"Horamavu",pincode:"560043",lat:13.0267,lng:77.6571},{name:"Hosakerehalli",pincode:"560085",lat:12.9251,lng:77.536},{name:"HSR Layout",pincode:"560102",lat:12.9121,lng:77.6446},{name:"Hulimavu",pincode:"560076",lat:12.8829,lng:77.6083},{name:"Indiranagar",pincode:"560038",lat:12.9719,lng:77.6412},{name:"ISRO Layout",pincode:"560078",lat:12.9056,lng:77.5665},{name:"J P Nagar",pincode:"560078",lat:12.9041,lng:77.5852},{name:"Jakkur",pincode:"560064",lat:13.0811,lng:77.5924},{name:"Jalahalli",pincode:"560013",lat:13.0491,lng:77.5422},{name:"Jayanagar 4th T Block",pincode:"560041",lat:12.9352,lng:77.5837},{name:"Jigani",pincode:"560105",lat:12.7849,lng:77.642},{name:"Kadubeesanahalli",pincode:"560103",lat:12.956,lng:77.7026},{name:"Kadugodi",pincode:"560067",lat:12.9968,lng:77.7583},{name:"Kaggadasapura",pincode:"560093",lat:12.9782,lng:77.6801},{name:"Kalasipalyam",pincode:"560002",lat:12.9636,lng:77.5777},{name:"Kalyananagar",pincode:"560043",lat:13.0288,lng:77.6402},{name:"Kamakshipalya",pincode:"560079",lat:12.9829,lng:77.5208},{name:"Kengeri",pincode:"560060",lat:12.9177,lng:77.4822},{name:"Kodichikkanahalli",pincode:"560068",lat:12.8903,lng:77.6239},{name:"Koramangala",pincode:"560095",lat:12.9344,lng:77.6173},{name:"KR Puram",pincode:"560036",lat:13.0022,lng:77.6951},{name:"Kyalasanahalli",pincode:"560077",lat:13.0269,lng:77.6589},{name:"Laggere",pincode:"560058",lat:13.0102,lng:77.5157},{name:"Mahadevapura",pincode:"560048",lat:12.9923,lng:77.6957},{name:"Majestic",pincode:"560009",lat:12.9779,lng:77.572},{name:"Malleshpalya",pincode:"560075",lat:12.9839,lng:77.6702},{name:"Malleshwaram",pincode:"560003",lat:12.9999,lng:77.5715},{name:"Manorayanapalya",pincode:"560032",lat:13.0365,lng:77.5726},{name:"Marathahalli",pincode:"560037",lat:12.9563,lng:77.7019},{name:"Mathikere",pincode:"560054",lat:13.0307,lng:77.5639},{name:"Munnekollal",pincode:"560037",lat:12.9568,lng:77.7045},{name:"Nagarbhavi",pincode:"560072",lat:12.9674,lng:77.5049},{name:"Nayandahalli",pincode:"560039",lat:12.9413,lng:77.5159},{name:"Neelasandra",pincode:"560047",lat:12.9479,lng:77.6236},{name:"Peenya",pincode:"560058",lat:13.0194,lng:77.5153},{name:"Raghuvanahalli",pincode:"560062",lat:12.8821,lng:77.5466},{name:"Rajajinagar",pincode:"560010",lat:12.9989,lng:77.5536},{name:"Ramamurthy Nagar",pincode:"560016",lat:13.0045,lng:77.6797},{name:"RT Nagar",pincode:"560032",lat:13.0266,lng:77.5979},{name:"Sadashivanagar",pincode:"560080",lat:13.0093,lng:77.5772},{name:"Shanti Nagar",pincode:"560027",lat:12.9537,lng:77.5926},{name:"Tavarekere",pincode:"560029",lat:12.931,lng:77.6106},{name:"Varthur",pincode:"560087",lat:12.9352,lng:77.7501},{name:"Vidyaranyapura",pincode:"560097",lat:13.067,lng:77.56}],o="Bangalore",s=1/0;for(let l of i){let h=this.calculateDistance(e,t,l.lat,l.lng);h<s&&(s=h,o=l.name)}return o}static \u0275fac=function(t){return new(t||n)};static \u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})};var vA=["searchInput"];function yA(n,e){if(n&1){let t=Ye();b(0,"div",33),ie("click",function(){let o=fe(t).$implicit,s=he(2);return pe(s.selectLocation(o))}),b(1,"div",3),ye(),b(2,"svg",34),X(3,"path",35),P()(),Ve(),b(4,"div",36)(5,"div",37),U(6),P(),b(7,"div",38),U(8),P()(),ye(),b(9,"svg",39),X(10,"path",40),P()()}if(n&2){let t=e.$implicit;N(6),Xe(t.name),N(2),He("Pincode: ",t.pincode,"")}}function wA(n,e){n&1&&(b(0,"div",41),ye(),b(1,"svg",42),X(2,"circle",27)(3,"path",28),P(),Ve(),b(4,"p"),U(5,"No locations found"),P(),b(6,"span"),U(7,"Try searching for a different area"),P()())}function CA(n,e){if(n&1){let t=Ye();b(0,"div",19),ie("click",function(){fe(t);let o=he();return pe(o.closeLocationModal())}),b(1,"div",20),ie("click",function(o){return fe(t),pe(o.stopPropagation())}),b(2,"div",21)(3,"h2"),U(4,"Select Location"),P(),b(5,"button",22),ie("click",function(){fe(t);let o=he();return pe(o.closeLocationModal())}),ye(),b(6,"svg",23),X(7,"path",24),P()()(),Ve(),b(8,"div",25),ye(),b(9,"svg",26),X(10,"circle",27)(11,"path",28),P(),Ve(),b(12,"input",29,0),qt("ngModelChange",function(o){fe(t);let s=he();return $t(s.searchQuery,o)||(s.searchQuery=o),pe(o)}),P()(),b(14,"div",30),Pe(15,yA,11,2,"div",31)(16,wA,8,0,"div",32),P()()()}if(n&2){let t=he();N(12),jt("ngModel",t.searchQuery),N(3),Z("ngForOf",t.filteredLocations),N(),Z("ngIf",t.filteredLocations.length===0)}}var vd=class n{constructor(e,t){this.router=e;this.locationService=t}searchInput;showLocationModal=!1;searchQuery="";locations=[{name:"Adugodi",pincode:"560030",lat:12.9716,lng:77.5946},{name:"Agaram",pincode:"560007",lat:12.8431,lng:77.4863},{name:"Air Force Stn. Yelahanka",pincode:"560063",lat:13.1048,lng:77.5763},{name:"Banashankari",pincode:"560050",lat:12.925453,lng:77.546761},{name:"Banashankari 2nd Stage",pincode:"560070",lat:12.9249,lng:77.5662},{name:"Banashankari 3rd Stage",pincode:"560085",lat:12.9216,lng:77.5543},{name:"Banashankari 6th Stage",pincode:"560062",lat:12.8963,lng:77.5353},{name:"Banaswadi",pincode:"560043",lat:13.0159,lng:77.6516},{name:"Basavanapura",pincode:"560036",lat:12.9835,lng:77.6773},{name:"Basaveshwaranagar",pincode:"560079",lat:12.9975,lng:77.5334},{name:"Bellandur",pincode:"560103",lat:12.9304,lng:77.6784},{name:"Bidadi",pincode:"562109",lat:12.8274,lng:77.3971},{name:"Bilekahalli",pincode:"560076",lat:12.8989,lng:77.6103},{name:"Binnamangala",pincode:"560038",lat:12.9837,lng:77.6388},{name:"Bommanahalli",pincode:"560068",lat:12.9082,lng:77.6245},{name:"Bommasandra",pincode:"560099",lat:12.8009,lng:77.699},{name:"Brookefield",pincode:"560037",lat:12.9698,lng:77.7184},{name:"BTM 2nd Stage",pincode:"560076",lat:12.9167,lng:77.6108},{name:"Budigere",pincode:"562129",lat:13.035,lng:77.7478},{name:"Byatarayanapura",pincode:"560026",lat:13.056,lng:77.5926},{name:"C V Raman Nagar",pincode:"560093",lat:12.9767,lng:77.6597},{name:"Chamarajpet",pincode:"560018",lat:12.9582,lng:77.5709},{name:"Channasandra",pincode:"560067",lat:12.9629,lng:77.758},{name:"Chikbasavanapura",pincode:"560067",lat:12.9948,lng:77.7327},{name:"Chickpet",pincode:"560053",lat:12.9662,lng:77.5767},{name:"Chikkalasandra",pincode:"560061",lat:12.9132,lng:77.5454},{name:"Choodasandra",pincode:"560099",lat:12.8848,lng:77.6785},{name:"Cox Town",pincode:"560005",lat:12.9996,lng:77.6229},{name:"D J Halli",pincode:"560005",lat:13.0083,lng:77.6228},{name:"Doddabidarakallu",pincode:"560073",lat:13.0426,lng:77.5019},{name:"Doorvaninagar",pincode:"560016",lat:13.0252,lng:77.6688},{name:"Ejipura",pincode:"560047",lat:12.9437,lng:77.6274},{name:"Electronic City",pincode:"560100",lat:12.8394,lng:77.677},{name:"Frazer Town",pincode:"560005",lat:12.999,lng:77.6226},{name:"Gandhi Nagar",pincode:"560009",lat:12.9772,lng:77.573},{name:"Gavipuram Extn",pincode:"560019",lat:12.9552,lng:77.5668},{name:"Geddalahalli",pincode:"560077",lat:13.0309,lng:77.6389},{name:"Gottigere",pincode:"560083",lat:12.8725,lng:77.5944},{name:"Halasur",pincode:"560042",lat:12.9833,lng:77.6194},{name:"Hebbal",pincode:"560024",lat:13.0355,lng:77.606},{name:"Heggere",pincode:"560073",lat:13.0172,lng:77.5004},{name:"HMT Layout",pincode:"560031",lat:13.039,lng:77.547},{name:"Horamavu",pincode:"560043",lat:13.0267,lng:77.6571},{name:"Hosakerehalli",pincode:"560085",lat:12.9251,lng:77.536},{name:"HSR Layout",pincode:"560102",lat:12.9121,lng:77.6446},{name:"Hulimavu",pincode:"560076",lat:12.8829,lng:77.6083},{name:"Indiranagar",pincode:"560038",lat:12.9719,lng:77.6412},{name:"ISRO Layout",pincode:"560078",lat:12.9056,lng:77.5665},{name:"J P Nagar",pincode:"560078",lat:12.9041,lng:77.5852},{name:"Jakkur",pincode:"560064",lat:13.0811,lng:77.5924},{name:"Jalahalli",pincode:"560013",lat:13.0491,lng:77.5422},{name:"Jayanagar 4th T Block",pincode:"560041",lat:12.9352,lng:77.5837},{name:"Jigani",pincode:"560105",lat:12.7849,lng:77.642},{name:"Kadubeesanahalli",pincode:"560103",lat:12.956,lng:77.7026},{name:"Kadugodi",pincode:"560067",lat:12.9968,lng:77.7583},{name:"Kaggadasapura",pincode:"560093",lat:12.9782,lng:77.6801},{name:"Kalasipalyam",pincode:"560002",lat:12.9636,lng:77.5777},{name:"Kalyananagar",pincode:"560043",lat:13.0288,lng:77.6402},{name:"Kamakshipalya",pincode:"560079",lat:12.9829,lng:77.5208},{name:"Kengeri",pincode:"560060",lat:12.9177,lng:77.4822},{name:"Kodichikkanahalli",pincode:"560068",lat:12.8903,lng:77.6239},{name:"Koramangala",pincode:"560095",lat:12.9344,lng:77.6173},{name:"KR Puram",pincode:"560036",lat:13.0022,lng:77.6951},{name:"Kyalasanahalli",pincode:"560077",lat:13.0269,lng:77.6589},{name:"Laggere",pincode:"560058",lat:13.0102,lng:77.5157},{name:"Mahadevapura",pincode:"560048",lat:12.9923,lng:77.6957},{name:"Majestic",pincode:"560009",lat:12.9779,lng:77.572},{name:"Malleshpalya",pincode:"560075",lat:12.9839,lng:77.6702},{name:"Malleshwaram",pincode:"560003",lat:12.9999,lng:77.5715},{name:"Manorayanapalya",pincode:"560032",lat:13.0365,lng:77.5726},{name:"Marathahalli",pincode:"560037",lat:12.9563,lng:77.7019},{name:"Mathikere",pincode:"560054",lat:13.0307,lng:77.5639},{name:"Munnekollal",pincode:"560037",lat:12.9568,lng:77.7045},{name:"Nagarbhavi",pincode:"560072",lat:12.9674,lng:77.5049},{name:"Nayandahalli",pincode:"560039",lat:12.9413,lng:77.5159},{name:"Neelasandra",pincode:"560047",lat:12.9479,lng:77.6236},{name:"Peenya",pincode:"560058",lat:13.0194,lng:77.5153},{name:"Raghuvanahalli",pincode:"560062",lat:12.8821,lng:77.5466},{name:"Rajajinagar",pincode:"560010",lat:12.9989,lng:77.5536},{name:"Ramamurthy Nagar",pincode:"560016",lat:13.0045,lng:77.6797},{name:"RT Nagar",pincode:"560032",lat:13.0266,lng:77.5979},{name:"Sadashivanagar",pincode:"560080",lat:13.0093,lng:77.5772},{name:"Shanti Nagar",pincode:"560027",lat:12.9537,lng:77.5926},{name:"Tavarekere",pincode:"560029",lat:12.931,lng:77.6106},{name:"Varthur",pincode:"560087",lat:12.9352,lng:77.7501},{name:"Vidyaranyapura",pincode:"560097",lat:13.067,lng:77.56}];ngAfterViewInit(){this.showLocationModal&&this.searchInput&&setTimeout(()=>this.searchInput?.nativeElement.focus(),300)}allow(){"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e=>{let t=e.coords.latitude,i=e.coords.longitude,o=this.locationService.findNearestArea(t,i);this.locationService.setUserLocation(t,i),this.router.navigate(["/main-app"],{replaceUrl:!0,state:{location:o,latitude:t,longitude:i}})},e=>{console.error("Location error:",e),alert("Location denied or unavailable")},{enableHighAccuracy:!0,timeout:1e4}):alert("Geolocation not supported")}manual(){this.showLocationModal=!0,this.searchQuery="",setTimeout(()=>this.searchInput?.nativeElement.focus(),300)}closeLocationModal(){this.showLocationModal=!1,this.searchQuery=""}selectLocation(e){this.locationService.setUserLocation(e.lat,e.lng),this.router.navigate(["/main-app"],{replaceUrl:!0,state:{location:e.name,latitude:e.lat,longitude:e.lng}})}get filteredLocations(){if(!this.searchQuery.trim())return this.locations;let e=this.searchQuery.toLowerCase();return this.locations.filter(t=>t.name.toLowerCase().includes(e)||t.pincode.includes(e))}static \u0275fac=function(t){return new(t||n)(ne(Ke),ne(ii))};static \u0275cmp=nt({type:n,selectors:[["app-location-permission"]],viewQuery:function(t,i){if(t&1&&Zn(vA,5),t&2){let o;xn(o=Mn())&&(i.searchInput=o.first)}},standalone:!0,features:[it],decls:31,vars:1,consts:[["searchInput",""],[1,"location-section"],[1,"location-form"],[1,"location-icon"],["width","80","height","80","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","locationGradient","x1","0%","y1","0%","x2","100%","y2","100%"],["offset","0%",2,"stop-color","#ff6b35","stop-opacity","1"],["offset","100%",2,"stop-color","#ff8c5a","stop-opacity","1"],["d","M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z","fill","url(#locationGradient)"],[1,"location-title"],[1,"location-subtitle"],[1,"location-benefits"],[1,"benefit-item"],[1,"benefit-icon"],[1,"benefit-text"],[1,"allow-location-btn",3,"click"],[1,"manual-location-btn",3,"click"],[1,"location-privacy"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"location-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M18 6L6 18M6 6l12 12","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"search-box"],["width","20","height","20","viewBox","0 0 24 24","fill","none",1,"search-icon"],["cx","11","cy","11","r","8","stroke","currentColor","stroke-width","2"],["d","M21 21l-4.35-4.35","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["type","text","placeholder","Search for a location...",1,"search-input",3,"ngModelChange","ngModel"],[1,"locations-list"],["class","location-item",3,"click",4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],[1,"location-item",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none"],["d","M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z","fill","currentColor"],[1,"location-info"],[1,"location-name"],[1,"location-area"],["width","20","height","20","viewBox","0 0 24 24","fill","none",1,"chevron-right"],["d","M9 18l6-6-6-6","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"no-results"],["width","48","height","48","viewBox","0 0 24 24","fill","none"]],template:function(t,i){t&1&&(b(0,"div",1)(1,"div",2)(2,"div",3),ye(),b(3,"svg",4)(4,"defs")(5,"linearGradient",5),X(6,"stop",6)(7,"stop",7),P()(),X(8,"path",8),P()(),Ve(),b(9,"h2",9),U(10,"Find Street Food Near You"),P(),b(11,"p",10),U(12,"We need your location to show you the best street food options around you"),P(),b(13,"div",11)(14,"div",12)(15,"span",13),U(16,"\u{1F3AF}"),P(),b(17,"span",14),U(18,"Discover food stalls nearby"),P()(),b(19,"div",12)(20,"span",13),U(21,"\u{1F4B0}"),P(),b(22,"span",14),U(23,"See accurate prices & distance"),P()()(),b(24,"button",15),ie("click",function(){return i.allow()}),U(25,"Allow Location Access"),P(),b(26,"button",16),ie("click",function(){return i.manual()}),U(27,"Select Location Manually"),P(),b(28,"p",17),U(29,"Your location data is secure and only used to show nearby food options."),P()(),Pe(30,CA,17,3,"div",18),P()),t&2&&(N(30),Z("ngIf",i.showLocationModal))},dependencies:[ct,en,Pt,yn,on,vn,fn],styles:[".location-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:2rem 1.5rem;background:#fff;font-family:Poppins,sans-serif}.location-form[_ngcontent-%COMP%]{width:100%;max-width:400px;text-align:center}.location-icon[_ngcontent-%COMP%]{margin-bottom:1.5rem;display:inline-block;animation:_ngcontent-%COMP%_float 3s ease-in-out infinite}.location-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 4px 12px rgba(255,107,53,.3))}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.location-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#2c3e50;margin-bottom:.5rem}.location-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#7f8c8d;margin-bottom:2.5rem;line-height:1.5}.location-benefits[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:2.5rem}.benefit-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem;border-radius:12px;text-align:left}.benefit-icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-right:1rem;width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:#fff;border-radius:50%;box-shadow:0 2px 5px #0000000d}.benefit-text[_ngcontent-%COMP%]{font-weight:500;color:#34495e}.allow-location-btn[_ngcontent-%COMP%]{width:100%;padding:1.2rem;background:#ff6b35;color:#fff;border-radius:12px;border:none;font-size:1.1rem;font-weight:600;cursor:pointer;box-shadow:0 4px 15px #ff6b354d;transition:transform .2s;display:flex;align-items:center;justify-content:center;gap:.5rem;margin-bottom:1rem}.allow-location-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.manual-location-btn[_ngcontent-%COMP%]{width:100%;padding:1.1rem;border-radius:12px;border:2px solid #e9ecef;background:#fff;color:#7f8c8d;font-weight:600;cursor:pointer;transition:all .2s}.manual-location-btn[_ngcontent-%COMP%]:hover{border-color:#ced4da;color:#495057}.location-privacy[_ngcontent-%COMP%]{font-size:.8rem;color:#adb5bd;margin-top:2rem;padding:1rem;background:#f8f9fa;border-radius:8px;border-left:3px solid #ff6b35;text-align:left;line-height:1.4}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;backdrop-filter:blur(1px);z-index:100;display:flex;align-items:flex-end;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.location-modal[_ngcontent-%COMP%]{background:#1a1a1a;width:100%;max-height:80vh;border-radius:24px 24px 0 0;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(100%)}to{transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 20px 16px;border-bottom:1px solid rgba(255,255,255,.1)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#fff;margin:0}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:transparent;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#888;cursor:pointer;border-radius:50%;transition:all .2s ease}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#fff}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.search-box[_ngcontent-%COMP%]{padding:16px 20px;position:relative;border-bottom:1px solid rgba(255,255,255,.1)}.search-box[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:36px;top:50%;transform:translateY(-50%);color:#666;pointer-events:none}.search-box[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:14px 16px 14px 48px;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:12px;color:#fff;font-size:15px;transition:all .2s ease;box-sizing:border-box}.search-box[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#666}.search-box[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;background:#ffffff14;border-color:#ff6b35;box-shadow:0 0 0 3px #ff6b351a}.locations-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.location-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px 20px;cursor:pointer;transition:all .2s ease;border-bottom:1px solid rgba(255,255,255,.05)}.location-item[_ngcontent-%COMP%]:hover{background:#ffffff0d}.location-item[_ngcontent-%COMP%]:active{background:#ffffff1a;transform:scale(.98)}.location-item[_ngcontent-%COMP%]   .location-icon[_ngcontent-%COMP%]{width:40px;height:40px;background:#ff6b351a;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#ff6b35;flex-shrink:0}.location-item[_ngcontent-%COMP%]   .location-info[_ngcontent-%COMP%]{flex:1;min-width:0}.location-item[_ngcontent-%COMP%]   .location-info[_ngcontent-%COMP%]   .location-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff;margin-bottom:4px}.location-item[_ngcontent-%COMP%]   .location-info[_ngcontent-%COMP%]   .location-area[_ngcontent-%COMP%]{font-size:13px;color:#888}.location-item[_ngcontent-%COMP%]   .chevron-right[_ngcontent-%COMP%]{color:#666;flex-shrink:0}.no-results[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center;color:#666}.no-results[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0 0 8px;color:#888}.no-results[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#666}@media (min-width: 768px){.location-modal[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;border-radius:24px;max-height:70vh}.modal-overlay[_ngcontent-%COMP%]{align-items:center}}"],data:{animation:[lp("fadeIn",[Dl(":enter",[Mi({opacity:0}),Pl("200ms ease-out",Mi({opacity:1}))]),Dl(":leave",[Pl("200ms ease-in",Mi({opacity:0}))])]),lp("slideUp",[Dl(":enter",[Mi({transform:"translateY(100%)",opacity:0}),Pl("300ms cubic-bezier(0.4, 0, 0.2, 1)",Mi({transform:"translateY(0)",opacity:1}))]),Dl(":leave",[Pl("200ms ease-in",Mi({transform:"translateY(100%)",opacity:0}))])])]}})};var bA=["videoEl"];function EA(n,e){n&1&&X(0,"div",30)}function SA(n,e){if(n&1){let t=Ye();b(0,"button",31),ie("click",function(o){fe(t);let s=he(2);return pe(s.retryLoad(o))}),ye(),b(1,"svg",32),X(2,"path",33)(3,"path",34),P(),Ve(),b(4,"span"),U(5,"Retry"),P()()}}function TA(n,e){if(n&1&&(b(0,"div",27),Pe(1,EA,1,0,"div",28)(2,SA,6,0,"button",29),P()),n&2){let t=he();N(),Z("ngIf",!t.showRetry),N(),Z("ngIf",t.showRetry)}}function PA(n,e){n&1&&(b(0,"div",35),ye(),b(1,"svg",36),X(2,"path",37),P()())}function DA(n,e){n&1&&(ye(),b(0,"svg",41),X(1,"path",42),P())}function IA(n,e){n&1&&(ye(),b(0,"svg",41),X(1,"path",43),P())}function AA(n,e){if(n&1&&(b(0,"div",38)(1,"div",39),Pe(2,DA,2,0,"svg",40)(3,IA,2,0,"svg",40),P()()),n&2){let t=he();N(2),Z("ngIf",t.isMuted),N(),Z("ngIf",!t.isMuted)}}function xA(n,e){if(n&1&&(b(0,"div",44),ye(),b(1,"svg",45),X(2,"path",46)(3,"circle",47),P(),Ve(),b(4,"span",48),U(5),P()()),n&2){let t=he();N(5),Xe(t.formatViewCount(t.displayViewCount))}}function MA(n,e){if(n&1&&(b(0,"span",49),U(1),P()),n&2){let t=he();N(),Xe(t.displayLikes)}}var gc=class n{reel;src="";poster="";title="";vendor="";price="";distance="";active=!1;relativeIndex=0;priority="low";likes=0;viewCount=0;isLiked=!1;isBookmarked=!1;liked=new yt;bookmarked=new yt;shared=new yt;videoEl;lastTapTime=0;showLikeAnimation=!1;isProgressBarVisible=!1;progressBarHideTimeout;singleTapTimeout;get displaySrc(){return this.reel?.videoUrl||this.src}get displayPoster(){return this.reel?.thumbnailUrl||this.poster}get displayTitle(){return this.reel?.title||this.title}get displayVendor(){return this.reel?.vendor||this.vendor}get displayPrice(){return this.reel?.price||this.price}get displayDistance(){return this.reel?.distance||this.distance}get displayLikes(){return this.reel?.likes||this.likes}get displayViewCount(){return this.reel?.viewCount||this.viewCount}get displayIsLiked(){return this.reel?this.reel.isLiked||!1:this.isLiked}get displayIsBookmarked(){return this.reel?this.reel.isBookmarked||!1:this.isBookmarked}isLoading=!0;progress=0;isSeeking=!1;isMuted=!0;muteChanged=new yt;showMuteIcon=!1;progressInterval;ngOnChanges(e){if(e.reel||e.src){let t=this.displaySrc,i=e.reel?.previousValue?.videoUrl||e.src?.previousValue;t!==i&&(this.isLoading=!0,this.videoEl&&this.videoEl.nativeElement&&this.videoEl.nativeElement.load())}e.isMuted&&this.videoEl?.nativeElement&&(this.videoEl.nativeElement.muted=this.isMuted),e.priority&&this.priority==="high"&&this.videoEl?.nativeElement&&this.videoEl.nativeElement.load()}ngAfterViewInit(){let e=this.videoEl.nativeElement;["loadstart","loadedmetadata","loadeddata","canplay","playing","waiting","error","stalled","suspend","emptied"].forEach(i=>{e.addEventListener(i,()=>{(i==="playing"||i==="canplay"||i==="loadeddata")&&(this.isLoading=!1,this.startProgressTracking()),i==="waiting"&&(this.isLoading=!0),i==="error"&&(console.error("[VideoCard] Video error:",e.error),this.isLoading=!1),i==="ended"&&(this.progress=0)})}),this.checkVideoReady(),this.priority==="high"&&e.load(),setTimeout(()=>{this.isLoading&&(console.warn("[VideoCard] Loading timed out, hiding spinner"),this.isLoading=!1)},2e3)}startProgressTracking(){this.progressInterval&&clearInterval(this.progressInterval);let e=this.videoEl?.nativeElement;e&&(this.progressInterval=setInterval(()=>{!this.isSeeking&&e.duration&&(this.progress=e.currentTime/e.duration*100)},50))}ngOnDestroy(){this.progressInterval&&clearInterval(this.progressInterval),this.progressBarHideTimeout&&clearTimeout(this.progressBarHideTimeout)}checkVideoReady(){this.videoEl&&this.videoEl.nativeElement&&this.videoEl.nativeElement.readyState>=3&&(this.isLoading=!1)}showRetry=!1;playWatchdogTimeout;play(){let e=this.videoEl?.nativeElement;if(e){e.muted=this.isMuted,e.currentTime=0,e.readyState<3&&(this.isLoading=!0,this.showRetry=!1);let t=e.play();t!==void 0&&t.catch(i=>{console.error("[VideoCard] Error playing video:",i),this.isLoading=!1}),this.playWatchdogTimeout&&clearTimeout(this.playWatchdogTimeout),this.playWatchdogTimeout=setTimeout(()=>{(e.paused||e.readyState<3)&&(console.warn("[VideoCard] Playback stalled, showing retry"),this.isLoading=!0,this.showRetry=!0)},3e3)}}retryLoad(e){e.stopPropagation(),this.showRetry=!1,this.isLoading=!0;let t=this.videoEl?.nativeElement;t&&(t.load(),t.play().catch(console.error))}preload(){let e=this.videoEl?.nativeElement;e&&(e.preload="auto",e.load())}pause(){this.playWatchdogTimeout&&clearTimeout(this.playWatchdogTimeout),this.videoEl?.nativeElement.pause()}bookmark(){this.reel||(this.isBookmarked=!this.isBookmarked),this.bookmarked.emit()}openGoogleMaps(){if(this.reel?.latitude&&this.reel?.longitude){let{latitude:e,longitude:t}=this.reel,i=`https://www.google.com/maps?q=${e},${t}`;window.open(i,"_blank")}else console.warn("No location data available for this reel")}share(){this.shared.emit()}toggleLike(){this.reel||(this.isLiked=!this.isLiked),this.liked.emit(),this.isLiked&&this.showLikeAnimationEffect()}toggleMute(){let e=this.videoEl?.nativeElement;if(e){e.paused&&e.play().catch(i=>console.error("[VideoCard] Error playing on tap:",i));let t=!this.isMuted;e.muted=t,this.isMuted=t,this.muteChanged.emit(t),this.showMuteAnimation(),this.isProgressBarVisible=!0,this.progressBarHideTimeout&&clearTimeout(this.progressBarHideTimeout),this.progressBarHideTimeout=setTimeout(()=>{this.isProgressBarVisible=!1},2e3)}}showMuteAnimation(){this.showMuteIcon=!0,setTimeout(()=>{this.showMuteIcon=!1},1e3)}doubleTapLike(){this.isLiked?this.showLikeAnimationEffect():this.toggleLike()}onVideoTap(e){e.preventDefault();let t=new Date().getTime(),i=t-this.lastTapTime;i<300&&i>0?(this.singleTapTimeout&&(clearTimeout(this.singleTapTimeout),this.singleTapTimeout=void 0),this.doubleTapLike(),this.lastTapTime=0):(this.lastTapTime=t,this.singleTapTimeout=window.setTimeout(()=>{this.toggleMute(),this.singleTapTimeout=void 0},300))}toggleProgressBar(){this.progressBarHideTimeout&&clearTimeout(this.progressBarHideTimeout),this.isProgressBarVisible=!this.isProgressBarVisible,this.isProgressBarVisible&&(this.progressBarHideTimeout=setTimeout(()=>{this.isProgressBarVisible=!1},3e3))}showLikeAnimationEffect(){this.showLikeAnimation=!0,setTimeout(()=>{this.showLikeAnimation=!1},1e3)}formatViewCount(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}onProgressBarClick(e){e.stopPropagation(),this.seekToPosition(e)}onProgressBarTouchStart(e){this.isSeeking=!0,this.seekToPosition(e)}onProgressBarTouchMove(e){this.isSeeking&&this.seekToPosition(e)}onProgressBarTouchEnd(){this.isSeeking=!1}seekToPosition(e){let i=e.currentTarget.getBoundingClientRect(),o;if(e instanceof MouseEvent)o=e.clientX;else{let d=e.touches[0]||e.changedTouches[0];if(!d)return;o=d.clientX}let l=Math.max(0,Math.min(o-i.left,i.width))/i.width,h=this.videoEl?.nativeElement;h&&h.readyState>0&&(h.currentTime=l*h.duration,this.progress=l*100)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=nt({type:n,selectors:[["app-video-card"]],viewQuery:function(t,i){if(t&1&&Zn(bA,5),t&2){let o;xn(o=Mn())&&(i.videoEl=o.first)}},inputs:{reel:"reel",src:"src",poster:"poster",title:"title",vendor:"vendor",price:"price",distance:"distance",active:"active",relativeIndex:"relativeIndex",priority:"priority",likes:"likes",viewCount:"viewCount",isLiked:"isLiked",isBookmarked:"isBookmarked",isMuted:"isMuted"},outputs:{liked:"liked",bookmarked:"bookmarked",shared:"shared",muteChanged:"muteChanged"},standalone:!0,features:[ui,it],decls:32,vars:29,consts:[["videoEl",""],[1,"video-card"],["loop","","playsinline","","webkit-playsinline","","x-webkit-airplay","allow","disablePictureInPicture","",1,"video-player",3,"click","touchend","muted","preload","poster","src"],["class","loading-spinner",4,"ngIf"],["class","like-animation",4,"ngIf"],["class","mute-animation",4,"ngIf"],[1,"video-overlay"],[1,"video-info"],[1,"food-details"],[1,"dish-name"],[1,"vendor-name"],[1,"price-distance"],[1,"price"],[1,"distance"],[1,"action-buttons"],["class","view-count-action",4,"ngIf"],[1,"action-btn","like-btn",3,"click"],["width","28","height","28","viewBox","0 0 24 24",1,"action-icon"],["d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["class","like-count",4,"ngIf"],[1,"action-btn","bookmark-btn",3,"click"],["d","M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"action-btn","map-btn",3,"click"],["width","28","height","28","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"action-icon","navigate-icon"],["points","3 11 22 2 13 21 11 13 3 11"],[1,"progress-container",3,"click","touchstart","touchmove","touchend","mouseenter","mouseleave"],[1,"progress-bar"],[1,"loading-spinner"],["class","spinner",4,"ngIf"],["class","retry-btn",3,"click",4,"ngIf"],[1,"spinner"],[1,"retry-btn",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M23 4v6h-6M1 20v-6h6"],["d","M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 1 20.49 15"],[1,"like-animation"],["width","100","height","100","viewBox","0 0 24 24","fill","white"],["d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"],[1,"mute-animation"],[1,"mute-icon-bg"],["width","40","height","40","viewBox","0 0 24 24","fill","white",4,"ngIf"],["width","40","height","40","viewBox","0 0 24 24","fill","white"],["d","M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73 4.27 3zM12 4L9.91 6.09 12 8.18V4z"],["d","M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"],[1,"view-count-action"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z","stroke","currentColor","stroke-width","2"],["cx","12","cy","12","r","3","stroke","currentColor","stroke-width","2"],[1,"count-text"],[1,"like-count"]],template:function(t,i){if(t&1){let o=Ye();b(0,"div",1)(1,"video",2,0),ie("click",function(l){return fe(o),pe(i.onVideoTap(l))})("touchend",function(l){return fe(o),pe(i.onVideoTap(l))}),P(),Pe(3,TA,3,2,"div",3)(4,PA,3,0,"div",4)(5,AA,4,2,"div",5),b(6,"div",6)(7,"div",7)(8,"div",8)(9,"h3",9),U(10),P(),b(11,"p",10),U(12),P(),b(13,"div",11)(14,"span",12),U(15),P(),b(16,"span",13),U(17),P()()()(),b(18,"div",14),Pe(19,xA,6,1,"div",15),b(20,"button",16),ie("click",function(){return fe(o),pe(i.toggleLike())}),ye(),b(21,"svg",17),X(22,"path",18),P(),Pe(23,MA,2,1,"span",19),P(),Ve(),b(24,"button",20),ie("click",function(){return fe(o),pe(i.bookmark())}),ye(),b(25,"svg",17),X(26,"path",21),P()(),Ve(),b(27,"button",22),ie("click",function(){return fe(o),pe(i.openGoogleMaps())}),ye(),b(28,"svg",23),X(29,"polygon",24),P()()()(),Ve(),b(30,"div",25),ie("click",function(l){return fe(o),pe(i.onProgressBarClick(l))})("touchstart",function(l){return fe(o),pe(i.onProgressBarTouchStart(l))})("touchmove",function(l){return fe(o),pe(i.onProgressBarTouchMove(l))})("touchend",function(){return fe(o),pe(i.onProgressBarTouchEnd())})("mouseenter",function(){return fe(o),pe(i.isProgressBarVisible=!0)})("mouseleave",function(){return fe(o),pe(i.isProgressBarVisible=!1)}),X(31,"div",26),P()()}t&2&&(Ge("active",i.active)("prev",i.relativeIndex<0)("next",i.relativeIndex>0),N(),Z("muted",i.isMuted)("preload",i.priority==="high"?"auto":"none")("poster",i.displayPoster,Wn)("src",i.displaySrc,Wn),N(2),Z("ngIf",i.isLoading),N(),Z("ngIf",i.showLikeAnimation),N(),Z("ngIf",i.showMuteIcon),N(5),Xe(i.displayTitle),N(2),Xe(i.displayVendor),N(3),He("\u20B9",i.displayPrice,""),N(2),Xe(i.displayDistance),N(2),Z("ngIf",i.displayViewCount>0),N(),Ge("liked",i.displayIsLiked),N(),tr("fill",i.displayIsLiked?"currentColor":"none"),N(2),Z("ngIf",i.displayLikes>0),N(),Ge("bookmarked",i.displayIsBookmarked),N(),tr("fill",i.displayIsBookmarked?"currentColor":"none"),N(5),Ge("visible",i.isProgressBarVisible),N(),Rr("width",i.progress,"%"))},dependencies:[ct,Pt],styles:[".video-card[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;transform:translateY(100%);transition:transform .4s cubic-bezier(.25,1,.5,1);background:#000;overflow:hidden;z-index:1}.video-card.prev[_ngcontent-%COMP%]{transform:translateY(-100%)}.video-card.next[_ngcontent-%COMP%]{transform:translateY(100%)}.video-card.active[_ngcontent-%COMP%]{transform:translateY(0);z-index:2}.video-player[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.progress-container[_ngcontent-%COMP%]{position:absolute;bottom:53px;left:0;width:100%;height:3px;background-color:#fff3;z-index:95;cursor:pointer;transition:opacity .3s ease;opacity:1;pointer-events:auto;margin:0;padding:0}.progress-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{height:100%;background-color:#fff;width:0%;transition:width .1s linear;box-shadow:0 0 10px #ffffff80}.progress-container[_ngcontent-%COMP%]:hover, .progress-container[_ngcontent-%COMP%]:active{height:4px;background-color:#ffffff4d}.loading-spinner[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#0000004d;z-index:10;gap:1rem}.loading-spinner[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}.loading-spinner[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:#000000b3;color:#fff;border:1px solid rgba(255,255,255,.3);padding:.8rem 1.5rem;border-radius:25px;cursor:pointer;font-size:1rem;transition:all .2s}.loading-spinner[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#000000e6}.loading-spinner[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.video-overlay[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;padding:20px;background:linear-gradient(to top,rgba(0,0,0,.8),transparent);display:flex;justify-content:space-between;align-items:flex-end;pointer-events:none}.video-info[_ngcontent-%COMP%]{flex:1;color:#fff;padding-right:20px;pointer-events:auto;margin-bottom:50px}.dish-name[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin:0 0 5px;text-shadow:0 1px 2px rgba(0,0,0,.5)}.vendor-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;margin:0 0 10px;opacity:.9}.price-distance[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;font-size:.9rem;padding-bottom:20px}.price[_ngcontent-%COMP%]{font-weight:600;color:#ffffffe6;background:#ff6b35;padding:2px 8px;border-radius:4px}.distance[_ngcontent-%COMP%]{opacity:.8}.view-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;margin-top:8px;font-size:.85rem;opacity:.8}.view-count[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.9}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;pointer-events:auto;padding-bottom:60px}.action-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;display:flex;flex-direction:column;align-items:center;gap:5px;cursor:pointer;padding:0;transition:transform .2s}.action-btn[_ngcontent-%COMP%]:active{transform:scale(.9)}.action-icon[_ngcontent-%COMP%]{filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}.like-count[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600}.like-btn.liked[_ngcontent-%COMP%]{color:#ff4757}.like-btn.liked[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse .3s cubic-bezier(.175,.885,.32,1.275)}.bookmark-btn.bookmarked[_ngcontent-%COMP%]{color:#ff6b35}.like-animation[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:10;pointer-events:none;animation:_ngcontent-%COMP%_pop-in-out .8s cubic-bezier(.175,.885,.32,1.275) forwards}@keyframes _ngcontent-%COMP%_pop-in-out{0%{transform:translate(-50%,-50%) scale(0);opacity:0}20%{transform:translate(-50%,-50%) scale(1.2);opacity:1}40%{transform:translate(-50%,-50%) scale(.9);opacity:1}80%{transform:translate(-50%,-50%) scale(1);opacity:1}to{transform:translate(-50%,-50%) scale(1.5);opacity:0}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.2)}to{transform:scale(1)}}.mute-animation[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:10;pointer-events:none;animation:_ngcontent-%COMP%_fade-in-out 1s ease-in-out forwards}.mute-icon-bg[_ngcontent-%COMP%]{background:#0009;border-radius:50%;padding:15px;display:flex;align-items:center;justify-content:center}@keyframes _ngcontent-%COMP%_fade-in-out{0%{opacity:0;transform:translate(-50%,-50%) scale(.8)}20%{opacity:1;transform:translate(-50%,-50%) scale(1)}80%{opacity:1;transform:translate(-50%,-50%) scale(1)}to{opacity:0;transform:translate(-50%,-50%) scale(.8)}}.view-count-action[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2px;color:#fff;margin-bottom:5px}.view-count-action[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}.view-count-action[_ngcontent-%COMP%]   .count-text[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;text-shadow:0 1px 2px rgba(0,0,0,.5)}"]})};var ri=class n{constructor(e){this.firestore=e}collectionName="reels";getReels(e=10,t){return q(this,null,function*(){try{let i=ac(this.firestore,this.collectionName),o=lc(i,ld("createdAt","desc"),e_(e));return t&&(o=lc(o,H1(t))),(yield Jg(o)).docs.map(l=>J({id:l.id},l.data()))}catch(i){return console.error("Error fetching reels:",i),[]}})}getReelsByUser(e){return q(this,null,function*(){try{let t=ac(this.firestore,this.collectionName),i=lc(t,K1("uploadedBy","==",e),ld("createdAt","desc"));return(yield Jg(i)).docs.map(s=>J({id:s.id},s.data()))}catch(t){return console.error("Error fetching user reels:",t),[]}})}getReelById(e){return q(this,null,function*(){try{let t=Go(this.firestore,this.collectionName,e),i=yield $1(t);return i.exists()?J({id:i.id},i.data()):null}catch(t){return console.error("Error fetching reel:",t),null}})}createReel(e){return q(this,null,function*(){try{let t=ac(this.firestore,this.collectionName);return(yield U1(t,qe(J({},e),{createdAt:Dt.now(),viewCount:0,likes:0,likedBy:[],bookmarkedBy:[]}))).id}catch(t){throw console.error("Error creating reel:",t),t}})}updateReel(e,t){return q(this,null,function*(){try{let i=Go(this.firestore,this.collectionName,e);yield Ho(i,t)}catch(i){throw console.error("Error updating reel:",i),i}})}deleteReel(e){return q(this,null,function*(){try{let t=Go(this.firestore,this.collectionName,e);yield j1(t)}catch(t){throw console.error("Error deleting reel:",t),t}})}toggleLike(e,t,i){return q(this,null,function*(){try{let o=Go(this.firestore,this.collectionName,e);i?yield Ho(o,{likedBy:Yg(t),likes:ad(-1)}):yield Ho(o,{likedBy:Xg(t),likes:ad(1)})}catch(o){throw console.error("Error toggling like:",o),o}})}toggleBookmark(e,t,i){return q(this,null,function*(){try{let o=Go(this.firestore,this.collectionName,e);i?yield Ho(o,{bookmarkedBy:Yg(t)}):yield Ho(o,{bookmarkedBy:Xg(t)})}catch(o){throw console.error("Error toggling bookmark:",o),o}})}incrementViewCount(e){return q(this,null,function*(){try{let t=Go(this.firestore,this.collectionName,e);yield Ho(t,{viewCount:ad(1)})}catch(t){console.error("Error incrementing view count:",t)}})}getReelsRealtime(e=10){return new N_(t=>{let i=ac(this.firestore,this.collectionName),o=lc(i,ld("createdAt","desc"),e_(e)),s=G1(o,l=>{let h=l.docs.map(d=>J({id:d.id},d.data()));t.next(h)},l=>{console.error("Error in realtime reels:",l),t.error(l)});return()=>s()})}isLikedByUser(e,t){return e.likedBy?.includes(t)||!1}isBookmarkedByUser(e,t){return e.bookmarkedBy?.includes(t)||!1}static \u0275fac=function(t){return new(t||n)(xe(qo))};static \u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})};function RA(n,e){n&1&&(b(0,"div",7),X(1,"div",8),b(2,"p"),U(3,"Loading tasty bites..."),P()())}function kA(n,e){if(n&1){let t=Ye();b(0,"div",9)(1,"div",10)(2,"h2"),U(3,"No Reels Found"),P(),b(4,"p"),U(5,"Be the first to share a tasty bite!"),P(),b(6,"div",11)(7,"button",12),ie("click",function(){fe(t);let o=he();return pe(o.seedData())}),U(8,"Seed Sample Data"),P(),b(9,"a",13),U(10,"Upload Reel"),P()()()()}}function OA(n,e){if(n&1){let t=Ye();b(0,"app-video-card",14),ie("muteChanged",function(o){fe(t);let s=he();return pe(s.onMuteChanged(o))})("liked",function(){let o=fe(t).index,s=he();return pe(s.onLike(o))})("bookmarked",function(){let o=fe(t).index,s=he();return pe(s.onBookmark(o))})("shared",function(){let o=fe(t).index,s=he();return pe(s.onShare(o))}),P()}if(n&2){let t=e.$implicit,i=e.index,o=he();Z("reel",t)("active",i===o.currentIndex)("relativeIndex",i-o.currentIndex)("isMuted",o.isGlobalMuted)("priority",i===o.currentIndex||i===o.currentIndex+1?"high":"low")}}var Qo=class n{constructor(e,t,i,o){this.reelsService=e;this.auth=t;this.cdr=i;this.locationService=o}isActive=!0;isGlobalMuted=!0;reels=[];currentIndex=0;touchStartY=0;isLoading=!1;viewedReels=new Set;viewTrackingTimeout;cards;ngOnInit(){return q(this,null,function*(){yield this.loadReels()})}ngAfterViewInit(){setTimeout(()=>{this.reels.length>0&&(this.playCurrent(),this.trackView())},50)}ngOnChanges(e){e.isActive&&(this.isActive?this.reels.length>0&&this.playCurrent():this.pauseCurrent())}onMuteChanged(e){this.isGlobalMuted=e}ngOnDestroy(){this.viewTrackingTimeout&&clearTimeout(this.viewTrackingTimeout)}reloadReelsForNewLocation(){return q(this,null,function*(){console.log("[VideoFeed] Reloading reels for new location...");let e=[...this.reels],t=yield Promise.all(e.map(i=>q(this,null,function*(){let o="-- km";if(i.latitude&&i.longitude)try{o=yield this.locationService.getDistanceFromUser(i.latitude,i.longitude)}catch(s){console.error("[VideoFeed] Error calculating distance:",s)}return qe(J({},i),{distance:o})})));t.sort((i,o)=>{let s=i.distance==="-- km"?1/0:parseFloat(i.distance.split(" ")[0]),l=o.distance==="-- km"?1/0:parseFloat(o.distance.split(" ")[0]);return s-l}),this.reels=t,this.currentIndex=0,this.playCurrent()})}loadReels(){return q(this,null,function*(){console.log("[VideoFeed] Starting to load reels..."),this.isLoading=!0;try{let e=yield this.reelsService.getReels(20);console.log("[VideoFeed] Fetched reels:",e.length);let t=this.auth.currentUser;console.log("[VideoFeed] Current user:",t?.uid||"Not logged in");let i=yield Promise.all(e.map(o=>q(this,null,function*(){let s="-- km";if(o.latitude&&o.longitude)try{s=yield this.locationService.getDistanceFromUser(o.latitude,o.longitude)}catch(l){console.error("[VideoFeed] Error calculating distance:",l)}return qe(J({},o),{distance:s,isLiked:t?this.reelsService.isLikedByUser(o,t.uid):!1,isBookmarked:t?this.reelsService.isBookmarkedByUser(o,t.uid):!1})})));i.sort((o,s)=>{let l=o.distance==="-- km"?1/0:parseFloat(o.distance.split(" ")[0]),h=s.distance==="-- km"?1/0:parseFloat(s.distance.split(" ")[0]);return l-h}),this.reels=i,console.log("[VideoFeed] Final reels count:",this.reels.length)}catch(e){console.error("[VideoFeed] Error loading reels:",e)}finally{this.isLoading=!1,this.cdr.detectChanges(),console.log("[VideoFeed] Loading complete. isLoading:",this.isLoading),this.reels.length>0&&(this.playCurrent(),this.trackView())}})}trackView(){this.viewTrackingTimeout&&clearTimeout(this.viewTrackingTimeout);let e=this.reels[this.currentIndex];!e||!e.id||this.viewedReels.has(e.id)||(this.viewTrackingTimeout=window.setTimeout(()=>{e.id&&(this.reelsService.incrementViewCount(e.id),this.viewedReels.add(e.id),e.viewCount=(e.viewCount||0)+1)},3e3))}pullStartY=0;pullMoveY=0;isRefreshing=!1;pullThreshold=150;onTouchStart(e){this.touchStartY=e.touches[0].clientY,this.currentIndex===0&&!this.isRefreshing&&(this.pullStartY=e.touches[0].clientY)}onTouchMove(e){if(this.currentIndex===0&&!this.isRefreshing&&this.pullStartY>0){let i=e.touches[0].clientY-this.pullStartY;i>0&&(this.pullMoveY=i*.5,i>10&&e.preventDefault())}}onTouchEnd(e){return q(this,null,function*(){let t=this.touchStartY-e.changedTouches[0].clientY,i=80;t>i?this.next():t<-i&&this.pullMoveY<this.pullThreshold&&this.prev(),this.pullMoveY>=this.pullThreshold&&!this.isRefreshing&&(yield this.refresh()),this.pullStartY=0,this.pullMoveY=0})}refresh(){return q(this,null,function*(){this.isRefreshing=!0,navigator.vibrate&&navigator.vibrate(50);try{yield this.loadReels()}finally{setTimeout(()=>{this.isRefreshing=!1},500)}})}playCurrent(){this.cards.forEach((e,t)=>{t===this.currentIndex?e.play():e.pause()})}pauseCurrent(){this.cards.forEach(e=>e.pause())}next(){this.currentIndex<this.reels.length-1&&(this.isGlobalMuted=!0,this.currentIndex++,this.playCurrent(),this.trackView())}prev(){this.currentIndex>0&&(this.isGlobalMuted=!0,this.currentIndex--,this.playCurrent(),this.trackView())}onLike(e){return q(this,null,function*(){let t=this.reels[e];if(!t||!t.id)return;let i=this.auth.currentUser;if(!i){console.warn("User must be logged in to like");return}let o=t.isLiked||!1;t.isLiked=!o,t.likes=(t.likes||0)+(o?-1:1);try{yield this.reelsService.toggleLike(t.id,i.uid,o)}catch(s){t.isLiked=o,t.likes=(t.likes||0)+(o?1:-1),console.error("Error toggling like:",s)}})}onBookmark(e){return q(this,null,function*(){let t=this.reels[e];if(!t||!t.id)return;let i=this.auth.currentUser;if(!i){console.warn("User must be logged in to bookmark");return}let o=t.isBookmarked||!1;t.isBookmarked=!o;try{yield this.reelsService.toggleBookmark(t.id,i.uid,o)}catch(s){t.isBookmarked=o,console.error("Error toggling bookmark:",s)}})}onShare(e){let t=this.reels[e];if(t)if(navigator.share)navigator.share({title:t.title,text:`Check out ${t.title} from ${t.vendor}!`,url:window.location.href}).catch(i=>console.log("Error sharing:",i));else{let i=`Check out ${t.title} from ${t.vendor}! \u20B9${t.price}`;navigator.clipboard.writeText(i).then(()=>alert("Link copied to clipboard!")).catch(o=>console.error("Error copying:",o))}}seedData(){return q(this,null,function*(){this.isLoading=!0;let e=[{title:"Masala Dosa",vendor:"CTR",videoUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",thumbnailUrl:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Masala_Dosa_with_Chutney_and_Sambar.jpg/1200px-Masala_Dosa_with_Chutney_and_Sambar.jpg",price:120,latitude:12.9352,longitude:77.6245,uploadedBy:this.auth.currentUser?.uid||"system",cloudflareVideoId:"sample-id-1",duration:60,createdAt:Dt.now(),viewCount:0,likes:0,likedBy:[],bookmarkedBy:[]},{title:"Idli Vada",vendor:"Brahmins Coffee Bar",videoUrl:"https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4",thumbnailUrl:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Idli_Sambar.JPG/1200px-Idli_Sambar.JPG",price:80,latitude:12.9716,longitude:77.6412,uploadedBy:this.auth.currentUser?.uid||"system",cloudflareVideoId:"sample-id-2",duration:60,createdAt:Dt.now(),viewCount:0,likes:0,likedBy:[],bookmarkedBy:[]}];try{for(let t of e)yield this.reelsService.createReel(t);yield this.loadReels()}catch(t){console.error("Error seeding data:",t)}finally{this.isLoading=!1}})}navigateToReel(e){if(console.log(`[VideoFeed] Attempting to navigate to reel: ${e}`),console.log(`[VideoFeed] Total reels loaded: ${this.reels.length}`),this.reels.length===0){console.warn(`[VideoFeed] No reels loaded yet, cannot navigate to ${e}`);return}let t=this.reels.findIndex(i=>i.id===e);t!==-1?(console.log(`[VideoFeed] Found reel at index ${t}, navigating...`),this.currentIndex=t,this.isGlobalMuted=!0,setTimeout(()=>{this.playCurrent(),this.trackView()},100),console.log(`[VideoFeed] Successfully navigated to reel: ${e}`)):(console.warn(`[VideoFeed] Reel not found in loaded reels: ${e}`),console.log("[VideoFeed] Available reel IDs:",this.reels.map(i=>i.id)))}static \u0275fac=function(t){return new(t||n)(ne(ri),ne(Tt),ne(Rn),ne(ii))};static \u0275cmp=nt({type:n,selectors:[["app-video-feed"]],viewQuery:function(t,i){if(t&1&&Zn(gc,5),t&2){let o;xn(o=Mn())&&(i.cards=o)}},inputs:{isActive:"isActive"},standalone:!0,features:[ui,it],decls:7,vars:9,consts:[[1,"video-feed",3,"touchstart","touchmove","touchend"],[1,"refresh-indicator"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M12 4V2M12 20v2M4 12H2m20 0h-2m-2.05-5.95l-1.414-1.414M4.929 19.071L6.343 17.657m12.728 0l-1.414 1.414M4.929 4.929L6.343 6.343","stroke","currentColor","stroke-width","2.5","stroke-linecap","round"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"reel","active","relativeIndex","isMuted","priority","muteChanged","liked","bookmarked","shared",4,"ngFor","ngForOf"],[1,"loading-state"],[1,"spinner"],[1,"empty-state"],[1,"empty-content"],[1,"button-group"],[1,"seed-btn",3,"click"],["routerLink","/upload-reel",1,"upload-btn"],[3,"muteChanged","liked","bookmarked","shared","reel","active","relativeIndex","isMuted","priority"]],template:function(t,i){t&1&&(b(0,"div",0),ie("touchstart",function(s){return i.onTouchStart(s)})("touchmove",function(s){return i.onTouchMove(s)})("touchend",function(s){return i.onTouchEnd(s)}),b(1,"div",1),ye(),b(2,"svg",2),X(3,"path",3),P()(),Pe(4,RA,4,0,"div",4)(5,kA,11,0,"div",5)(6,OA,1,5,"app-video-card",6),P()),t&2&&(N(),Rr("transform","translateY("+(i.isRefreshing?60:i.pullMoveY)+"px)"),Ge("refreshing",i.isRefreshing),N(),Rr("transform","rotate("+i.pullMoveY*2+"deg)"),N(2),Z("ngIf",i.isLoading&&!i.isRefreshing),N(),Z("ngIf",!i.isLoading&&i.reels.length===0),N(),Z("ngForOf",i.reels))},dependencies:[ct,en,Pt,gc,sy,Jv],styles:[".video-feed[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden;scroll-snap-type:y mandatory;-webkit-overflow-scrolling:touch;height:100vh;background:#000}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;z-index:10;background:#121212}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(255,255,255,.1);border-left-color:#ff6b35;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-content[_ngcontent-%COMP%]{text-align:center;padding:2rem}.empty-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.5rem;color:#ff6b35}.empty-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#aaa;margin-bottom:2rem}.button-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;width:100%;max-width:250px}.seed-btn[_ngcontent-%COMP%], .upload-btn[_ngcontent-%COMP%]{padding:.8rem 1.5rem;border-radius:25px;font-weight:600;text-align:center;text-decoration:none;cursor:pointer;transition:all .2s;border:none;font-size:1rem}.seed-btn[_ngcontent-%COMP%]{background:#ffffff1a;color:#fff;border:1px solid rgba(255,255,255,.2)}.seed-btn[_ngcontent-%COMP%]:hover{background:#fff3}.upload-btn[_ngcontent-%COMP%]{background:#ff6b35;color:#fff}.upload-btn[_ngcontent-%COMP%]:hover{background:#e55a2b;transform:translateY(-2px)}.refresh-indicator[_ngcontent-%COMP%]{position:absolute;top:-50px;left:0;width:100%;height:50px;display:flex;align-items:center;justify-content:center;z-index:20;pointer-events:none;transition:transform .1s linear}.refresh-indicator.refreshing[_ngcontent-%COMP%]{transition:transform .3s cubic-bezier(.175,.885,.32,1.275)}.refresh-indicator.refreshing[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.refresh-indicator[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ff6b35;background:#fff;border-radius:50%;padding:5px;box-shadow:0 2px 5px #0003}"]})};var ha=class n{selectedReelId=new _n(null);selectedReelId$=this.selectedReelId.asObservable();selectReel(e){console.log("[NavigationService] Setting selected reel:",e),this.selectedReelId.next(e)}clearSelection(){this.selectedReelId.next(null)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=be({token:n,factory:n.\u0275fac,providedIn:"root"})};function LA(n,e){n&1&&(b(0,"div",6)(1,"h1"),U(2,"Favorites"),P(),b(3,"p",7),U(4,"Your bookmarked reels"),P()())}function FA(n,e){n&1&&(b(0,"div",8),X(1,"div",9),b(2,"p"),U(3,"Loading favorites..."),P()())}function VA(n,e){n&1&&(b(0,"div",10),ye(),b(1,"svg",11),X(2,"path",12),P(),Ve(),b(3,"h2"),U(4,"No Favorites Yet"),P(),b(5,"p"),U(6,"Bookmark your favorite reels to see them here"),P()())}function NA(n,e){if(n&1){let t=Ye();b(0,"video",33,0),ie("loadedmetadata",function(){fe(t);let o=Ts(1);return pe(o.currentTime=.1)}),P()}if(n&2){let t=he().$implicit;Z("src",t.videoUrl,Wn)}}function BA(n,e){if(n&1){let t=Ye();b(0,"div",15),ie("click",function(){let o=fe(t).$implicit,s=he(2);return pe(s.playReel(o))}),b(1,"div",16),Pe(2,NA,2,1,"video",17),b(3,"div",18),ye(),b(4,"svg",19),X(5,"path",20),P()(),Ve(),b(6,"div",21)(7,"span",22),ye(),b(8,"svg",23),X(9,"path",24)(10,"circle",25),P(),U(11),P(),Ve(),b(12,"span",22),ye(),b(13,"svg",23),X(14,"path",26),P(),U(15),P()()(),Ve(),b(16,"div",27)(17,"h3",28),U(18),P(),b(19,"p",29),U(20),P(),b(21,"div",30)(22,"span",31),U(23),P(),b(24,"span",32),U(25),P()()()()}if(n&2){let t=e.$implicit;N(2),Z("ngIf",t.videoUrl),N(9),He(" ",t.viewCount||0," "),N(4),He(" ",t.likes||0," "),N(3),Xe(t.title),N(2),Xe(t.vendor),N(3),He("\u20B9",t.price,""),N(2),Xe(t.distance)}}function zA(n,e){if(n&1&&(b(0,"div",13),Pe(1,BA,26,7,"div",14),P()),n&2){let t=he();N(),Z("ngForOf",t.bookmarkedReels)}}var Zr=class n{constructor(e,t,i,o,s){this.reelsService=e;this.auth=t;this.router=i;this.cdr=o;this.navigationService=s}showHeader=!0;bookmarkedReels=[];isLoading=!0;ngOnInit(){return q(this,null,function*(){yield this.loadBookmarkedReels()})}loadBookmarkedReels(){return q(this,null,function*(){console.log("[Favorites] Starting to load bookmarked reels..."),this.isLoading=!0,this.cdr.detectChanges();try{let e=this.auth.currentUser;if(console.log("[Favorites] Current user:",e?.uid||"Not logged in"),!e){this.bookmarkedReels=[],console.log("[Favorites] No user logged in, clearing bookmarks");return}console.log("[Favorites] Fetching all reels...");let t=yield this.reelsService.getReels(100);console.log("[Favorites] Fetched reels count:",t.length),this.bookmarkedReels=t.filter(i=>this.reelsService.isBookmarkedByUser(i,e.uid)),console.log("[Favorites] Bookmarked reels count:",this.bookmarkedReels.length)}catch(e){console.error("[Favorites] Error loading bookmarked reels:",e)}finally{this.isLoading=!1,this.cdr.detectChanges(),console.log("[Favorites] Loading complete. isLoading:",this.isLoading)}})}playReel(e){console.log("[Favorites] Playing reel:",e.id,e.title),this.navigationService.selectReel(e.id),this.router.navigate(["/main-app"])}static \u0275fac=function(t){return new(t||n)(ne(ri),ne(Tt),ne(Ke),ne(Rn),ne(ha))};static \u0275cmp=nt({type:n,selectors:[["app-favorites"]],inputs:{showHeader:"showHeader"},standalone:!0,features:[it],decls:5,vars:4,consts:[["videoThumb",""],[1,"favorites-container"],["class","favorites-header",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","reels-grid",4,"ngIf"],[1,"favorites-header"],[1,"subtitle"],[1,"loading-state"],[1,"spinner"],[1,"empty-state"],["width","80","height","80","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z","stroke","currentColor","stroke-width","2","fill","none"],[1,"reels-grid"],["class","reel-card",3,"click",4,"ngFor","ngForOf"],[1,"reel-card",3,"click"],[1,"reel-thumbnail"],["muted","","playsinline","","preload","metadata",3,"src","loadedmetadata",4,"ngIf"],[1,"play-overlay"],["width","48","height","48","viewBox","0 0 24 24","fill","white"],["d","M8 5v14l11-7z"],[1,"reel-stats"],[1,"stat"],["width","16","height","16","viewBox","0 0 24 24","fill","white"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z","stroke","white","stroke-width","2","fill","none"],["cx","12","cy","12","r","3","stroke","white","stroke-width","2","fill","none"],["d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"],[1,"reel-info"],[1,"reel-title"],[1,"reel-vendor"],[1,"reel-meta"],[1,"price"],[1,"distance"],["muted","","playsinline","","preload","metadata",3,"loadedmetadata","src"]],template:function(t,i){t&1&&(b(0,"div",1),Pe(1,LA,5,0,"div",2)(2,FA,4,0,"div",3)(3,VA,7,0,"div",4)(4,zA,2,1,"div",5),P()),t&2&&(N(),Z("ngIf",i.showHeader),N(),Z("ngIf",i.isLoading),N(),Z("ngIf",!i.isLoading&&i.bookmarkedReels.length===0),N(),Z("ngIf",!i.isLoading&&i.bookmarkedReels.length>0))},dependencies:[ct,en,Pt],styles:['@charset "UTF-8";.favorites-container[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000;overflow-y:auto;padding:4rem 1rem 5rem}.favorites-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem;padding:1rem 0}.favorites-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#fff;margin-bottom:.5rem;background:linear-gradient(135deg,#ff6b35,#f7931e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.favorites-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#888;font-size:.9rem}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:60vh;color:#fff;text-align:center;padding:2rem}.loading-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ff6b35;margin-bottom:1.5rem;opacity:.5}.loading-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.5rem;color:#fff}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#888;font-size:.95rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(255,255,255,.1);border-left-color:#ff6b35;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.reels-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:1rem;padding:0 .5rem}@media (min-width: 640px){.reels-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1.5rem}}.reel-card[_ngcontent-%COMP%]{cursor:pointer;transition:transform .2s;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.reel-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.reel-card[_ngcontent-%COMP%]:active{transform:scale(.98)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.reel-thumbnail[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:9/16;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,#1a1a1a,#2d2d2d);margin-bottom:.5rem;display:flex;align-items:center;justify-content:center}.reel-thumbnail[_ngcontent-%COMP%]:before{content:"\\1f3ac";font-size:3rem;opacity:.3;position:absolute}.reel-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .reel-thumbnail[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;position:relative;z-index:1}.reel-thumbnail[_ngcontent-%COMP%]   .play-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:#0000004d;opacity:0;transition:opacity .2s;z-index:2}.reel-thumbnail[_ngcontent-%COMP%]   .play-overlay[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 2px 8px rgba(0,0,0,.5))}.reel-thumbnail[_ngcontent-%COMP%]:hover   .play-overlay[_ngcontent-%COMP%]{opacity:1}.reel-thumbnail[_ngcontent-%COMP%]   .reel-stats[_ngcontent-%COMP%]{position:absolute;bottom:.5rem;left:.5rem;right:.5rem;display:flex;gap:.75rem;font-size:.75rem;color:#fff;z-index:2}.reel-thumbnail[_ngcontent-%COMP%]   .reel-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;background:#0009;backdrop-filter:blur(1px);padding:.25rem .5rem;border-radius:12px;font-weight:600}.reel-thumbnail[_ngcontent-%COMP%]   .reel-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.reel-info[_ngcontent-%COMP%]   .reel-title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:#fff;margin-bottom:.25rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.reel-info[_ngcontent-%COMP%]   .reel-vendor[_ngcontent-%COMP%]{font-size:.8rem;color:#888;margin-bottom:.5rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.reel-info[_ngcontent-%COMP%]   .reel-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.75rem}.reel-info[_ngcontent-%COMP%]   .reel-meta[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff6b35,#f7931e);color:#fff;padding:.25rem .5rem;border-radius:8px;font-weight:600}.reel-info[_ngcontent-%COMP%]   .reel-meta[_ngcontent-%COMP%]   .distance[_ngcontent-%COMP%]{color:#666}']})};var Qr=HC(gC());function UA(n,e){n&1&&(b(0,"span"),U(1,"Search"),P())}function jA(n,e){n&1&&(b(0,"span"),U(1,"..."),P())}function $A(n,e){if(n&1){let t=Ye();b(0,"div",20),ie("click",function(){let o=fe(t).$implicit,s=he(2);return pe(s.selectSearchResult(o))}),U(1),P()}if(n&2){let t=e.$implicit;N(),He(" ",t.display_name," ")}}function qA(n,e){if(n&1&&(b(0,"div",18),Pe(1,$A,2,1,"div",19),P()),n&2){let t=he();N(),Z("ngForOf",t.searchResults)}}var wd=class n{locationSelected=new yt;cancel=new yt;map;marker;searchQuery="";searchResults=[];isSearching=!1;selectedLat=12.9716;selectedLng=77.5946;constructor(){}ngOnInit(){}ngAfterViewInit(){this.initMap()}ngOnDestroy(){this.map&&this.map.remove()}initMap(){this.map=Qr.map("map").setView([this.selectedLat,this.selectedLng],13),Qr.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map),this.addMarker(this.selectedLat,this.selectedLng),this.map.on("click",e=>{this.updateLocation(e.latlng.lat,e.latlng.lng)}),setTimeout(()=>{this.map?.invalidateSize()},100)}addMarker(e,t){if(this.marker)this.marker.setLatLng([e,t]);else{let i=Qr.divIcon({className:"custom-pin",html:`<svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="#ff4757" stroke="white" stroke-width="2"/>
               </svg>`,iconSize:[30,30],iconAnchor:[15,30]});this.marker=Qr.marker([e,t],{icon:i,draggable:!0}).addTo(this.map),this.marker.on("dragend",()=>{let o=this.marker.getLatLng();this.updateLocation(o.lat,o.lng,!1)})}}updateLocation(e,t,i=!1){this.selectedLat=e,this.selectedLng=t,this.marker?this.marker.setLatLng([e,t]):this.addMarker(e,t),i&&this.map&&this.map.panTo([e,t])}searchLocation(){return q(this,null,function*(){if(this.searchQuery.trim()){this.isSearching=!0,this.searchResults=[];try{let t=yield(yield fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(this.searchQuery)}`)).json();this.searchResults=t}catch(e){console.error("Error searching location:",e)}finally{this.isSearching=!1}}})}selectSearchResult(e){let t=parseFloat(e.lat),i=parseFloat(e.lon);this.updateLocation(t,i,!0),this.searchResults=[],this.searchQuery=e.display_name.split(",")[0]}confirmSelection(){this.locationSelected.emit({lat:this.selectedLat,lng:this.selectedLng})}onCancel(){this.cancel.emit()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=nt({type:n,selectors:[["app-location-picker"]],outputs:{locationSelected:"locationSelected",cancel:"cancel"},standalone:!0,features:[it],decls:27,vars:13,consts:[[1,"picker-overlay"],[1,"picker-container"],[1,"picker-header"],[1,"close-btn",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M18 6L6 18M6 6l12 12","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"search-bar"],["type","text","placeholder","Search for a place...",3,"ngModelChange","keyup.enter","ngModel"],[1,"search-btn",3,"click","disabled"],[4,"ngIf"],["class","search-results",4,"ngIf"],[1,"map-container"],["id","map"],[1,"picker-footer"],[1,"coords"],[1,"actions"],[1,"cancel-btn",3,"click"],[1,"confirm-btn",3,"click"],[1,"search-results"],["class","result-item",3,"click",4,"ngFor","ngForOf"],[1,"result-item",3,"click"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),U(4,"Pick Location"),P(),b(5,"button",3),ie("click",function(){return i.onCancel()}),ye(),b(6,"svg",4),X(7,"path",5),P()()(),Ve(),b(8,"div",6)(9,"input",7),qt("ngModelChange",function(s){return $t(i.searchQuery,s)||(i.searchQuery=s),s}),ie("keyup.enter",function(){return i.searchLocation()}),P(),b(10,"button",8),ie("click",function(){return i.searchLocation()}),Pe(11,UA,2,0,"span",9)(12,jA,2,0,"span",9),P()(),Pe(13,qA,2,1,"div",10),b(14,"div",11),X(15,"div",12),P(),b(16,"div",13)(17,"div",14)(18,"small"),U(19),Qa(20,"number"),Qa(21,"number"),P()(),b(22,"div",15)(23,"button",16),ie("click",function(){return i.onCancel()}),U(24,"Cancel"),P(),b(25,"button",17),ie("click",function(){return i.confirmSelection()}),U(26,"Confirm Location"),P()()()()()),t&2&&(N(9),jt("ngModel",i.searchQuery),N(),Z("disabled",i.isSearching),N(),Z("ngIf",!i.isSearching),N(),Z("ngIf",i.isSearching),N(),Z("ngIf",i.searchResults.length>0),N(6),o0("",Ya(20,7,i.selectedLat,"1.4-4"),", ",Ya(21,10,i.selectedLng,"1.4-4"),""))},dependencies:[ct,en,Pt,nv,yn,on,vn,fn],styles:[".picker-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;z-index:2000;display:flex;align-items:center;justify-content:center;padding:20px}.picker-container[_ngcontent-%COMP%]{background:#1a1a1a;width:100%;max-width:500px;height:80vh;border-radius:12px;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 4px 20px #00000080}.picker-header[_ngcontent-%COMP%]{padding:15px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,.1)}.picker-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:1.1rem}.picker-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#fff;padding:5px;cursor:pointer}.search-bar[_ngcontent-%COMP%]{padding:15px;display:flex;gap:10px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;background:#333;border:1px solid #444;border-radius:8px;padding:10px 15px;color:#fff;font-size:.95rem}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#ff4757}.search-bar[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]{background:#ff4757;color:#fff;border:none;border-radius:8px;padding:0 20px;font-weight:600;cursor:pointer}.search-bar[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]:disabled{opacity:.7}.search-results[_ngcontent-%COMP%]{background:#2a2a2a;max-height:150px;overflow-y:auto;border-bottom:1px solid #444}.search-results[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]{padding:12px 15px;color:#ddd;border-bottom:1px solid #333;cursor:pointer;font-size:.9rem}.search-results[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]:hover{background:#333}.map-container[_ngcontent-%COMP%]{flex:1;position:relative;background:#eee}.map-container[_ngcontent-%COMP%]   #map[_ngcontent-%COMP%]{width:100%;height:100%}.picker-footer[_ngcontent-%COMP%]{padding:15px 20px;background:#1a1a1a;display:flex;justify-content:space-between;align-items:center;border-top:1px solid rgba(255,255,255,.1)}.picker-footer[_ngcontent-%COMP%]   .coords[_ngcontent-%COMP%]{color:#888;font-family:monospace}.picker-footer[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:10px}.picker-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-weight:600;cursor:pointer;border:none}.picker-footer[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background:#333;color:#fff}.picker-footer[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background:#ff4757;color:#fff}"]})};function GA(n,e){if(n&1){let t=Ye();b(0,"div",29),X(1,"video",30),b(2,"button",31),ie("click",function(){fe(t);let o=he();return pe(o.removeFile())}),ye(),b(3,"svg",32),X(4,"path",33),P()()()}if(n&2){let t=he();N(),Z("src",t.videoPreviewUrl,Wn)}}function HA(n,e){if(n&1){let t=Ye();b(0,"label",34)(1,"input",35),ie("change",function(o){fe(t);let s=he();return pe(s.onFileSelected(o))}),P(),b(2,"div",36),ye(),b(3,"svg",37),X(4,"path",38)(5,"circle",39),P(),Ve(),b(6,"p",40),U(7,"Select Video"),P(),b(8,"p",41),U(9,"MP4, MOV, or WebM (max 100MB)"),P()()()}}function KA(n,e){if(n&1&&(b(0,"div",42),ye(),b(1,"svg",32),X(2,"circle",43)(3,"path",44),P(),U(4),P()),n&2){let t=he();N(4),He(" ",t.uploadError," ")}}function WA(n,e){n&1&&(b(0,"div",45),ye(),b(1,"svg",32),X(2,"path",46)(3,"path",47),P(),U(4," Upload successful! Redirecting... "),P())}function ZA(n,e){if(n&1&&(b(0,"div",48)(1,"div",49),X(2,"div",50),P(),b(3,"p",51),U(4),P()()),n&2){let t=he();N(2),Rr("width",t.uploadProgress,"%"),N(2),He("Uploading... ",t.uploadProgress,"%")}}function QA(n,e){n&1&&(b(0,"span"),U(1,"Upload Reel"),P())}function YA(n,e){n&1&&(b(0,"span"),U(1,"Uploading..."),P())}function XA(n,e){if(n&1){let t=Ye();b(0,"app-location-picker",52),ie("locationSelected",function(o){fe(t);let s=he();return pe(s.onLocationSelected(o))})("cancel",function(){fe(t);let o=he();return pe(o.closeLocationPicker())}),P()}}var da=class n{constructor(e,t,i,o){this.reelsService=e;this.auth=t;this.router=i;this.locationService=o}title="";vendor="";price=null;latitude=null;longitude=null;selectedFile=null;videoPreviewUrl=null;isUploading=!1;uploadProgress=0;uploadError=null;uploadSuccess=!1;maxFileSize=200*1024*1024;acceptedFormats=["video/mp4","video/quicktime","video/webm"];ngOnInit(){}onFileSelected(e){let t=e.target;if(t.files&&t.files.length>0){let i=t.files[0];this.validateAndSetFile(i)}}validateAndSetFile(e){if(this.uploadError=null,!this.acceptedFormats.includes(e.type)){this.uploadError="Please select a valid video file (MP4, MOV, or WebM)";return}if(e.size>this.maxFileSize){this.uploadError=`File size must be less than ${this.maxFileSize/(1024*1024)}MB`;return}this.selectedFile=e,this.createVideoPreview(e)}createVideoPreview(e){this.videoPreviewUrl&&URL.revokeObjectURL(this.videoPreviewUrl),this.videoPreviewUrl=URL.createObjectURL(e)}removeFile(){this.videoPreviewUrl&&URL.revokeObjectURL(this.videoPreviewUrl),this.selectedFile=null,this.videoPreviewUrl=null,this.uploadError=null}isFormValid(){return!!(this.selectedFile&&this.title.trim()&&this.vendor.trim()&&this.price!==null&&this.price>0&&this.latitude!==null&&this.longitude!==null)}showLocationPicker=!1;getCurrentLocation(){return q(this,null,function*(){try{let e=yield this.locationService.getUserLocation();this.latitude=e.latitude,this.longitude=e.longitude}catch(e){console.error("Error getting location:",e),this.uploadError="Failed to get current location. Please enter coordinates manually."}})}openLocationPicker(){this.showLocationPicker=!0}onLocationSelected(e){this.latitude=e.lat,this.longitude=e.lng,this.showLocationPicker=!1}closeLocationPicker(){this.showLocationPicker=!1}uploadReel(){return q(this,null,function*(){if(!this.isFormValid()||!this.selectedFile){this.uploadError="Please fill in all fields and select a video";return}let e=this.auth.currentUser;if(!e){this.uploadError="You must be logged in to upload a reel";return}this.isUploading=!0,this.uploadError=null,this.uploadProgress=0;try{let{getStorage:t,ref:i,uploadBytesResumable:o,getDownloadURL:s}=yield import("./chunk-6QXLYDAR.js"),l=t(),h=Date.now(),d=`videos/${e.uid}/${h}_${this.selectedFile.name}`,m=i(l,d),v=o(m,this.selectedFile);v.on("state_changed",w=>{this.uploadProgress=Math.round(w.bytesTransferred/w.totalBytes*100)},w=>{console.error("Upload error:",w),this.uploadError="Failed to upload video. Please try again.",this.isUploading=!1},()=>q(this,null,function*(){try{let w=yield s(v.snapshot.ref);yield this.reelsService.createReel({cloudflareVideoId:"",videoUrl:w,thumbnailUrl:"",duration:0,title:this.title.trim(),vendor:this.vendor.trim(),price:this.price,latitude:this.latitude,longitude:this.longitude,uploadedBy:e.uid,createdAt:null,viewCount:0,likes:0,likedBy:[],bookmarkedBy:[]}),this.uploadSuccess=!0,setTimeout(()=>{this.router.navigate(["/main-app"])},1500)}catch(w){console.error("Error creating reel:",w),this.uploadError="Failed to save reel data. Please try again.",this.isUploading=!1}}))}catch(t){console.error("Upload error:",t),this.uploadError=t instanceof Error?t.message:"Failed to upload video. Please try again.",this.isUploading=!1}})}cancel(){this.router.navigate(["/main-app"])}ngOnDestroy(){this.videoPreviewUrl&&URL.revokeObjectURL(this.videoPreviewUrl)}static \u0275fac=function(t){return new(t||n)(ne(ri),ne(Tt),ne(Ke),ne(ii))};static \u0275cmp=nt({type:n,selectors:[["app-upload-reel"]],standalone:!0,features:[it],decls:47,vars:21,consts:[["fileSelector",""],[1,"upload-container"],[1,"upload-header"],[1,"spacer"],[1,"upload-content"],[1,"video-preview-section"],["class","video-preview",4,"ngIf","ngIfElse"],[1,"form-section"],[1,"form-group"],["for","title"],["type","text","id","title","placeholder","e.g., Masala Dosa",3,"ngModelChange","ngModel","disabled"],["for","vendor"],["type","text","id","vendor","placeholder","e.g., Vidyarthi Bhavan",3,"ngModelChange","ngModel","disabled"],["for","price"],["type","number","id","price","placeholder","50","min","0",3,"ngModelChange","ngModel","disabled"],["type","button",1,"location-btn",3,"click","disabled"],["type","button",1,"location-btn","map-btn",2,"margin-top","10px",3,"click","disabled"],[1,"form-row"],["for","latitude"],["type","number","id","latitude","placeholder","12.9352","step","0.0001",3,"ngModelChange","ngModel","disabled"],["for","longitude"],["type","number","id","longitude","placeholder","77.6245","step","0.0001",3,"ngModelChange","ngModel","disabled"],["class","error-message",4,"ngIf"],["class","success-message",4,"ngIf"],["class","upload-progress",4,"ngIf"],[1,"action-buttons"],[1,"upload-btn",3,"click","disabled"],[4,"ngIf"],[3,"locationSelected","cancel",4,"ngIf"],[1,"video-preview"],["controls","","playsinline","",1,"preview-video",3,"src"],[1,"remove-video-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none"],["d","M18 6L6 18M6 6l12 12","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"file-selector"],["type","file","accept","video/mp4,video/quicktime,video/webm","hidden","",3,"change"],[1,"file-selector-content"],["width","48","height","48","viewBox","0 0 24 24","fill","none"],["d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z","stroke","currentColor","stroke-width","2"],["cx","12","cy","13","r","4","stroke","currentColor","stroke-width","2"],[1,"selector-title"],[1,"selector-subtitle"],[1,"error-message"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","2"],["d","M12 8v4M12 16h.01","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"success-message"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["d","M22 4L12 14.01l-3-3","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"upload-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[3,"locationSelected","cancel"]],template:function(t,i){if(t&1){let o=Ye();b(0,"div",1)(1,"div",2)(2,"h1"),U(3,"Upload Reel"),P(),X(4,"div",3),P(),b(5,"div",4)(6,"div",5),Pe(7,GA,5,1,"div",6)(8,HA,10,0,"ng-template",null,0,a0),P(),b(10,"div",7)(11,"div",8)(12,"label",9),U(13,"Dish Name *"),P(),b(14,"input",10),qt("ngModelChange",function(l){return fe(o),$t(i.title,l)||(i.title=l),pe(l)}),P()(),b(15,"div",8)(16,"label",11),U(17,"Vendor Name *"),P(),b(18,"input",12),qt("ngModelChange",function(l){return fe(o),$t(i.vendor,l)||(i.vendor=l),pe(l)}),P()(),b(19,"div",8)(20,"label",13),U(21,"Price (\u20B9) *"),P(),b(22,"input",14),qt("ngModelChange",function(l){return fe(o),$t(i.price,l)||(i.price=l),pe(l)}),P()(),b(23,"div",8)(24,"label"),U(25,"Location *"),P(),b(26,"button",15),ie("click",function(){return fe(o),pe(i.getCurrentLocation())}),U(27," \u{1F4CD} Use Current Location "),P(),b(28,"button",16),ie("click",function(){return fe(o),pe(i.openLocationPicker())}),U(29," \u{1F5FA}\uFE0F Pick on Map "),P()(),b(30,"div",17)(31,"div",8)(32,"label",18),U(33,"Latitude *"),P(),b(34,"input",19),qt("ngModelChange",function(l){return fe(o),$t(i.latitude,l)||(i.latitude=l),pe(l)}),P()(),b(35,"div",8)(36,"label",20),U(37,"Longitude *"),P(),b(38,"input",21),qt("ngModelChange",function(l){return fe(o),$t(i.longitude,l)||(i.longitude=l),pe(l)}),P()()(),Pe(39,KA,5,1,"div",22)(40,WA,5,0,"div",23)(41,ZA,5,3,"div",24),b(42,"div",25)(43,"button",26),ie("click",function(){return fe(o),pe(i.uploadReel())}),Pe(44,QA,2,0,"span",27)(45,YA,2,0,"span",27),P()()()(),Pe(46,XA,1,0,"app-location-picker",28),P()}if(t&2){let o=Ts(9);N(7),Z("ngIf",i.videoPreviewUrl)("ngIfElse",o),N(7),jt("ngModel",i.title),Z("disabled",i.isUploading),N(4),jt("ngModel",i.vendor),Z("disabled",i.isUploading),N(4),jt("ngModel",i.price),Z("disabled",i.isUploading),N(4),Z("disabled",i.isUploading),N(2),Z("disabled",i.isUploading),N(6),jt("ngModel",i.latitude),Z("disabled",i.isUploading),N(4),jt("ngModel",i.longitude),Z("disabled",i.isUploading),N(),Z("ngIf",i.uploadError),N(),Z("ngIf",i.uploadSuccess),N(),Z("ngIf",i.isUploading),N(2),Z("disabled",!i.isFormValid()||i.isUploading),N(),Z("ngIf",!i.isUploading),N(),Z("ngIf",i.isUploading),N(),Z("ngIf",i.showLocationPicker)}},dependencies:[ct,Pt,yn,on,c_,vn,h_,fn,wd],styles:[".upload-container[_ngcontent-%COMP%]{height:100vh;background:#0a0a0a;padding:0 0 100px;overflow-y:auto;position:relative}.upload-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:20px;background:#00000080;backdrop-filter:blur(1px);border-bottom:1px solid rgba(255,255,255,.1);position:sticky;top:0;z-index:10}.upload-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:0;color:#fff}.upload-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:transparent;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#fff;cursor:pointer;transition:all .2s ease;border-radius:50%}.upload-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a}.upload-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.upload-header[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:40px}.upload-content[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px}.video-preview-section[_ngcontent-%COMP%]{margin-bottom:24px}.video-preview[_ngcontent-%COMP%]{position:relative;background:#1a1a1a;border-radius:16px;overflow:hidden;aspect-ratio:9/16;max-height:500px;border:1px solid rgba(255,255,255,.1)}.video-preview[_ngcontent-%COMP%]   .preview-video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.video-preview[_ngcontent-%COMP%]   .remove-video-btn[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;background:#000c;backdrop-filter:blur(1px);border:1px solid rgba(255,255,255,.2);border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;color:#fff;cursor:pointer;transition:all .2s ease}.video-preview[_ngcontent-%COMP%]   .remove-video-btn[_ngcontent-%COMP%]:hover{background:#ff3b30e6;border-color:#ff3b30}.video-preview[_ngcontent-%COMP%]   .remove-video-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.file-selector[_ngcontent-%COMP%]{display:block;cursor:pointer}.file-selector[_ngcontent-%COMP%]   .file-selector-content[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:16px;padding:60px 40px;text-align:center;border:2px dashed rgba(255,107,53,.3);transition:all .3s ease}.file-selector[_ngcontent-%COMP%]   .file-selector-content[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ff6b35;margin-bottom:20px}.file-selector[_ngcontent-%COMP%]   .file-selector-content[_ngcontent-%COMP%]   .selector-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#fff;margin:0 0 8px}.file-selector[_ngcontent-%COMP%]   .file-selector-content[_ngcontent-%COMP%]   .selector-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#888;margin:0}.file-selector[_ngcontent-%COMP%]   .file-selector-content[_ngcontent-%COMP%]:hover{border-color:#ff6b35;background:#222;transform:translateY(-2px);box-shadow:0 8px 24px #ff6b3533}.form-section[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:16px;padding:24px;border:1px solid rgba(255,255,255,.1)}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:13px;font-weight:600;color:#aaa;margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:14px 16px;background:#0a0a0a;border:1px solid rgba(255,255,255,.1);border-radius:12px;font-size:16px;color:#fff;transition:all .2s ease;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#ff6b35;background:#111;box-shadow:0 0 0 3px #ff6b351a}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background:#0a0a0a;opacity:.5;cursor:not-allowed}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#555}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:-1fr 1fr;gap:16px}.error-message[_ngcontent-%COMP%], .success-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:12px;font-size:14px;margin-bottom:20px;font-weight:500}.error-message[_ngcontent-%COMP%]{background:#ff3b301a;color:#ff3b30;border:1px solid rgba(255,59,48,.3)}.error-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.success-message[_ngcontent-%COMP%]{background:#34c7591a;color:#34c759;border:1px solid rgba(52,199,89,.3)}.success-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.upload-progress[_ngcontent-%COMP%]{margin-bottom:24px}.upload-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{height:6px;background:#ffffff1a;border-radius:3px;overflow:hidden;margin-bottom:8px}.upload-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#ff6b35,#ff8c42);transition:width .3s ease;border-radius:3px}.upload-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:13px;color:#888;text-align:center;margin:0;font-weight:500}.action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:-1fr 2fr;gap:12px;margin-top:24px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:16px 24px;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease;border:none}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background:#ffffff1a;color:#fff;border:1px solid rgba(255,255,255,.1)}.action-buttons[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff26}.action-buttons[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff6b35,#ff8c42);color:#fff;box-shadow:0 4px 12px #ff6b354d}.action-buttons[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 6px 20px #ff6b3566;transform:translateY(-2px)}@media (max-width: 768px){.upload-container[_ngcontent-%COMP%]{padding-bottom:100px}.upload-content[_ngcontent-%COMP%]{padding:16px}.form-section[_ngcontent-%COMP%]{padding:20px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.file-selector[_ngcontent-%COMP%]   .file-selector-content[_ngcontent-%COMP%]{padding:40px 24px}}"]})};function JA(n,e){if(n&1){let t=Ye();b(0,"button",16),ie("click",function(){let o=fe(t).$implicit,s=he();return pe(s.selectPrice(o))}),U(1),P()}if(n&2){let t=e.$implicit,i=he();Ge("active",i.selectedPriceRange===t),N(),He(" ",t.label," ")}}function ex(n,e){if(n&1){let t=Ye();b(0,"button",16),ie("click",function(){let o=fe(t).$implicit,s=he();return pe(s.selectDistance(o))}),U(1),P()}if(n&2){let t=e.$implicit,i=he();Ge("active",i.selectedDistance===t),N(),He(" ",t.label," ")}}function tx(n,e){if(n&1){let t=Ye();b(0,"button",16),ie("click",function(){let o=fe(t).$implicit,s=he();return pe(s.selectSort(o))}),U(1),P()}if(n&2){let t=e.$implicit,i=he();Ge("active",i.selectedSort===t),N(),He(" ",t," ")}}function nx(n,e){n&1&&(b(0,"div",17),X(1,"div",18),P())}function ix(n,e){n&1&&(b(0,"div",19)(1,"p"),U(2,"No tasty bites found matching your search."),P()())}function rx(n,e){if(n&1){let t=Ye();b(0,"div",20),ie("click",function(){let o=fe(t).$implicit,s=he();return pe(s.openReel(o))}),b(1,"div",21)(2,"video",22,0),ie("loadedmetadata",function(){fe(t);let o=Ts(3);return pe(o.currentTime=.1)}),P(),b(4,"div",23),U(5),P()(),b(6,"div",24)(7,"div",25)(8,"h3",26),U(9),P(),b(10,"span",27),U(11),b(12,"span",28),U(13,"\u2605"),P()()(),b(14,"p",29),U(15),P(),b(16,"div",30)(17,"span",31),U(18),P()()()()}if(n&2){let t=e.$implicit;N(2),Z("src",t.videoUrl,Wn),N(3),Xe(t.distanceStr),N(4),Xe(t.title),N(2),He(" ",t.rating," "),N(4),Xe(t.vendor),N(3),He("\u20B9",t.price,"")}}var Cd=class n{constructor(e,t,i){this.reelsService=e;this.locationService=t;this.router=i}searchQuery="";reels=[];filteredReels=[];isLoading=!1;categories=["All","South Indian","North Indian","Street Food","Desserts","Beverages"];selectedCategory="All";priceRanges=[{label:"All",min:0,max:1/0},{label:"\u20B90-30",min:0,max:30},{label:"\u20B931-60",min:31,max:60},{label:"\u20B961-100",min:61,max:100},{label:"\u20B9100+",min:101,max:1/0}];selectedPriceRange=this.priceRanges[0];distances=[{label:"All",max:1/0},{label:"< 1 km",max:1},{label:"1-3 km",max:3},{label:"3-5 km",max:5},{label:"5+ km",max:1/0}];selectedDistance=this.distances[0];sortOptions=["Nearest First","Price: Low to High","Price: High to Low"];selectedSort="Nearest First";ngOnInit(){return q(this,null,function*(){yield this.loadReels()})}loadReels(){return q(this,null,function*(){this.isLoading=!0;try{let e=yield this.reelsService.getReels(50);this.reels=yield Promise.all(e.map(t=>q(this,null,function*(){let i=1/0,o="-- km";if(t.latitude&&t.longitude)try{let s=yield this.locationService.getUserLocation();i=this.locationService.calculateDistance(s.latitude,s.longitude,t.latitude,t.longitude),o=i.toFixed(1)+" km"}catch(s){console.error("Error calculating distance",s)}return qe(J({},t),{distanceVal:i,distanceStr:o,rating:(4+Math.random()).toFixed(1)})}))),this.applyFilters()}catch(e){console.error("Error loading reels for search:",e)}finally{this.isLoading=!1}})}applyFilters(){let e=this.reels;if(this.searchQuery.trim()){let t=this.searchQuery.toLowerCase();e=e.filter(i=>i.title?.toLowerCase().includes(t)||i.vendor?.toLowerCase().includes(t))}if(this.selectedCategory,e=e.filter(t=>{let i=Number(t.price);return i>=this.selectedPriceRange.min&&i<=this.selectedPriceRange.max}),this.selectedDistance.label!=="All")if(this.selectedDistance.label==="5+ km")e=e.filter(t=>t.distanceVal>5&&t.distanceVal!==1/0);else if(this.selectedDistance.label==="< 1 km")e=e.filter(t=>t.distanceVal<1);else{let t=this.selectedDistance.max,i=this.distances[this.distances.indexOf(this.selectedDistance)-1]?.max||0;this.selectedDistance.label==="1-3 km"?e=e.filter(o=>o.distanceVal>=1&&o.distanceVal<=3):this.selectedDistance.label==="3-5 km"&&(e=e.filter(o=>o.distanceVal>=3&&o.distanceVal<=5))}this.selectedSort==="Nearest First"?e.sort((t,i)=>t.distanceVal-i.distanceVal):this.selectedSort==="Price: Low to High"?e.sort((t,i)=>Number(t.price)-Number(i.price)):this.selectedSort==="Price: High to Low"&&e.sort((t,i)=>Number(i.price)-Number(t.price)),this.filteredReels=e}selectCategory(e){this.selectedCategory=e,this.applyFilters()}selectPrice(e){this.selectedPriceRange=e,this.applyFilters()}selectDistance(e){this.selectedDistance=e,this.applyFilters()}selectSort(e){this.selectedSort=e,this.applyFilters()}openReel(e){this.router.navigate(["/main-app"],{state:{openFeed:!0,reelId:e.id}})}static \u0275fac=function(t){return new(t||n)(ne(ri),ne(ii),ne(Ke))};static \u0275cmp=nt({type:n,selectors:[["app-search"]],standalone:!0,features:[it],decls:24,vars:7,consts:[["videoThumb",""],[1,"search-container"],[1,"search-header"],[1,"search-bar"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"search-icon"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["type","text","placeholder","Search dosa, vada pav, biryani...",3,"ngModelChange","ngModel"],[1,"filters-scroll"],[1,"filter-section-title"],[1,"filter-group"],["class","chip",3,"active","click",4,"ngFor","ngForOf"],[1,"results-grid"],["class","loading-spinner",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","food-card",3,"click",4,"ngFor","ngForOf"],[1,"chip",3,"click"],[1,"loading-spinner"],[1,"spinner"],[1,"empty-state"],[1,"food-card",3,"click"],[1,"card-image"],["muted","","playsinline","","preload","metadata",3,"loadedmetadata","src"],[1,"distance-badge"],[1,"card-details"],[1,"header-row"],[1,"dish-name"],[1,"rating"],[1,"star"],[1,"vendor-name"],[1,"price-row"],[1,"price"]],template:function(t,i){t&1&&(b(0,"div",1)(1,"div",2)(2,"div",3),ye(),b(3,"svg",4),X(4,"circle",5)(5,"line",6),P(),Ve(),b(6,"input",7),qt("ngModelChange",function(s){return $t(i.searchQuery,s)||(i.searchQuery=s),s}),ie("ngModelChange",function(){return i.applyFilters()}),P()()(),b(7,"div",8)(8,"div",9),U(9,"Price Range"),P(),b(10,"div",10),Pe(11,JA,2,3,"button",11),P(),b(12,"div",9),U(13,"Distance"),P(),b(14,"div",10),Pe(15,ex,2,3,"button",11),P(),b(16,"div",9),U(17,"Sort By"),P(),b(18,"div",10),Pe(19,tx,2,3,"button",11),P()(),b(20,"div",12),Pe(21,nx,2,0,"div",13)(22,ix,3,0,"div",14)(23,rx,19,6,"div",15),P()()),t&2&&(N(6),jt("ngModel",i.searchQuery),N(5),Z("ngForOf",i.priceRanges),N(4),Z("ngForOf",i.distances),N(4),Z("ngForOf",i.sortOptions),N(2),Z("ngIf",i.isLoading),N(),Z("ngIf",!i.isLoading&&i.filteredReels.length===0),N(),Z("ngForOf",i.filteredReels))},dependencies:[ct,en,Pt,yn,on,vn,fn],styles:[".search-container[_ngcontent-%COMP%]{height:100%;overflow-y:auto;background:#f8f9fa;background:#000;padding-bottom:80px;color:#fff}.search-header[_ngcontent-%COMP%]{padding:16px;background:#000;position:sticky;top:0;z-index:10}.search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;background:#1a1a1a;border-radius:12px;padding:12px 16px;border:1px solid rgba(255,255,255,.1)}.search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#888;margin-right:12px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;font-size:15px;width:100%;outline:none}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#666}.filters-scroll[_ngcontent-%COMP%]{padding:0 16px 16px}.filters-scroll[_ngcontent-%COMP%]   .filter-section-title[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#fff;margin:12px 0 8px}.filters-scroll[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;gap:8px;overflow-x:auto;padding-bottom:4px;scrollbar-width:none}.filters-scroll[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.filters-scroll[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{background:#1a1a1a;color:#aaa;border:1px solid rgba(255,255,255,.1);padding:6px 14px;border-radius:20px;font-size:13px;white-space:nowrap;cursor:pointer;transition:all .2s}.filters-scroll[_ngcontent-%COMP%]   .chip.active[_ngcontent-%COMP%]{background:#ff6b35;color:#fff;border-color:#ff6b35}.results-grid[_ngcontent-%COMP%]{padding:0 16px;display:grid;grid-template-columns:1fr;grid-template-columns:repeat(2,1fr);gap:16px}.food-card[_ngcontent-%COMP%]{background:#1a1a1a;border-radius:16px;overflow:hidden;cursor:pointer;transition:transform .2s}.food-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.food-card[_ngcontent-%COMP%]   .card-image[_ngcontent-%COMP%]{position:relative;aspect-ratio:4/3;background:#222}.food-card[_ngcontent-%COMP%]   .card-image[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.food-card[_ngcontent-%COMP%]   .card-image[_ngcontent-%COMP%]   .distance-badge[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px;background:#0009;backdrop-filter:blur(4px);padding:4px 8px;border-radius:6px;font-size:11px;font-weight:600}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]{padding:12px}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .dish-name[_ngcontent-%COMP%]{font-size:15px;font-weight:600;margin:0 8px 0 0;color:#fff;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{display:flex;align-items:center;background:#2ecc71;color:#fff;padding:2px 4px;border-radius:4px;font-size:11px;font-weight:700}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]{font-size:10px;margin-left:2px}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .vendor-name[_ngcontent-%COMP%]{font-size:13px;color:#888;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#fff}.food-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .offer[_ngcontent-%COMP%]{font-size:10px;color:#ff9f43;font-weight:700;text-transform:uppercase}.loading-spinner[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;justify-content:center;padding:40px}.spinner[_ngcontent-%COMP%]{width:30px;height:30px;border:3px solid rgba(255,255,255,.1);border-top-color:#ff6b35;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{grid-column:1/-1;text-align:center;padding:40px;color:#666;font-size:14px}"]})};function ox(n,e){n&1&&(b(0,"div",7),X(1,"div",8),P())}function sx(n,e){if(n&1&&(b(0,"div",12)(1,"div",13),U(2),P(),b(3,"div",14)(4,"div",15),X(5,"video",16),P(),b(6,"div",17)(7,"h3"),U(8),P(),b(9,"p",18),U(10),P(),b(11,"div",19)(12,"span"),U(13),P(),b(14,"span"),U(15),P()()()()()),n&2){let t=e.$implicit,i=e.index;N(2),He("#",i+1,""),N(3),Z("src",t.videoUrl,Wn),N(3),Xe(t.title),N(2),Xe(t.vendor),N(3),He("\u{1F441}\uFE0F ",t.viewCount||0,""),N(2),He("\u2764\uFE0F ",t.likes||0,"")}}function ax(n,e){n&1&&(b(0,"div",20)(1,"p"),U(2,"No trending reels yet!"),P()())}function lx(n,e){if(n&1&&(b(0,"div",9),Pe(1,sx,16,6,"div",10)(2,ax,3,0,"div",11),P()),n&2){let t=he();N(),Z("ngForOf",t.trendingReels),N(),Z("ngIf",!t.isLoading&&t.trendingReels.length===0)}}function cx(n,e){if(n&1&&(b(0,"div",12)(1,"div",21),U(2,"\u{1F195}"),P(),b(3,"div",14)(4,"div",15),X(5,"video",16),P(),b(6,"div",17)(7,"h3"),U(8),P(),b(9,"p",18),U(10),P(),b(11,"div",19)(12,"span"),U(13),Qa(14,"date"),P()()()()()),n&2){let t=e.$implicit;N(5),Z("src",t.videoUrl,Wn),N(3),Xe(t.title),N(2),Xe(t.vendor),N(3),He("\u{1F4C5} ",Ya(14,4,t.createdAt==null?null:t.createdAt.toDate(),"shortDate"),"")}}function ux(n,e){n&1&&(b(0,"div",20)(1,"p"),U(2,"No new arrivals yet!"),P()())}function hx(n,e){if(n&1&&(b(0,"div",9),Pe(1,cx,15,7,"div",10)(2,ux,3,0,"div",11),P()),n&2){let t=he();N(),Z("ngForOf",t.newArrivalsReels),N(),Z("ngIf",!t.isLoading&&t.newArrivalsReels.length===0)}}var bd=class n{constructor(e){this.reelsService=e}trendingReels=[];newArrivalsReels=[];activeTab="trending";isLoading=!0;touchStartX=0;touchEndX=0;ngOnInit(){return q(this,null,function*(){yield this.loadTrending()})}loadTrending(){return q(this,null,function*(){this.isLoading=!0;try{let e=yield this.reelsService.getReels(50);this.trendingReels=[...e].sort((t,i)=>(i.viewCount||0)-(t.viewCount||0)).slice(0,10),this.newArrivalsReels=[...e].sort((t,i)=>{let o=t.createdAt?.toDate?t.createdAt.toDate().getTime():0;return(i.createdAt?.toDate?i.createdAt.toDate().getTime():0)-o}).slice(0,10)}catch(e){console.error("Error loading trending:",e)}finally{this.isLoading=!1}})}switchTab(e){this.activeTab=e,window.scrollTo({top:0,behavior:"smooth"})}onTouchStart(e){this.touchStartX=e.changedTouches[0].screenX}onTouchEnd(e){this.touchEndX=e.changedTouches[0].screenX,this.handleSwipe()}handleSwipe(){this.touchStartX-this.touchEndX>50&&this.activeTab==="trending"&&this.switchTab("new"),this.touchEndX-this.touchStartX>50&&this.activeTab==="new"&&this.switchTab("trending")}static \u0275fac=function(t){return new(t||n)(ne(ri))};static \u0275cmp=nt({type:n,selectors:[["app-trending"]],standalone:!0,features:[it],decls:13,vars:9,consts:[[1,"trending-page"],[1,"tabs-header"],[1,"tab",3,"click"],[1,"slider"],[1,"content-container",3,"touchstart","touchend"],["class","loading-spinner",4,"ngIf"],["class","reels-list",4,"ngIf"],[1,"loading-spinner"],[1,"spinner"],[1,"reels-list"],["class","ranking-item",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"ranking-item"],[1,"rank"],[1,"reel-card"],[1,"thumbnail"],["muted","","loop","","playsinline","",3,"src"],[1,"info"],[1,"vendor"],[1,"stats"],[1,"empty-state"],[1,"rank","new"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2),ie("click",function(){return i.switchTab("trending")}),b(3,"span"),U(4,"Trending \u{1F525}"),P()(),b(5,"div",2),ie("click",function(){return i.switchTab("new")}),b(6,"span"),U(7,"New Arrivals \u2728"),P()(),X(8,"div",3),P(),b(9,"div",4),ie("touchstart",function(s){return i.onTouchStart(s)})("touchend",function(s){return i.onTouchEnd(s)}),Pe(10,ox,2,0,"div",5)(11,lx,3,2,"div",6)(12,hx,3,2,"div",6),P()()),t&2&&(N(2),Ge("active",i.activeTab==="trending"),N(3),Ge("active",i.activeTab==="new"),N(3),Ge("right",i.activeTab==="new"),N(2),Z("ngIf",i.isLoading),N(),Z("ngIf",!i.isLoading&&i.activeTab==="trending"),N(),Z("ngIf",!i.isLoading&&i.activeTab==="new"))},dependencies:[ct,en,Pt,tv],styles:[".trending-page[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background:#000;color:#fff}.tabs-header[_ngcontent-%COMP%]{display:flex;position:relative;background:#000000e6;padding-top:max(12px,env(safe-area-inset-top));border-bottom:1px solid rgba(255,255,255,.1);z-index:10}.tabs-header[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{flex:1;text-align:center;padding:16px 0;font-weight:600;font-size:15px;color:#888;cursor:pointer;transition:color .3s}.tabs-header[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]{color:#ff6b35}.tabs-header[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:50%;height:2px;background:#ff6b35;transition:transform .3s ease}.tabs-header[_ngcontent-%COMP%]   .slider.right[_ngcontent-%COMP%]{transform:translate(100%)}.content-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-bottom:80px;min-height:0}.reels-list[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:16px}.ranking-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:#111;border-radius:12px;padding:12px}.ranking-item[_ngcontent-%COMP%]   .rank[_ngcontent-%COMP%]{font-size:24px;font-weight:900;color:#ff6b35;min-width:40px;text-align:center;font-style:italic}.ranking-item[_ngcontent-%COMP%]   .rank.new[_ngcontent-%COMP%]{font-size:20px}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]{flex:1;display:flex;gap:12px}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:80px;height:120px;border-radius:8px;overflow:hidden;background:#222}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:center}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;color:#fff}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .vendor[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px;color:#ccc}.ranking-item[_ngcontent-%COMP%]   .reel-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{display:flex;gap:12px;font-size:12px;color:#888}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px}.loading-spinner[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:30px;height:30px;border:3px solid rgba(255,255,255,.1);border-top-color:#ff6b35;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#888}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};var vc=class n{constructor(e,t){this.auth=e;this.router=t;let i=this.auth.currentUser;i&&(this.userEmail=i.email,i.displayName&&(this.fullName=i.displayName,this.userName=i.displayName.toLowerCase().replace(/\s+/g,"_")))}favoritesComponent;userEmail=null;userName="foodie_explorer";fullName="Bengaluru Foodie";stats={posts:12,followers:"1.2k",following:248};logout(){return q(this,null,function*(){try{yield this.auth.signOut(),this.router.navigate(["/"])}catch(e){console.error("Error signing out:",e)}})}reloadFavorites(){this.favoritesComponent&&this.favoritesComponent.loadBookmarkedReels()}static \u0275fac=function(t){return new(t||n)(ne(Tt),ne(Ke))};static \u0275cmp=nt({type:n,selectors:[["app-profile"]],viewQuery:function(t,i){if(t&1&&Zn(Zr,5),t&2){let o;xn(o=Mn())&&(i.favoritesComponent=o.first)}},standalone:!0,features:[it],decls:64,vars:6,consts:[[1,"profile-page"],[1,"top-bar"],[1,"username"],[1,"verified-badge"],[1,"top-actions"],[1,"icon-btn",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"],["points","16 17 21 12 16 7"],["x1","21","y1","12","x2","9","y2","12"],[1,"scroll-content"],[1,"profile-header-row"],[1,"avatar-container"],[1,"story-ring"],["src","assets/avatar-placeholder.png","alt","Avatar","onerror","this.src='https://ui-avatars.com/api/?name=Foodie+Explorer&background=ff6b35&color=fff'"],[1,"stats-container"],[1,"stat-item"],[1,"count"],[1,"label"],[1,"bio-section"],[1,"fullname"],[1,"bio-text"],[1,"action-buttons"],[1,"edit-profile-btn"],[1,"share-profile-btn"],[1,"content-tabs"],[1,"tab","active"],["x","3","y","3","width","7","height","7"],["x","14","y","3","width","7","height","7"],["x","14","y","14","width","7","height","7"],["x","3","y","14","width","7","height","7"],[1,"tab"],[1,"reel-icon"],["x","2","y","2","width","20","height","20","rx","5","ry","5"],["d","M10 8L16 12L10 16V8Z","fill","currentColor","stroke","none"],["d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],[1,"grid-content"],[3,"showHeader"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"h1",2),U(3),X(4,"span",3),P(),b(5,"div",4)(6,"button",5),ie("click",function(){return i.logout()}),ye(),b(7,"svg",6),X(8,"path",7)(9,"polyline",8)(10,"line",9),P()()()(),Ve(),b(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13),X(15,"img",14),P()(),b(16,"div",15)(17,"div",16)(18,"span",17),U(19),P(),b(20,"span",18),U(21,"Posts"),P()(),b(22,"div",16)(23,"span",17),U(24),P(),b(25,"span",18),U(26,"Followers"),P()(),b(27,"div",16)(28,"span",17),U(29),P(),b(30,"span",18),U(31,"Following"),P()()()(),b(32,"div",19)(33,"h2",20),U(34),P(),b(35,"p",21),U(36,"\u{1F4CD} Exploring Namma Bengaluru"),X(37,"br"),U(38,"\u{1F35B} South Indian Food Lover"),X(39,"br"),U(40,"\u2728 Digital Creator"),P()(),b(41,"div",22)(42,"button",23),U(43,"Edit Profile"),P(),b(44,"button",24),U(45,"Share Profile"),P()(),b(46,"div",25)(47,"div",26),ye(),b(48,"svg",6),X(49,"rect",27)(50,"rect",28)(51,"rect",29)(52,"rect",30),P()(),Ve(),b(53,"div",31)(54,"div",32),ye(),b(55,"svg",6),X(56,"rect",33)(57,"path",34),P()()(),Ve(),b(58,"div",31),ye(),b(59,"svg",6),X(60,"path",35)(61,"circle",36),P()()(),Ve(),b(62,"div",37),X(63,"app-favorites",38),P()()()),t&2&&(N(3),He("",i.userName," "),N(16),Xe(i.stats.posts),N(5),Xe(i.stats.followers),N(5),Xe(i.stats.following),N(5),Xe(i.fullName),N(29),Z("showHeader",!1))},dependencies:[ct,Zr],styles:[".profile-page[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background:#000;color:#fff}.top-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;padding-top:max(12px,env(safe-area-inset-top));background:#000;position:sticky;top:0;z-index:10;border-bottom:1px solid rgba(255,255,255,.05)}.top-bar[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-size:22px;font-weight:700;margin:0;display:flex;align-items:center;gap:4px}.top-bar[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;padding:4px;cursor:pointer}.scroll-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-bottom:80px}.profile-header-row[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;gap:20px}.avatar-container[_ngcontent-%COMP%]   .story-ring[_ngcontent-%COMP%]{width:86px;height:86px;border-radius:50%;padding:3px;background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888)}.avatar-container[_ngcontent-%COMP%]   .story-ring[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover;border:3px solid #000;background:#222}.stats-container[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:space-around}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;color:#fff}.bio-section[_ngcontent-%COMP%]{padding:0 16px;margin-bottom:16px}.bio-section[_ngcontent-%COMP%]   .fullname[_ngcontent-%COMP%]{font-size:14px;font-weight:700;margin:0 0 4px}.bio-section[_ngcontent-%COMP%]   .bio-text[_ngcontent-%COMP%]{font-size:14px;line-height:1.4;margin:0;color:#efefef}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;padding:0 16px;margin-bottom:20px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;background:#363636;border:none;color:#fff;padding:8px 16px;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#444}.content-tabs[_ngcontent-%COMP%]{display:flex;border-top:1px solid rgba(255,255,255,.1)}.content-tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;padding:12px 0;cursor:pointer;color:#888}.content-tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]{color:#fff;border-bottom:1px solid white}.content-tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.8}.grid-content[_ngcontent-%COMP%]     app-favorites .favorites-container{padding-top:0}"]})};function dx(n,e){if(n&1){let t=Ye();b(0,"div",21),ie("click",function(){fe(t);let o=he();return pe(o.openLocationModal())}),ye(),b(1,"svg",22),X(2,"path",23),P(),Ve(),b(3,"span",24),U(4),P(),ye(),b(5,"svg",25),X(6,"path",26),P()()}if(n&2){let t=he();N(4),Xe(t.location)}}function fx(n,e){if(n&1){let t=Ye();b(0,"div",40),ie("click",function(){let o=fe(t).$implicit,s=he(2);return pe(s.selectLocation(o))}),b(1,"div",41),ye(),b(2,"svg",42),X(3,"path",23),P()(),Ve(),b(4,"div",43)(5,"div",44),U(6),P(),b(7,"div",45),U(8),P()(),ye(),b(9,"svg",46),X(10,"path",47),P()()}if(n&2){let t=e.$implicit;N(6),Xe(t.name),N(2),He("Pincode: ",t.pincode,"")}}function px(n,e){n&1&&(b(0,"div",48),ye(),b(1,"svg",49),X(2,"circle",12)(3,"path",35),P(),Ve(),b(4,"p"),U(5,"No locations found"),P(),b(6,"span"),U(7,"Try searching for a different area"),P()())}function mx(n,e){if(n&1){let t=Ye();b(0,"div",27),ie("click",function(){fe(t);let o=he();return pe(o.closeLocationModal())}),b(1,"div",28),ie("click",function(o){return fe(t),pe(o.stopPropagation())}),b(2,"div",29)(3,"h2"),U(4,"Select Location"),P(),b(5,"button",30),ie("click",function(){fe(t);let o=he();return pe(o.closeLocationModal())}),ye(),b(6,"svg",31),X(7,"path",32),P()()(),Ve(),b(8,"div",33),ye(),b(9,"svg",34),X(10,"circle",12)(11,"path",35),P(),Ve(),b(12,"input",36),qt("ngModelChange",function(o){fe(t);let s=he();return $t(s.searchQuery,o)||(s.searchQuery=o),pe(o)}),P()(),b(13,"div",37),Pe(14,fx,11,2,"div",38)(15,px,8,0,"div",39),P()()()}if(n&2){let t=he();N(12),jt("ngModel",t.searchQuery),N(2),Z("ngForOf",t.filteredLocations),N(),Z("ngIf",t.filteredLocations.length===0)}}var Ed=class n{constructor(e,t,i,o){this.router=e;this.locationService=t;this.navigationService=i;this.auth=o;let s=this.router.getCurrentNavigation();if(s?.extras?.state){let l=s.extras.state;if(l.location&&(this.location=`${l.location}, Bangalore`),l.latitude&&l.longitude&&this.locationService.setUserLocation(l.latitude,l.longitude),l.openFeed&&l.reelId){this.activeTab="feed";let h=l.reelId,d=(m=0)=>{setTimeout(()=>{this.videoFeedComponent&&this.videoFeedComponent.reels&&this.videoFeedComponent.reels.length>0?(console.log("[MainApp] Video feed loaded, navigating to reel:",h),this.videoFeedComponent.navigateToReel(h)):m<10?(console.log("[MainApp] Waiting for video feed to load... attempt",m+1),d(m+1)):console.error("[MainApp] Failed to navigate to reel - video feed did not load")},500)};d()}}}location="Koramangala, Bangalore";navigate=new yt;activeTab="feed";showLocationModal=!1;showProfileMenu=!1;searchQuery="";locations=[{name:"Adugodi",pincode:"560030",lat:12.9716,lng:77.5946},{name:"Agaram",pincode:"560007",lat:12.8431,lng:77.4863},{name:"Air Force Stn. Yelahanka",pincode:"560063",lat:13.1048,lng:77.5763},{name:"Banashankari",pincode:"560050",lat:12.925453,lng:77.546761},{name:"Banashankari 2nd Stage",pincode:"560070",lat:12.9249,lng:77.5662},{name:"Banashankari 3rd Stage",pincode:"560085",lat:12.9216,lng:77.5543},{name:"Banashankari 6th Stage",pincode:"560062",lat:12.8963,lng:77.5353},{name:"Banaswadi",pincode:"560043",lat:13.0159,lng:77.6516},{name:"Basavanapura",pincode:"560036",lat:12.9835,lng:77.6773},{name:"Basaveshwaranagar",pincode:"560079",lat:12.9975,lng:77.5334},{name:"Bellandur",pincode:"560103",lat:12.9304,lng:77.6784},{name:"Bidadi",pincode:"562109",lat:12.8274,lng:77.3971},{name:"Bilekahalli",pincode:"560076",lat:12.8989,lng:77.6103},{name:"Binnamangala",pincode:"560038",lat:12.9837,lng:77.6388},{name:"Bommanahalli",pincode:"560068",lat:12.9082,lng:77.6245},{name:"Bommasandra",pincode:"560099",lat:12.8009,lng:77.699},{name:"Brookefield",pincode:"560037",lat:12.9698,lng:77.7184},{name:"BTM 2nd Stage",pincode:"560076",lat:12.9167,lng:77.6108},{name:"Budigere",pincode:"562129",lat:13.035,lng:77.7478},{name:"Byatarayanapura",pincode:"560026",lat:13.056,lng:77.5926},{name:"C V Raman Nagar",pincode:"560093",lat:12.9767,lng:77.6597},{name:"Chamarajpet",pincode:"560018",lat:12.9582,lng:77.5709},{name:"Channasandra",pincode:"560067",lat:12.9629,lng:77.758},{name:"Chikbasavanapura",pincode:"560067",lat:12.9948,lng:77.7327},{name:"Chickpet",pincode:"560053",lat:12.9662,lng:77.5767},{name:"Chikkalasandra",pincode:"560061",lat:12.9132,lng:77.5454},{name:"Choodasandra",pincode:"560099",lat:12.8848,lng:77.6785},{name:"Cox Town",pincode:"560005",lat:12.9996,lng:77.6229},{name:"D J Halli",pincode:"560005",lat:13.0083,lng:77.6228},{name:"Doddabidarakallu",pincode:"560073",lat:13.0426,lng:77.5019},{name:"Doorvaninagar",pincode:"560016",lat:13.0252,lng:77.6688},{name:"Ejipura",pincode:"560047",lat:12.9437,lng:77.6274},{name:"Electronic City",pincode:"560100",lat:12.8394,lng:77.677},{name:"Frazer Town",pincode:"560005",lat:12.999,lng:77.6226},{name:"Gandhi Nagar",pincode:"560009",lat:12.9772,lng:77.573},{name:"Gavipuram Extn",pincode:"560019",lat:12.9552,lng:77.5668},{name:"Geddalahalli",pincode:"560077",lat:13.0309,lng:77.6389},{name:"Gottigere",pincode:"560083",lat:12.8725,lng:77.5944},{name:"Halasur",pincode:"560042",lat:12.9833,lng:77.6194},{name:"Hebbal",pincode:"560024",lat:13.0355,lng:77.606},{name:"Heggere",pincode:"560073",lat:13.0172,lng:77.5004},{name:"HMT Layout",pincode:"560031",lat:13.039,lng:77.547},{name:"Horamavu",pincode:"560043",lat:13.0267,lng:77.6571},{name:"Hosakerehalli",pincode:"560085",lat:12.9251,lng:77.536},{name:"HSR Layout",pincode:"560102",lat:12.9121,lng:77.6446},{name:"Hulimavu",pincode:"560076",lat:12.8829,lng:77.6083},{name:"Indiranagar",pincode:"560038",lat:12.9719,lng:77.6412},{name:"ISRO Layout",pincode:"560078",lat:12.9056,lng:77.5665},{name:"J P Nagar",pincode:"560078",lat:12.9041,lng:77.5852},{name:"Jakkur",pincode:"560064",lat:13.0811,lng:77.5924},{name:"Jalahalli",pincode:"560013",lat:13.0491,lng:77.5422},{name:"Jayanagar 4th T Block",pincode:"560041",lat:12.9352,lng:77.5837},{name:"Jigani",pincode:"560105",lat:12.7849,lng:77.642},{name:"Kadubeesanahalli",pincode:"560103",lat:12.956,lng:77.7026},{name:"Kadugodi",pincode:"560067",lat:12.9968,lng:77.7583},{name:"Kaggadasapura",pincode:"560093",lat:12.9782,lng:77.6801},{name:"Kalasipalyam",pincode:"560002",lat:12.9636,lng:77.5777},{name:"Kalyananagar",pincode:"560043",lat:13.0288,lng:77.6402},{name:"Kamakshipalya",pincode:"560079",lat:12.9829,lng:77.5208},{name:"Kengeri",pincode:"560060",lat:12.9177,lng:77.4822},{name:"Kodichikkanahalli",pincode:"560068",lat:12.8903,lng:77.6239},{name:"Koramangala",pincode:"560095",lat:12.9344,lng:77.6173},{name:"KR Puram",pincode:"560036",lat:13.0022,lng:77.6951},{name:"Kyalasanahalli",pincode:"560077",lat:13.0269,lng:77.6589},{name:"Laggere",pincode:"560058",lat:13.0102,lng:77.5157},{name:"Mahadevapura",pincode:"560048",lat:12.9923,lng:77.6957},{name:"Majestic",pincode:"560009",lat:12.9779,lng:77.572},{name:"Malleshpalya",pincode:"560075",lat:12.9839,lng:77.6702},{name:"Malleshwaram",pincode:"560003",lat:12.9999,lng:77.5715},{name:"Manorayanapalya",pincode:"560032",lat:13.0365,lng:77.5726},{name:"Marathahalli",pincode:"560037",lat:12.9563,lng:77.7019},{name:"Mathikere",pincode:"560054",lat:13.0307,lng:77.5639},{name:"Munnekollal",pincode:"560037",lat:12.9568,lng:77.7045},{name:"Nagarbhavi",pincode:"560072",lat:12.9674,lng:77.5049},{name:"Nayandahalli",pincode:"560039",lat:12.9413,lng:77.5159},{name:"Neelasandra",pincode:"560047",lat:12.9479,lng:77.6236},{name:"Peenya",pincode:"560058",lat:13.0194,lng:77.5153},{name:"Raghuvanahalli",pincode:"560062",lat:12.8821,lng:77.5466},{name:"Rajajinagar",pincode:"560010",lat:12.9989,lng:77.5536},{name:"Ramamurthy Nagar",pincode:"560016",lat:13.0045,lng:77.6797},{name:"RT Nagar",pincode:"560032",lat:13.0266,lng:77.5979},{name:"Sadashivanagar",pincode:"560080",lat:13.0093,lng:77.5772},{name:"Shanti Nagar",pincode:"560027",lat:12.9537,lng:77.5926},{name:"Tavarekere",pincode:"560029",lat:12.931,lng:77.6106},{name:"Varthur",pincode:"560087",lat:12.9352,lng:77.7501},{name:"Vidyaranyapura",pincode:"560097",lat:13.067,lng:77.56}];favoritesComponent;profileComponent;videoFeedComponent;ngOnInit(){return q(this,null,function*(){if(this.location==="Koramangala, Bangalore")try{let e=yield this.locationService.getUserLocation(),t=this.locationService.findNearestArea(e.latitude,e.longitude);this.location=`${t}, Bangalore`}catch(e){console.error("Error getting location:",e)}this.navigationService.selectedReelId$.subscribe(e=>{if(e){console.log("[MainApp] Received reel selection:",e),this.activeTab="feed";let t=(i=0)=>{setTimeout(()=>{this.videoFeedComponent&&this.videoFeedComponent.reels&&this.videoFeedComponent.reels.length>0?(console.log("[MainApp] Navigating to reel:",e),this.videoFeedComponent.navigateToReel(e),this.navigationService.clearSelection()):i<15?(console.log("[MainApp] Waiting for reels... attempt",i+1),t(i+1)):console.error("[MainApp] Failed to navigate - reels not loaded")},400)};t()}})})}select(e){this.activeTab=e,this.navigate.emit(e),e==="profile"&&this.profileComponent&&this.profileComponent.reloadFavorites()}goToUpload(){this.select("upload")}openLocationModal(){this.showLocationModal=!0,this.searchQuery=""}closeLocationModal(){this.showLocationModal=!1,this.searchQuery=""}selectLocation(e){return q(this,null,function*(){this.location=`${e.name}, Bangalore`,this.locationService.setUserLocation(e.lat,e.lng),this.closeLocationModal(),this.videoFeedComponent&&(yield this.videoFeedComponent.reloadReelsForNewLocation())})}get filteredLocations(){if(!this.searchQuery.trim())return this.locations;let e=this.searchQuery.toLowerCase();return this.locations.filter(t=>t.name.toLowerCase().includes(e)||t.pincode.includes(e))}logout(){return q(this,null,function*(){try{yield this.auth.signOut(),this.router.navigate(["/"])}catch(e){console.error("Error signing out:",e)}})}toggleProfileMenu(){this.showProfileMenu=!this.showProfileMenu}static \u0275fac=function(t){return new(t||n)(ne(Ke),ne(ii),ne(ha),ne(Tt))};static \u0275cmp=nt({type:n,selectors:[["app-main-app"]],viewQuery:function(t,i){if(t&1&&(Zn(Zr,5),Zn(vc,5),Zn(Qo,5)),t&2){let o;xn(o=Mn())&&(i.favoritesComponent=o.first),xn(o=Mn())&&(i.profileComponent=o.first),xn(o=Mn())&&(i.videoFeedComponent=o.first)}},outputs:{navigate:"navigate"},standalone:!0,features:[it],decls:34,vars:25,consts:[[1,"main-app"],[1,"top-nav"],[1,"nav-left"],["class","location-badge",3,"click",4,"ngIf"],[1,"nav-right"],["class","modal-overlay",3,"click",4,"ngIf"],[3,"isActive"],[1,"bottom-nav"],[1,"bottom-nav-btn",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"nav-icon"],["x","2","y","2","width","20","height","20","rx","5","ry","5","stroke","currentColor","stroke-width","2"],["d","M10 8L16 12L10 16V8Z","fill","currentColor","stroke","none"],["cx","11","cy","11","r","8","stroke","currentColor","stroke-width","2"],["d","M21 21L16.65 16.65","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"bottom-nav-btn","upload-btn",3,"click"],["d","M12 7v10M7 12h10","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["points","23 6 13.5 15.5 8.5 10.5 1 18","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["points","17 6 23 6 23 12","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"profile-container-bottom"],["d","M20 21C20 18.2386 17.7614 16 15 16H9C6.23858 16 4 18.2386 4 21","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","7","r","4","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"location-badge",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"location-pin"],["d","M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z","fill","currentColor"],[1,"location-text"],["width","12","height","12","viewBox","0 0 24 24","fill","none",1,"chevron-down"],["d","M6 9l6 6 6-6","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"modal-overlay",3,"click"],[1,"location-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M18 6L6 18M6 6l12 12","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"search-box"],["width","20","height","20","viewBox","0 0 24 24","fill","none",1,"search-icon"],["d","M21 21l-4.35-4.35","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["type","text","placeholder","Search for a location...",1,"search-input",3,"ngModelChange","ngModel"],[1,"locations-list"],["class","location-item",3,"click",4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],[1,"location-item",3,"click"],[1,"location-icon"],["width","20","height","20","viewBox","0 0 24 24","fill","none"],[1,"location-info"],[1,"location-name"],[1,"location-area"],["width","20","height","20","viewBox","0 0 24 24","fill","none",1,"chevron-right"],["d","M9 18l6-6-6-6","stroke","currentColor","stroke-width","2","stroke-linecap","round"],[1,"no-results"],["width","48","height","48","viewBox","0 0 24 24","fill","none"]],template:function(t,i){t&1&&(b(0,"div",0)(1,"div",1)(2,"div",2),Pe(3,dx,7,1,"div",3),P(),X(4,"div",4),P(),Pe(5,mx,16,3,"div",5),X(6,"app-video-feed",6)(7,"app-search")(8,"app-trending")(9,"app-profile")(10,"app-favorites")(11,"app-upload-reel"),b(12,"div",7)(13,"button",8),ie("click",function(){return i.select("feed")}),ye(),b(14,"svg",9),X(15,"rect",10)(16,"path",11),P()(),Ve(),b(17,"button",8),ie("click",function(){return i.select("search")}),ye(),b(18,"svg",9),X(19,"circle",12)(20,"path",13),P()(),Ve(),b(21,"button",14),ie("click",function(){return i.goToUpload()}),ye(),b(22,"svg",9),X(23,"rect",10)(24,"path",15),P()(),Ve(),b(25,"button",8),ie("click",function(){return i.select("trending")}),ye(),b(26,"svg",9),X(27,"polyline",16)(28,"polyline",17),P()(),Ve(),b(29,"div",18)(30,"button",8),ie("click",function(){return i.select("profile")}),ye(),b(31,"svg",9),X(32,"path",19)(33,"circle",20),P()()()()()),t&2&&(N(3),Z("ngIf",i.activeTab==="feed"),N(2),Z("ngIf",i.showLocationModal),N(),Ge("hidden",i.activeTab!=="feed"),Z("isActive",i.activeTab==="feed"),N(),Ge("hidden",i.activeTab!=="search"),N(),Ge("hidden",i.activeTab!=="trending"),N(),Ge("hidden",i.activeTab!=="profile"),N(),Ge("hidden",i.activeTab!=="favorites"),N(),Ge("hidden",i.activeTab!=="upload"),N(2),Ge("active",i.activeTab==="feed"),N(4),Ge("active",i.activeTab==="search"),N(4),Ge("active",i.activeTab==="upload"),N(4),Ge("active",i.activeTab==="trending"),N(5),Ge("active",i.activeTab==="profile"))},dependencies:[ct,en,Pt,Qo,Zr,da,Cd,bd,vc,yn,on,vn,fn],styles:['.main-app[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;flex-direction:column;background:#000;font-family:Poppins,sans-serif}.hidden[_ngcontent-%COMP%]{display:none!important}.top-nav[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;z-index:10;display:flex;justify-content:space-between;padding:1rem;padding-top:max(1rem,env(safe-area-inset-top));background:linear-gradient(to bottom,rgba(0,0,0,.8) 0%,transparent 100%)}.profile-container-bottom[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.location-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#fff3;backdrop-filter:blur(1px);padding:.5rem 1rem;border-radius:20px;color:#fff;font-size:.9rem;font-weight:500;cursor:pointer;transition:all .2s ease}.location-badge[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:translateY(-1px)}.location-badge[_ngcontent-%COMP%]:active{transform:scale(.98)}.location-pin[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.chevron-down[_ngcontent-%COMP%]{opacity:.7;transition:transform .2s ease}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;backdrop-filter:blur(1px);z-index:100;display:flex;align-items:flex-end;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.location-modal[_ngcontent-%COMP%]{background:#1a1a1a;width:100%;max-height:80vh;border-radius:24px 24px 0 0;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(100%)}to{transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 20px 16px;border-bottom:1px solid rgba(255,255,255,.1)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#fff;margin:0}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:transparent;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#888;cursor:pointer;border-radius:50%;transition:all .2s ease}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#fff}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.search-box[_ngcontent-%COMP%]{padding:16px 20px;position:relative;border-bottom:1px solid rgba(255,255,255,.1)}.search-box[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:36px;top:50%;transform:translateY(-50%);color:#666;pointer-events:none}.search-box[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:14px 16px 14px 48px;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:12px;color:#fff;font-size:15px;transition:all .2s ease;box-sizing:border-box}.search-box[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#666}.search-box[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;background:#ffffff14;border-color:#ff6b35;box-shadow:0 0 0 3px #ff6b351a}.locations-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.location-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px 20px;cursor:pointer;transition:all .2s ease;border-bottom:1px solid rgba(255,255,255,.05)}.location-item[_ngcontent-%COMP%]:hover{background:#ffffff0d}.location-item[_ngcontent-%COMP%]:active{background:#ffffff1a;transform:scale(.98)}.location-item[_ngcontent-%COMP%]   .location-icon[_ngcontent-%COMP%]{width:40px;height:40px;background:#ff6b351a;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#ff6b35;flex-shrink:0}.location-item[_ngcontent-%COMP%]   .location-info[_ngcontent-%COMP%]{flex:1;min-width:0}.location-item[_ngcontent-%COMP%]   .location-info[_ngcontent-%COMP%]   .location-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#fff;margin-bottom:4px}.location-item[_ngcontent-%COMP%]   .location-info[_ngcontent-%COMP%]   .location-area[_ngcontent-%COMP%]{font-size:13px;color:#888}.location-item[_ngcontent-%COMP%]   .chevron-right[_ngcontent-%COMP%]{color:#666;flex-shrink:0}.no-results[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center;color:#666}.no-results[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0 0 8px;color:#888}.no-results[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#666}.bottom-nav[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;display:flex;justify-content:space-around;padding:.75rem 0;padding-bottom:0;background:#0003;backdrop-filter:blur(1px);-webkit-backdrop-filter:blur(1px);border-top:1px solid rgba(255,255,255,.1);z-index:20}.bottom-nav-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#888;font-size:.7rem;display:flex;flex-direction:column;align-items:center;gap:.25rem;cursor:pointer;transition:color .2s;padding:.5rem 1rem;font-weight:400}.bottom-nav-btn.active[_ngcontent-%COMP%]{color:#ff6b35}.bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]   path[_ngcontent-%COMP%], .bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:currentColor}.bottom-nav-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:2px}.nav-icon[_ngcontent-%COMP%]{width:24px;height:24px;color:inherit;transition:all .2s}.bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]:has(path[d*="M3 9.5"])   path[_ngcontent-%COMP%]{fill:currentColor;stroke:currentColor}.bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]:has(path[d*="19 21l-7-5"])   path[_ngcontent-%COMP%]{fill:currentColor}.bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]:has(polyline[points*="23 6"])   polyline[_ngcontent-%COMP%]{fill:none;stroke-width:3px}.bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]:has(path[d*="M20 21C20"])   path[_ngcontent-%COMP%], .bottom-nav-btn.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]:has(path[d*="M20 21C20"])   circle[_ngcontent-%COMP%]{stroke:currentColor}@media (min-width: 768px){.location-modal[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;border-radius:24px;max-height:70vh}.modal-overlay[_ngcontent-%COMP%]{align-items:center}}']})};var yc=()=>{let n=ue(Tt),e=ue(Ke);return hu(n).pipe(We(t=>t?!0:(e.navigate(["/phone-input"]),!1)))};var f_=()=>{let n=ue(Tt),e=ue(Ke);return hu(n).pipe(We(t=>t?(console.log("[NoAuthGuard] User is authenticated, redirecting to main-app"),e.createUrlTree(["/main-app"])):!0))};var _C=[{path:"",component:cd},{path:"phone-input",component:gd,canActivate:[Wo,f_]},{path:"otp",component:_d,canActivate:[Wo,f_]},{path:"location-permission",component:vd,canActivate:[yc,Wo]},{path:"main-app",component:Ed,canActivate:[yc,Wo]},{path:"video-feed",component:Qo,canActivate:[yc,Wo]},{path:"upload-reel",component:da,canActivate:[yc,Wo]}];var vC={providers:[ty(_C),Fy(),A0(()=>x0(W1.firebase)),R0(()=>k0()),z1(()=>q1()),F0(()=>V0()),Ko]};var Sd=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=nt({type:n,selectors:[["app-root"]],standalone:!0,features:[it],decls:1,vars:0,template:function(t,i){t&1&&X(0,"router-outlet")},dependencies:[np]})};uv(Sd,vC).catch(n=>console.error(n));
