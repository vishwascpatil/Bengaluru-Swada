<!-- Video Feed Template -->
<div class="video-feed" (touchstart)="onTouchStart($event)" (touchmove)="onTouchMove($event)"
  (touchend)="onTouchEnd($event)">

  <!-- New Header Design -->
  <div class="feed-header">
    <button class="header-icon-btn" (click)="goToSearch()">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="M21 21l-4.35-4.35"></path>
      </svg>
    </button>

    <div class="header-tabs">
      <button class="tab-item" [class.active]="activeTab === 'explore'" (click)="switchTab('explore')">
        Explore
      </button>
      <button class="tab-item" [class.active]="activeTab === 'near'" (click)="switchTab('near')">
        Near You
      </button>
      <button class="tab-item" [class.active]="activeTab === 'new'" (click)="switchTab('new')">
        New Arrivals
      </button>
    </div>

    <button class="header-icon-btn" (click)="goToProfile()">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
    </button>
  </div>

  <!-- Premium Pull to Refresh Indicator -->
  <div class="refresh-indicator" [style.transform]="'translateY(' + (isRefreshing ? 70 : pullMoveY) + 'px)'"
    [class.refreshing]="isRefreshing" [class.visible]="pullMoveY > 10">
    <div class="spinner-container">
      <svg class="instagram-spinner" viewBox="0 0 50 50">
        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="4"></circle>
      </svg>
    </div>
  </div>

  <!-- Skeleton Loading -->
  <app-video-feed-skeleton *ngIf="isLoading"></app-video-feed-skeleton>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && reels.length === 0">
    <div class="empty-content">
      <h2>No Reels Found</h2>
      <p>Be the first to share a tasty bite!</p>
      <div class="button-group">
        <button class="seed-btn" (click)="seedData()">Seed Sample Data</button>
        <a routerLink="/upload-reel" class="upload-btn">Upload Reel</a>
      </div>
    </div>
  </div>

  <!-- Video Reel Grid -->
  <div class="reels-container" *ngIf="!isLoading && reels.length > 0">
    <app-video-card *ngFor="let reel of reels; let i = index; trackBy: trackByReelId" [reel]="reel"
      [active]="i === currentIndex && isActive" [relativeIndex]="i - currentIndex" [priority]="getPriority(i)"
      [isMuted]="isGlobalMuted" [canDelete]="isOwner(reel)" [swipeDeltaY]="swipeDeltaY" [isSwiping]="isSwiping"
      (muteChanged)="onMuteChanged($event)" (deleted)="onReelDeleted(reel)" (liked)="onLike(i)"
      (bookmarked)="onBookmark(i)" (shared)="onShare(i)">
    </app-video-card>
  </div>
</div>